(()=>{"use strict";var e={1859:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(7252)),i=o(n(6928)),d=o(n(818)),s=(o(n(2096)),o(n(6898))),a=o(n(2525)),u=o(n(8577)),l=o(n(1763)),c=o(n(2239)),p=n(5265),f=n(1096),h=o(n(3035)),m=o(n(4600)),y=o(n(8843)),g=o(n(119)),v=o(n(2780)),b=o(n(2574)),x=o(n(1664)),w=o(n(9783)),S=o(n(6330)),_=o(n(3284)),R=o(n(1558)),P=o(n(1661)),D=o(n(616)),q=o(n(9234)),O=o(n(8347)),A=o(n(4320)),I=o(n(9692)),T=o(n(88)),$=o(n(4427)),k=o(n(4754)),C=o(n(3226)),M=o(n(1414)),j=o(n(2953)),N=o(n(3384)),E=o(n(9467)),B=o(n(7017)),z=o(n(1055)),F=o(n(8883)),U=o(n(8638)),Y=o(n(5768)),W=o(n(252)),L=o(n(5703)),V=o(n(8589)),H=o(n(1671)),G=o(n(7628)),Q=o(n(289)),J=o(n(6613)),X=o(n(4960)),K=(0,r.default)();d.default.config(),K.use((0,a.default)()),K.use((0,u.default)({origin:"http://localhost:5173"}));const Z=(0,l.default)({windowMs:9e5,max:100});K.use(Z),K.use((0,c.default)()),K.use((0,s.default)()),K.use(r.default.json()),K.use(r.default.static(i.default.join(__dirname,"public"))),(0,p.startShopsCronJobs)(),(0,f.startWebsiteCronJobs)(),K.use("/api/v1/auth",m.default),K.use("/api/v1/users",y.default),K.use("/api/v1/shopping-cart",g.default),K.use("/api/v1/products",v.default),K.use("/api/v1/wishlist",b.default),K.use("/api/v1/checkout",x.default),K.use("/api/v1/reviews",w.default),K.use("/api/v1/orders",S.default),K.use("/api/v1/orders/admin",P.default),K.use("/api/v1/shop-orders",N.default),K.use("/api/v1/notifications",E.default),K.use("/api/v1/prime-subscription",F.default),K.use("/api/v1/admin/prime-subscription",U.default),K.use("/api/v1/discount-codes",Y.default),K.use("/api/v1/shop/discount-codes",W.default),K.use("/api/v1/website/discount-codes",L.default),K.use("/api/v1/messages",V.default),K.use("/api/v1/report-shops",H.default),K.use("/api/v1/shop-analytics",G.default),K.use("/api/v1/website-analytics",Q.default),K.use("/api/v1/shop-support-tickets",j.default),K.use("/api/v1/website/analytics-reports",B.default),K.use("/api/v1/shop/analytics-reports",z.default),K.use("/api/v1/support-tickets",_.default),K.use("/api/v1/processed-support-tickets",M.default),K.use("/api/v1/return-products",R.default),K.use("/api/v1/processed-return-products",C.default),K.use("/api/v1/refund-requests",D.default),K.use("/api/v1/processed-refund-requests",k.default),K.use("/api/v1/shops-requests",q.default),K.use("/api/v1/processed-shops-requests",$.default),K.use("/api/v1/shops",O.default),K.use("/api/v1/admin/shops",A.default),K.use("/api/v1/delete-shops-requests",I.default),K.use("/api/v1/processed-delete-shops-requests",T.default),(0,h.default)(K,3e3),K.use("*",((e,t,n)=>{n(new X.default(`Can't find ${e.originalUrl} on this server`,404))})),K.use(J.default),t.default=K},8839:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cloudConfig=void 0,o(n(818)).default.config(),t.cloudConfig={CLOUD_NAME:process.env.CLOUD_NAME,API_KEY:process.env.CLOUD_API_KEY,API_SECRET:process.env.CLOUD_API_SECRET}},5828:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PORT=t.DB=void 0,o(n(818)).default.config(),t.DB=process.env.DATABASE,t.PORT=parseInt(process.env.PORT||"3000",10)},5284:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LoyaltyPointsCategory=void 0,t.LoyaltyPointsCategory={NORMAL_USER:{UNDER_250:25,FROM_250_TO_499:50,FROM_500_TO_749:75,FROM_750_TO_999:100,FROM_1000_TO_1999:200,FROM_2000_AND_ABOVE:300},PRIME_USER:{UNDER_250:50,FROM_250_TO_499:100,FROM_500_TO_749:150,FROM_750_TO_999:200,FROM_1000_TO_1999:400,FROM_2000_AND_ABOVE:600}}},6634:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(1572));o(n(818)).default.config(),t.default=()=>r.default.createTransport({host:"smtp.gmail.com",port:587,secure:!1,auth:{user:"azaz123456az4@gmail.com",pass:process.env.EMAIL_PASSWORD}})},1476:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.upload=void 0;const r=o(n(8461)),i=r.default.diskStorage({destination:function(e,t,n){n(null,"src/public/uploads")},filename:function(e,t,n){n(null,t.originalname)}});t.upload=(0,r.default)({storage:i})},4884:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SUBSCRIPTION_PLANS=void 0;const o=n(976);t.SUBSCRIPTION_PLANS={[o.PrimeSubscriptionPlan.MONTHLY]:{originalAmount:50,discountedAmount:0},[o.PrimeSubscriptionPlan.YEARLY]:{originalAmount:500,discountedAmount:0}}},3035:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(8450)),i=o(n(2320)),d={definition:{openapi:"3.0.0",info:{title:"REST API Docs",version:n(8330).version},components:{securitySchemes:{bearerAuth:{type:"http",scheme:"bearer",bearerFormat:"JWT"}}},security:[{bearerAuth:[]}]},apis:["./src/routes/*.ts","./src/models/*Model.ts"]},s=(0,r.default)(d);t.default=function(e,t){e.use("/api/v1/docs",i.default.serve,i.default.setup(s)),e.get("/docs.json",((e,t)=>{console.log("Docs in JSON format"),t.setHeader("Content-Type","/application/json"),t.send(s)})),console.log(`Docs available at http://localhost:${t}/api/v1/docs`)}},1153:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getShopAnalytics=void 0;const i=r(n(2059)),d=r(n(5061)),s=r(n(5027)),a=r(n(4960)),u=r(n(2489)),l=n(7333);t.getShopAnalytics=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){var o;const r=e.params.shopId;if(!(yield d.default.findById(r)))return n(new a.default("No shop found with this id.",404));const u=yield i.default.countDocuments({shop:r}),c=yield s.default.countDocuments({shop:r}),p=yield s.default.countDocuments({shop:r,status:"cancelled"}),f={status:"success",data:{totalProducts:u,totalSales:(null===(o=(yield s.default.aggregate([{$match:{shop:r,status:"delivered"}},{$group:{_id:null,total:{$sum:"$netPrice"}}}]))[0])||void 0===o?void 0:o.total)||0,totalOrders:c,cancelledOrders:p}};(0,l.sendResponse)(200,f,t)}))))},3742:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteReport=t.getAllReports=t.getReport=t.getAllShopAnalyticsReports=t.getShopAnalyticsReport=t.createShopAnalyticsReport=void 0;const i=r(n(5061)),d=r(n(3240)),s=r(n(7193)),a=r(n(4960)),u=r(n(2489)),l=n(7333),c=r(n(2833)),p=n(2257),f=n(2653),h=n(9840),m=n(4832),y=n(5989);t.createShopAnalyticsReport=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopId:o}=e.params,{startDate:r,endDate:s}=e.query,u=yield i.default.findById(o);if(!u)return n(new a.default("Shop not found",404));const g=new Date(r),v=new Date(s);if(isNaN(g.getTime())||isNaN(v.getTime()))return n(new a.default("Invalid date range",400));const b=new d.default({shopId:u._id,shopName:u.shopName,shopEmail:u.email,month:g.toLocaleString("default",{month:"long"}),year:g.getFullYear(),financialInformation:yield(0,p.getFinancialInformation)(o,g,v),orders:yield(0,f.getOrdersInformation)(o,g,v),returnInformation:yield(0,h.getReturnInformation)(o,g,v),refundInformation:yield(0,m.getRefundInformation)(o,g,v),productInformation:yield(0,y.getProductInformation)(o,g,v)}),x=yield d.default.create(b);if((0,c.default)(u,x),t){const e={status:"success",data:b};(0,l.sendResponse)(201,e,t)}return x})))),t.getShopAnalyticsReport=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{id:o}=e.params,r=yield i.default.findById(e.user.myShop);if(!r)return n(new a.default("You not shop owner ",404));const s=yield d.default.findOne({_id:o,shopId:r});if(!s)return n(new a.default("Report not found",404));const u={status:"success",data:s};(0,l.sendResponse)(200,u,t)})))),t.getAllShopAnalyticsReports=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=e.user.myShop;if(!(yield i.default.findById(o)))return n(new a.default("Shop not found",404));const r=new s.default(d.default.find({shopId:o}),e.query).filter().sort().limitFields().paginate(),u=yield r.execute(),c={status:"success",results:u.length,data:u};(0,l.sendResponse)(200,c,t)})))),t.getReport=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield d.default.findById(e.params.id);if(!o)return n(new a.default("Report not found",404));const r={status:"success",data:o};(0,l.sendResponse)(200,r,t)})))),t.getAllReports=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new s.default(d.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,l.sendResponse)(200,r,t)})))),t.deleteReport=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield d.default.findByIdAndDelete(e.params.id)))return n(new a.default("Report not found",404));(0,l.sendResponse)(204,{status:"success",message:"Report deleted successfully",data:null},t)}))))},2846:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getWebsiteAnalytics=void 0;const i=r(n(2059)),d=r(n(5061)),s=r(n(5939)),a=r(n(5976)),u=r(n(6049)),l=r(n(656)),c=r(n(2819)),p=r(n(619)),f=r(n(4960)),h=r(n(2489)),m=n(7333);t.getWebsiteAnalytics=(0,h.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){var e;const[o,r,h,y,g,v,b,x,w,S,_,R,P,D,q]=yield Promise.all([i.default.countDocuments(),s.default.countDocuments(),s.default.countDocuments({status:"cancelled"}),s.default.aggregate([{$match:{orderStatus:"delivered"}},{$group:{_id:null,total:{$sum:"$totalPrice"}}}]),s.default.countDocuments({status:"refund-requested"}),a.default.aggregate([{$match:{refundStatus:"confirmed"}},{$group:{_id:null,total:{$sum:"$refundAmount"}}}]),u.default.countDocuments(),a.default.countDocuments(),a.default.countDocuments({refundStatus:"confirmed"}),a.default.countDocuments({refundStatus:"confirmed"}),d.default.countDocuments(),p.default.countDocuments(),l.default.countDocuments(),c.default.countDocuments(),c.default.countDocuments({isPrimeUser:!0})]);if(!y.length||!v.length)return n(new f.default("No sales or refunds data found",404));const O=r>0?y[0].total/r:0,A={status:"success",data:{totalProducts:o,totalSales:y[0].total,totalOrders:r,cancelledOrders:h,averageOrderValue:O,primeUsers:q,totalRefundRequests:g,totalRefunds:(null===(e=v[0])||void 0===e?void 0:e.total)||0,totalDiscountCodes:b,totalReturnRequests:x,approvedReturnRequests:w,approvedRefundRequests:S,totalShops:_,totalDeleteShopsRequests:R,totalShopsReports:P,totalUsers:D}};(0,m.sendResponse)(200,A,t)}))))},5460:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteWebsiteAnalyticsReport=t.getWebsiteAnalyticsReport=t.getAllWebsiteAnalyticsReports=t.createWebsiteAnalyticsReport=void 0;const i=r(n(4960)),d=r(n(2489)),s=n(7333),a=r(n(7193)),u=r(n(1202)),l=n(2048),c=n(869),p=n(4590),f=n(13),h=n(8201),m=n(8211),y=n(5831),g=n(8485),v=n(8376),b=r(n(9532));t.createWebsiteAnalyticsReport=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const e=new Date,o=new Date(e),r=new Date(e.setDate(e.getDate()-30)),d=o.getFullYear(),a=o.toLocaleString("default",{month:"long"});if(yield u.default.findOne({month:a,year:d,createdAt:{$gte:r,$lte:o}}))return n(new i.default("A report for the last 30 days already exists",400));const x=yield(0,l.calculateFinancialSummary)(),w=yield(0,c.getShopAnalytics)(),S=yield(0,p.getOrdersAnalytics)(),_=yield(0,f.getProductsAnalytics)(),R=yield(0,h.getUserAnalytics)(),P=yield(0,m.getRefundAnalytics)(),D=yield(0,y.getReturnAnalytics)(),q=yield(0,g.calculateSupportTicketAnalytics)(),O=yield(0,v.getPrimeSubscriptionAnalytics)(),A=yield u.default.create({month:a,year:d,financialSummary:x,shopAnalytics:w,orderAnalytics:S,productAnalytics:_,userAnalytics:R,refundAnalytics:P,returnItemsAnalytics:D,supportTicketAnalytics:q,primeSubscriptionAnalytics:O});(0,b.default)(A,"mohamedramadan11b@gmail.com");const I={status:"success",message:"Website analytics report created successfully",data:A};(0,s.sendResponse)(201,I,t)})))),t.getAllWebsiteAnalyticsReports=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new a.default(u.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,s.sendResponse)(200,r,t)})))),t.getWebsiteAnalyticsReport=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield u.default.findById(e.params.id);if(!o)return n(new i.default("No report found with that ID",404));const r={status:"success",data:o};(0,s.sendResponse)(200,r,t)})))),t.deleteWebsiteAnalyticsReport=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield u.default.findByIdAndDelete(e.params.id)))return n(new i.default("No report found with that ID",404));(0,s.sendResponse)(204,{status:"success",data:null},t)}))))},2319:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.resetPassword=t.forgotPassword=t.logout=t.loginWithEmail=t.verifyEmail=t.signUpWithEmail=void 0;const i=r(n(6982)),d=r(n(1573)),s=r(n(2819)),a=r(n(4960)),u=r(n(2489)),l=n(5269),c=r(n(5799)),p=r(n(6637));t.signUpWithEmail=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{name:o,email:r,phoneNumber:i,password:u,passwordConfirmation:p}=e.body,f=yield s.default.create({name:o,email:r,phoneNumber:i,password:u,passwordConfirmation:p});if(!f)return n(new a.default("Fail to sign the new user  ",500));const h=yield d.default.create({user:f._id});f.shoppingCart=h;const m=f.createEmailVerificationToken();f.emailVerificationToken=m,yield f.save({validateBeforeSave:!1}),(0,c.default)(f),(0,l.createSendToken)(f,201,t)})))),t.verifyEmail=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{token:o}=e.params,r=yield s.default.findOne({emailVerificationToken:o});if(!r)return n(new a.default("Invalid token",400));r.emailVerificationToken=void 0,r.verified=!0,yield r.save({validateBeforeSave:!1}),t.status(200).json({status:"success",message:"Your email has been verified"})})))),t.loginWithEmail=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{email:o,password:r}=e.body,i=yield s.default.findOne({email:o}).select("+password");return i&&(yield i.comparePassword(r,i.password))?!1===i.active?n(new a.default("Your account has been un activate  contact support to know more information",401)):void(0,l.createSendToken)(i,200,t):n(new a.default("Email or password not correct ",401))})))),t.logout=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!e.user)return n(new a.default("No user logged in",401));(0,l.createLogOutToken)(e.user,200,t)})))),t.forgotPassword=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!e.body.email)return n(new a.default("Please provide an email",400));const o=yield s.default.findOne({email:e.body.email});if(!o)return n(new a.default("No account found for this email",404));const r=o.createPasswordResetToken();yield o.save({validateBeforeSave:!1}),(0,p.default)(o,r),t.status(200).json({status:"success",message:"Reset password email sent"})})))),t.resetPassword=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{token:o}=e.params,{password:r,passwordConfirmation:d}=e.body;if(!r||!d)return n(new a.default("Please provide password and password confirmation",400));if(r!==d)return n(new a.default("Passwords do not match",400));if(r.length<8)return n(new a.default("Password must be at least 8 characters",400));const u=i.default.createHash("sha256").update(o).digest("hex"),l=yield s.default.findOne({passwordResetToken:u,passwordResetExpires:{$gt:Date.now()}});if(!l)return n(new a.default("Invalid token or expired token",400));l.password=e.body.password,l.passwordConfirmation=e.body.passwordConfirmation,l.passwordResetToken=void 0,l.passwordResetExpires=void 0,yield l.save(),t.status(200).json({status:"success",message:"Password has been reset successfully please login with your new password"})}))))},1015:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.checkoutWithStripe=t.checkoutWithCash=void 0;const i=n(6813),d=r(n(4960)),s=r(n(2489)),a=n(7333),u=n(9831),l=n(8805),c=n(6241),p=r(n(4441));t.checkoutWithCash=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shipAddress:o,shoppingCart:r,user:s,phoneNumber:p}=e,f=(0,u.createOrderObject)(s,r,o,p,i.PaymentStatus.PaymentOnDelivery,i.PaymentMethod.Cash,i.ShippingStatus.Pending,i.OrderStatus.Processing),h=(0,l.groupItemsByShop)(r.items),m=yield(0,c.processCheckout)(f,r,s,h);if(!m)return n(new d.default("Something went wrong with processing your order",500));const y={status:"success",data:m};(0,a.sendResponse)(200,y,t)})))),t.checkoutWithStripe=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shipAddress:o,shoppingCart:r,user:s,phoneNumber:f}=e,h=new p.default(process.env.STRIPE_SECRET_KEY),m=(0,u.createOrderObject)(s,r,o,f,i.PaymentStatus.Paid,i.PaymentMethod.CreditCard,i.ShippingStatus.Pending,i.OrderStatus.Processing),y=yield h.checkout.sessions.create({payment_method_types:["card"],mode:"payment",success_url:`${process.env.STRIPE_SUCCESS_URL}?session_id={CHECKOUT_SESSION_ID}`,cancel_url:process.env.STRIPE_CANCEL_URL,customer_email:s.email,line_items:r.items.map((e=>({price_data:{currency:"usd",product_data:{name:e.product.name},unit_amount:100*e.product.price},quantity:e.quantity})))}),g=(0,l.groupItemsByShop)(r.items);m.paymentSessionId=y.id;const v=yield(0,c.processCheckout)(m,r,s,g);if(!v)return n(new d.default("Something went wrong with processing your order",500));const b={status:"success",data:v};(0,a.sendResponse)(200,b,t)}))))},9447:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getDiscountCodeInformation=t.checkDiscountCodeValidate=t.unApplyDiscountCode=t.applyDiscountCode=void 0;const i=r(n(6049)),d=r(n(4960)),s=r(n(2489)),a=n(7333),u=n(5972),l=n(409);t.applyDiscountCode=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{userShoppingCart:n,discountCode:o}=e,r={status:"success",data:yield(0,u.applyCode)(o,n)};(0,a.sendResponse)(200,r,t)})))),t.unApplyDiscountCode=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{userShoppingCart:n,discountCode:o}=e,r={status:"success",data:yield(0,l.unApplyCode)(n)};(0,a.sendResponse)(200,r,t)})))),t.checkDiscountCodeValidate=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOne({code:e.body.code});if(!o)return n(new d.default("Invalid discount code",400));let r=o.endDate<new Date,s=o.isActive,a=!1;return o.usageLimit&&(a=o.usageLimit<=o.usageCount),t.status(200).json({status:"success",message:"Discount code information",data:{discountCode:o,isExpired:r,isActive:s,outOfUsageLimit:a}})})))),t.getDiscountCodeInformation=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOne({code:e.body.code});if(!o)return n(new d.default("No discount code found with this code name ",404));const r={status:"success",data:o};(0,a.sendResponse)(200,r,t)}))))},7891:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateDiscountCodeEndDate=t.disActivateDiscountCode=t.activateDiscountCode=t.deleteDiscountCode=t.updateDiscountCode=t.getDiscountCode=t.getDiscountCodes=t.createDiscountCode=void 0;const i=r(n(6049)),d=r(n(4960)),s=r(n(2489)),a=n(7333),u=r(n(7193)),l=n(7839);t.createDiscountCode=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shop:n}=e,o={status:"success",data:yield i.default.create(Object.assign(Object.assign({},e.body),{shop:n,discountCodeSource:l.DiscountCodeSource.SHOP}))};(0,a.sendResponse)(201,o,t)})))),t.getDiscountCodes=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new u.default(i.default.find({shop:e.user.myShop}),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,a.sendResponse)(200,r,t)})))),t.getDiscountCode=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOne({_id:e.params.id,shop:e.user.myShop});if(!o)return n(new d.default("No discount code found with this id and related to this shop",404));const r={status:"success",data:o};(0,a.sendResponse)(200,r,t)})))),t.updateDiscountCode=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOneAndUpdate({_id:e.params.id,shop:e.user.myShop},e.body,{new:!0,runValidators:!0});if(!o)return n(new d.default("No discount code found with this id and related to this shop",404));const r={status:"success",data:o};(0,a.sendResponse)(200,r,t)})))),t.deleteDiscountCode=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findOneAndDelete({_id:e.params.id,shop:e.user.myShop})))return n(new d.default("No discount code found with this id and related to this shop",404));(0,a.sendResponse)(200,{status:"success",message:"Discount code deleted successfully"},t)})))),t.activateDiscountCode=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOne({_id:e.params.id,shop:e.user.myShop});if(!o)return n(new d.default("No discount code found with this id and related to this shop",404));if(o.isActive)return n(new d.default("Discount code is already active",400));o.isActive=!0,yield o.save();const r={status:"success",data:o};(0,a.sendResponse)(200,r,t)})))),t.disActivateDiscountCode=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOne({_id:e.params.id,shop:e.user.myShop});if(!o)return n(new d.default("No discount code found with this id and related to this shop",404));if(!o.isActive)return n(new d.default("Discount code is already inactive",400));o.isActive=!1,yield o.save();const r={status:"success",data:o};(0,a.sendResponse)(200,r,t)})))),t.updateDiscountCodeEndDate=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOne({_id:e.params.id,shop:e.user.myShop});if(!o)return n(new d.default("No discount code found with this id and related to this shop",404));if(e.body.endDate<new Date)return n(new d.default("End date must be in the future",400));o.endDate=e.body.endDate,yield o.save();const r={status:"success",data:o};(0,a.sendResponse)(200,r,t)}))))},8045:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateDiscountCodeEndDate=t.disActivateDiscountCode=t.activateDiscountCode=t.deleteDiscountCode=t.updateDiscountCode=t.getDiscountCode=t.getDiscountCodes=t.createDiscountCode=void 0;const i=r(n(6049)),d=r(n(4960)),s=r(n(7193)),a=n(7839),u=r(n(2489)),l=n(7333);t.createDiscountCode=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n={status:"success",data:yield i.default.create(Object.assign(Object.assign({},e.body),{discountCodeSource:a.DiscountCodeSource.WEBSITE}))};(0,l.sendResponse)(201,n,t)})))),t.getDiscountCodes=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new s.default(i.default.find({discountCodeSource:a.DiscountCodeSource.WEBSITE}),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,l.sendResponse)(200,r,t)})))),t.getDiscountCode=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOne({_id:e.params.id,discountCodeSource:a.DiscountCodeSource.WEBSITE});if(!o)return n(new d.default("No discount code found with this id and related to the website",404));const r={status:"success",data:o};(0,l.sendResponse)(200,r,t)})))),t.updateDiscountCode=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOneAndUpdate({_id:e.params.id,discountCodeSource:a.DiscountCodeSource.WEBSITE},e.body,{new:!0,runValidators:!0});if(!o)return n(new d.default("No discount code found with this id and related to the website",404));const r={status:"success",data:o};(0,l.sendResponse)(200,r,t)})))),t.deleteDiscountCode=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findOneAndDelete({_id:e.params.id,discountCodeSource:a.DiscountCodeSource.WEBSITE})))return n(new d.default("No discount code found with this id and related to the website",404));(0,l.sendResponse)(200,{status:"success",message:"Discount code deleted successfully"},t)})))),t.activateDiscountCode=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOne({_id:e.params.id,discountCodeSource:a.DiscountCodeSource.WEBSITE});if(!o)return n(new d.default("No discount code found with this id and related to the website",404));if(o.isActive)return n(new d.default("Discount code is already active",400));o.isActive=!0,yield o.save();const r={status:"success",data:o};(0,l.sendResponse)(200,r,t)})))),t.disActivateDiscountCode=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOne({_id:e.params.id,discountCodeSource:a.DiscountCodeSource.WEBSITE});if(!o)return n(new d.default("No discount code found with this id and related to the website",404));if(!o.isActive)return n(new d.default("Discount code is already inactive",400));o.isActive=!1,yield o.save();const r={status:"success",data:o};(0,l.sendResponse)(200,r,t)})))),t.updateDiscountCodeEndDate=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOne({_id:e.params.id,discountCodeSource:a.DiscountCodeSource.WEBSITE});if(!o)return n(new d.default("No discount code found with this id and related to the  website",404));if(e.body.endDate<new Date)return n(new d.default("End date must be in the future",400));o.endDate=e.body.endDate,yield o.save();const r={status:"success",data:o};(0,l.sendResponse)(200,r,t)}))))},6613:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(4960));t.default=(e,t,n,o)=>{e.statusCode=e.statusCode||500,e.status=e.status||"error","CastError"===e.name&&(e=(e=>{const t=`Invalid ${e.path}: ${e.value}.`;return new r.default(t,400)})(e)),11e3===e.code&&(e=(e=>{const t=`Duplicate field value: ${Object.values(e.keyValue)[0]}. Please use another value!`;return new r.default(t,400)})(e)),"ValidationError"===e.name&&(e=(e=>{const t=`Invalid input data. ${Object.values(e.errors).map((e=>e.message)).join(". ")}`;return new r.default(t,400)})(e)),"JsonWebTokenError"===e.name&&(e=new r.default("Invalid token. Please log in again",401)),"TokenExpiredError"===e.name&&(e=new r.default("Your token has expired. Please log in again",401)),((e,t)=>{e.isOperational?t.status(e.statusCode).json({status:e.status,message:e.message}):(console.error("ERROR ðŸ’¥",e),t.status(500).json({status:"error",message:"Something went very wrong!"}))})(e,n)}},6136:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteMessage=t.updateMessage=t.getMessage=t.getMessages=t.createMessage=void 0;const i=r(n(2410)),d=n(5362),s=r(n(2489)),a=r(n(4960)),u=r(n(7193)),l=n(7333),c=r(n(2792)),p=r(n(2961));t.createMessage=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{sender:n,recipient:o}=e,{recipientType:r,subject:s,content:a,metaData:u}=e.body,f=new i.default({sender:n,recipient:o,recipientType:r,subject:s,content:a});void 0!==e.body.metaData&&(f.metaData=e.body.metaData),yield f.save(),r===d.RecipientType.SHOP&&(0,c.default)(o,f),r===d.RecipientType.USER&&(0,p.default)(o,f);const h={status:"success",message:"Message created successfully",data:f};(0,l.sendResponse)(201,h,t)})))),t.getMessages=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new u.default(i.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,message:"Messages retrieved successfully",data:o};(0,l.sendResponse)(200,r,t)})))),t.getMessage=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findById(e.params.id);if(!o)return n(new a.default("No message found with that ID",404));const r={status:"success",message:"Message retrieved successfully",data:o};(0,l.sendResponse)(200,r,t)})))),t.updateMessage=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findByIdAndUpdate(e.params.id,e.body,{new:!0,runValidators:!0});if(!o)return n(new a.default("No message found with that ID",404));const r={status:"success",message:"Message updated successfully",data:o};(0,l.sendResponse)(200,r,t)})))),t.deleteMessage=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findByIdAndDelete(e.params.id)))return n(new a.default("No message found with that ID",404));(0,l.sendResponse)(204,{status:"success",message:"Message deleted successfully",data:null},t)}))))},1170:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.unmuteNotifications=t.muteNotifications=t.deleteGroupOfNotification=t.markGroupAsRead=t.deleteAllUserNotifications=t.deleteUserNotification=t.markAllNotificationsAsRead=t.markNotificationAsRead=t.getUserNotification=t.getUserNotifications=t.createNotification=void 0;const i=r(n(3247)),d=r(n(2489)),s=r(n(4960)),a=r(n(7193)),u=n(7333),l=n(2492);t.createNotification=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{message:o,type:r,userId:d}=e.body;if(!o||!r)return n(new s.default("Invalid notification data.",400));const a=yield i.default.create({user:d,message:o,type:r});(0,l.getIO)().to(d.toString()).emit("notification",{type:"NEW_NOTIFICATION",payload:a});const c={status:"success",data:a};(0,u.sendResponse)(201,c,t)})))),t.getUserNotifications=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new a.default(i.default.find({user:e.user._id}),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,u.sendResponse)(200,r,t)})))),t.getUserNotification=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{user:o}=e,{id:r}=e.params,d=yield i.default.findOne({_id:r,user:o._id});if(!d)return n(new s.default("Notification with this id  not found",404));const a={status:"success",data:d};(0,u.sendResponse)(200,a,t)})))),t.markNotificationAsRead=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{user:o}=e,{id:r}=e.params,d=yield i.default.findOneAndUpdate({_id:r,user:o._id},{read:!0,readAt:new Date},{new:!0});if(!d)return n(new s.default("Notification with this id  not found",404));const a={status:"success",data:d};(0,u.sendResponse)(200,a,t)})))),t.markAllNotificationsAsRead=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{user:n}=e;yield i.default.updateMany({user:n._id},{read:!0,readAt:new Date}),(0,u.sendResponse)(200,{status:"success",data:"All notifications marked as read"},t)})))),t.deleteUserNotification=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{user:o}=e,{id:r}=e.params,d=yield i.default.findOneAndDelete({_id:r,user:o._id});if(!d)return n(new s.default("Notification with this id  not found",404));const a={status:"success",data:d};(0,u.sendResponse)(204,a,t)})))),t.deleteAllUserNotifications=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{user:n}=e;yield i.default.deleteMany({user:n._id}),(0,u.sendResponse)(204,{status:"success",data:"All notifications deleted"},t)})))),t.markGroupAsRead=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{groupOfNotificationIds:o}=e.body;if(!o||0===o.length)return n(new s.default("No notification IDs provided",400));const r=yield i.default.updateMany({_id:{$in:o},user:e.user._id},{$set:{read:!0,readAt:new Date}},{new:!0});if(0===r.modifiedCount)return n(new s.default("No unread notifications found with these IDs for the current user",404));const d={status:"success",data:{modifiedCount:r.modifiedCount}};(0,u.sendResponse)(200,d,t)})))),t.deleteGroupOfNotification=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{groupOfNotificationIds:o}=e.body;if(!o||0===o.length)return n(new s.default("No notification IDs provided",400));const r=yield i.default.deleteMany({_id:{$in:o},user:e.user._id});if(0===r.deletedCount)return n(new s.default("No unread notifications found with these IDs for the current user",404));const d={status:"success",data:{deletedCount:r.deletedCount}};(0,u.sendResponse)(200,d,t)})))),t.muteNotifications=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{user:o}=e;if(o.isNotificationMuted)return n(new s.default("Notifications are already muted",400));o.isNotificationMuted=!0,yield o.save({validateBeforeSave:!1}),(0,u.sendResponse)(200,{status:"success",data:"Notifications muted successfully"},t)})))),t.unmuteNotifications=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{user:o}=e;if(!o.isNotificationMuted)return n(new s.default("Notifications are already unmuted",400));o.isNotificationMuted=!1,yield o.save({validateBeforeSave:!1}),(0,u.sendResponse)(200,{status:"success",data:"Notifications unmuted successfully"},t)}))))},6604:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.delverOrder=t.updateOrderStatusToShipped=t.cancelOrder=t.getOrder=t.getOrders=void 0;const i=r(n(6037)),d=r(n(5939)),s=n(6813),a=r(n(2489)),u=r(n(4960)),l=r(n(7193)),c=n(7333),p=n(5475),f=n(3737),h=n(343),m=n(927),y=n(3638),g=r(n(839)),v=r(n(128)),b=r(n(688)),x=n(8865);t.getOrders=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new l.default(d.default.find(),e.query),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,c.sendResponse)(200,r,t)})))),t.getOrder=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{id:o}=e.params,r=yield d.default.findById(o);if(!r)return n(new u.default("Order not found",404));const i={status:"success",data:r};(0,c.sendResponse)(200,i,t)})))),t.cancelOrder=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{order:n,userOrderOwner:o}=e,r=yield i.default.startSession();r.startTransaction();try{n.orderStatus=s.OrderStatus.Cancelled,yield n.save({session:r}),yield(0,f.updateSubOrdersState)(n,r,s.OrderStatus.Cancelled),"credit_card"===n.paymentMethod&&"paid"===n.paymentStatus&&(yield(0,p.createRefundRequest)(o,r,n)),0!==n.paidAmountWithUserGiftCard&&(o.giftCard+=n.paidAmountWithUserGiftCard,yield o.save({validateBeforeSave:!1,session:r})),(0,b.default)(o,n),yield r.commitTransaction();const e={status:"success",message:"Order cancelled successfully"};(0,c.sendResponse)(200,e,t)}catch(e){throw console.error("Error cancelling order:",e),yield r.abortTransaction(),new u.default("Error cancelling order",500)}finally{r.endSession()}})))),t.updateOrderStatusToShipped=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{order:o,userOrderOwner:r}=e,d=yield i.default.startSession();d.startTransaction();try{o.shippingStatus=s.ShippingStatus.Shipped,yield o.save({session:d}),yield(0,h.updateSubOrderShippingStatus)(o,d,s.ShippingStatus.Shipped),(0,g.default)(r,o),yield d.commitTransaction();const e={status:"success",data:o};(0,c.sendResponse)(200,e,t)}catch(e){return yield d.abortTransaction(),n(new u.default("Error happen while updating the order shipping state",500))}finally{d.endSession()}})))),t.delverOrder=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{order:o,userOrderOwner:r}=e,d=yield i.default.startSession();d.startTransaction();try{if(o.orderStatus=s.OrderStatus.Delivered,o.shippingStatus=s.ShippingStatus.Delivered,!(yield o.save({session:d})))return yield d.abortTransaction(),n(new u.default("delver order process failed",500));yield(0,m.delverSubOrders)(o,d,s.ShippingStatus.Delivered,s.OrderStatus.Delivered),yield(0,x.updateUserLoyaltyPoints)(r,o,d),yield(0,y.updateShopsBalance)(o,d),(0,v.default)(r,o),yield d.commitTransaction();const e={status:"success",data:o};(0,c.sendResponse)(200,e,t)}catch(e){return yield d.abortTransaction(),console.log(e),n(new u.default("Error happen while updating the order delivery state",500))}finally{d.endSession()}}))))},3478:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getArchivedOrders=t.unarchiveOrder=t.archiveOrder=t.cancelOrder=t.getOrder=t.getOrders=void 0;const i=r(n(6037)),d=r(n(5939)),s=n(6813),a=r(n(2489)),u=r(n(4960)),l=r(n(7193)),c=n(7333),p=n(5475),f=n(3737),h=r(n(4676));t.getOrders=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new l.default(d.default.find({user:e.user._id,archived:!1}),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,c.sendResponse)(200,r,t)})))),t.getOrder=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield d.default.findOne({_id:e.params.id,user:e.user._id});if(!o)return n(new u.default("Order not found",404));const r={status:"success",data:o};(0,c.sendResponse)(200,r,t)})))),t.cancelOrder=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{order:o,userOrderOwner:r}=e,d=yield i.default.startSession();d.startTransaction();try{if(r._id.toString()!==e.user._id.toString())return n(new u.default("You are not authorized to cancel this order",403));o.orderStatus=s.OrderStatus.Cancelled,yield o.save({session:d}),yield(0,f.updateSubOrdersState)(o,d,s.OrderStatus.Cancelled),"credit_card"===o.paymentMethod&&"paid"===o.paymentStatus&&(yield(0,p.createRefundRequest)(r,d,o)),0!==o.paidAmountWithUserGiftCard&&(r.giftCard+=o.paidAmountWithUserGiftCard,yield r.save({validateBeforeSave:!1,session:d})),(0,h.default)(r,o),yield d.commitTransaction();const i={status:"success",message:"Order cancelled successfully"};(0,c.sendResponse)(200,i,t)}catch(e){throw console.error("Error cancelling order:",e),yield d.abortTransaction(),new u.default("Error cancelling order",500)}finally{d.endSession()}})))),t.archiveOrder=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield d.default.findOne({_id:e.params.id,user:e.user._id});if(!o)return n(new u.default("Order not found",404));if(!0===o.archived)return n(new u.default("Order is already archived",400));o.archived=!0,yield o.save();const r={status:"success",data:o};(0,c.sendResponse)(200,r,t)})))),t.unarchiveOrder=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield d.default.findOne({_id:e.params.id,user:e.user._id});if(!o)return n(new u.default("Order not found",404));if(!1===o.archived)return n(new u.default("Order is already un-archived",400));o.archived=!1,yield o.save();const r={status:"success",data:o};(0,c.sendResponse)(200,r,t)})))),t.getArchivedOrders=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new l.default(d.default.find({user:e.user._id,archived:!0}),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,c.sendResponse)(200,r,t)}))))},8185:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSubOrder=t.getSubOrder=t.getSubOrders=t.deleteOrder=t.getOrder=t.getAllOrders=void 0;const i=r(n(5027)),d=r(n(2489)),s=r(n(4960)),a=r(n(7193)),u=n(7333);t.getAllOrders=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new a.default(i.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,u.sendResponse)(200,r,t)})))),t.getOrder=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{orderId:o}=e.params,r=yield i.default.findById(o);if(!r)return n(new s.default("No order found with this id.",404));const d={status:"success",data:r};(0,u.sendResponse)(200,d,t)})))),t.deleteOrder=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{orderId:o}=e.params;if(!(yield i.default.findByIdAndDelete(o)))return n(new s.default("No order found with this id.",404));(0,u.sendResponse)(204,{status:"success",message:"Order deleted successfully."},t)})))),t.getSubOrders=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new a.default(i.default.find({shop:e.shopId}),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,u.sendResponse)(200,r,t)})))),t.getSubOrder=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOne({shop:e.shopId,_id:e.params.orderId});if(!o)return n(new s.default("No order found with this id.",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.deleteSubOrder=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findOneAndDelete({shop:e.shopId,_id:e.params.orderId})))return n(new s.default("No order found with this id.",404));(0,u.sendResponse)(204,{status:"success",data:null},t)}))))},8895:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cancelPrimeSubscription=t.createPrimeSubscription=t.deletePrimeSubscription=t.updatePrimeSubscription=t.getPrimeSubscriptionById=t.getAllPrimeSubscriptions=void 0;const i=r(n(6037)),d=r(n(2819)),s=r(n(3388)),a=n(976),u=r(n(4960)),l=r(n(7193)),c=r(n(2489)),p=n(7333),f=n(4884),h=r(n(7115)),m=r(n(6289));t.getAllPrimeSubscriptions=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new l.default(s.default.find(),e.query),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,p.sendResponse)(200,r,t)})))),t.getPrimeSubscriptionById=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield s.default.findById(e.params.id);if(!o)return n(new u.default("No prime subscription found with this id.",404));const r={status:"success",data:o};(0,p.sendResponse)(200,r,t)})))),t.updatePrimeSubscription=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield s.default.findByIdAndUpdate(e.params.id,e.body,{new:!0});if(!o)return n(new u.default("No prime subscription found with this id.",404));const r={status:"success",data:o};(0,p.sendResponse)(200,r,t)})))),t.deletePrimeSubscription=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const r=yield i.default.startSession();try{yield r.withTransaction((()=>o(void 0,void 0,void 0,(function*(){const t=yield s.default.findByIdAndDelete(e.params.id,{session:r});if(!t)throw new u.default("No prime subscription found with this id.",404);if(!(yield d.default.findByIdAndUpdate(t.user,{$unset:{primeSubscriptionStatus:"",lastPrimeSubscriptionDocument:void 0},$set:{isPrimeUser:!1}},{session:r,new:!0,runValidators:!0})))throw new u.default("Something went wrong while deleting user prime subscription",404)}))));const n={status:"success",message:"Prime subscription successfully deleted"};(0,p.sendResponse)(200,n,t)}catch(e){return console.error("Error in deletePrimeSubscription:",e),e instanceof u.default?n(e):n(new u.default("Error while deleting prime subscription",500))}finally{yield r.endSession()}})))),t.createPrimeSubscription=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=yield i.default.startSession();n.startTransaction();try{const{userToSubscribe:o}=e,r=new s.default({user:o,nextBillingDate:new Date((new Date).setDate((new Date).getDate()+30)),startDate:(new Date).setDate((new Date).getDate()),endDate:new Date((new Date).setDate((new Date).getDate()+30)),status:a.PrimeSubscriptionStatus.ACTIVE,plan:a.PrimeSubscriptionPlan.MONTHLY,originalSubscriptionAmount:f.SUBSCRIPTION_PLANS[a.PrimeSubscriptionPlan.MONTHLY].originalAmount,discountedSubscriptionAmount:f.SUBSCRIPTION_PLANS[a.PrimeSubscriptionPlan.MONTHLY].discountedAmount,subscriptionAmount:f.SUBSCRIPTION_PLANS[a.PrimeSubscriptionPlan.MONTHLY].originalAmount-f.SUBSCRIPTION_PLANS[a.PrimeSubscriptionPlan.MONTHLY].discountedAmount,paymentMethod:a.PrimeSubscriptionPaymentMethod.PAYED_BY_ADMIN});void 0!==e.prevPrimeSubscription&&(r.lastBillingDate=e.prevPrimeSubscription.createdAt);const i=yield r.save({session:n});o.isPrimeUser=!0,o.primeSubscriptionStatus=a.PrimeSubscriptionStatus.ACTIVE,o.lastPrimeSubscriptionDocument=i._id,yield o.save({validateBeforeSave:!1,session:n}),yield n.commitTransaction(),(0,h.default)(o,r);const d={status:"success",data:r};(0,p.sendResponse)(201,d,t)}catch(e){throw console.error(e),n.abortTransaction(),n.endSession(),new u.default("Error while creating prime subscription",500)}finally{n.endSession()}})))),t.cancelPrimeSubscription=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{userToSubscribe:o,prevPrimeSubscription:r}=e;if(void 0===r)return n(new u.default("something went wrong while tray to get user last subscription information",500));const d=yield i.default.startSession();d.startTransaction();try{r.status=a.PrimeSubscriptionStatus.CANCELLED,r.cancellationDate=new Date,void 0!==e.body.cancellationReason&&(r.cancellationReason=e.body.cancellationReason),yield r.save({session:d}),o.isPrimeUser=!1,o.primeSubscriptionStatus=a.PrimeSubscriptionStatus.CANCELLED,yield o.save({validateBeforeSave:!1,session:d}),yield d.commitTransaction(),(0,m.default)(o,r);const n={status:"success",message:"prime subscription successfully cancelled "};(0,p.sendResponse)(200,n,t)}catch(e){throw console.error(e),d.abortTransaction(),d.endSession(),new u.default("Error while cancelling prime subscription",500)}finally{d.endSession()}}))))},9788:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cancelMySubscription=t.renewMySubscription=t.getAllPreviousSubscriptions=t.getMyLatestPrimeSubscription=t.confirmPrimeSubscription=t.createUserPrimeSubscription=void 0;const i=r(n(6037)),d=r(n(3388)),s=n(976),a=r(n(4960)),u=r(n(7193)),l=r(n(2489)),c=n(7333),p=n(4884),f=r(n(7115)),h=r(n(6289)),m=new(r(n(4441)).default)(process.env.STRIPE_SECRET_KEY,{apiVersion:"2024-04-10"});t.createUserPrimeSubscription=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=yield i.default.startSession();n.startTransaction();try{const{user:o}=e;if(!o)throw new a.default("User not found",404);const r=yield m.paymentIntents.create({amount:p.SUBSCRIPTION_PLANS[s.PrimeSubscriptionPlan.MONTHLY].originalAmount,currency:"usd",payment_method_types:["card"],metadata:{userId:o._id.toString(),subscriptionPlan:s.PrimeSubscriptionPlan.MONTHLY}}),i=new d.default({user:o._id,nextBillingDate:new Date((new Date).setDate((new Date).getDate()+30)),startDate:new Date,endDate:new Date((new Date).setDate((new Date).getDate()+30)),status:s.PrimeSubscriptionStatus.PENDING,plan:s.PrimeSubscriptionPlan.MONTHLY,originalSubscriptionAmount:p.SUBSCRIPTION_PLANS[s.PrimeSubscriptionPlan.MONTHLY].originalAmount,discountedSubscriptionAmount:p.SUBSCRIPTION_PLANS[s.PrimeSubscriptionPlan.MONTHLY].discountedAmount,subscriptionAmount:p.SUBSCRIPTION_PLANS[s.PrimeSubscriptionPlan.MONTHLY].originalAmount-p.SUBSCRIPTION_PLANS[s.PrimeSubscriptionPlan.MONTHLY].discountedAmount,paymentMethod:s.PrimeSubscriptionPaymentMethod.STRIPE,stripePaymentIntentId:r.id}),u=yield i.save({session:n});o.isPrimeUser=!1,o.primeSubscriptionStatus=s.PrimeSubscriptionStatus.PENDING,o.lastPrimeSubscriptionDocument=u._id,yield o.save({validateBeforeSave:!1,session:n}),yield n.commitTransaction();const l={status:"success",data:{clientSecret:r.client_secret,subscriptionId:u._id}};(0,c.sendResponse)(201,l,t)}catch(e){throw console.error(e),yield n.abortTransaction(),new a.default("Error while creating prime subscription",500)}finally{n.endSession()}})))),t.confirmPrimeSubscription=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{paymentIntentId:n}=e.body,{user:o}=e;if(!o)throw new a.default("User not found",404);const r=yield d.default.findOne({user:o._id,stripePaymentIntentId:n,status:s.PrimeSubscriptionStatus.PENDING});if(!r)throw new a.default("Subscription not found or already processed",404);if("succeeded"!==(yield m.paymentIntents.retrieve(n)).status)throw new a.default("Payment not successful",400);r.status=s.PrimeSubscriptionStatus.ACTIVE,yield r.save(),o.isPrimeUser=!0,o.primeSubscriptionStatus=s.PrimeSubscriptionStatus.ACTIVE,yield o.save({validateBeforeSave:!1}),(0,f.default)(o,r),(0,c.sendResponse)(200,{status:"success",message:"Prime subscription activated successfully"},t)})))),t.getMyLatestPrimeSubscription=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!e.user.lastPrimeSubscriptionDocument)return n(new a.default("Your information about your latest subscription could  not be found.",404));const o=yield d.default.findOne({user:e.user._id,_id:e.user.lastPrimeSubscriptionDocument});if(!o)return n(new a.default("Your information about your latest subscription could  not be found.",404));(0,c.sendResponse)(200,{data:o},t)})))),t.getAllPreviousSubscriptions=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new u.default(d.default.find({user:e.user}),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,c.sendResponse)(200,r,t)})))),t.renewMySubscription=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){})))),t.cancelMySubscription=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{user:n,latestSubscription:o}=e,r=yield i.default.startSession();r.startTransaction();try{o.status=s.PrimeSubscriptionStatus.CANCELLED,o.cancellationDate=new Date,o.cancellationReason=e.body.cancellationReason,yield o.save({session:r}),n.isPrimeUser=!1,n.primeSubscriptionStatus=s.PrimeSubscriptionStatus.CANCELLED,yield n.save({validateBeforeSave:!1,session:r}),yield r.commitTransaction();const i={status:"success",message:"Your prime membership has been cancelled."};(0,h.default)(n,o),(0,c.sendResponse)(200,i,t)}catch(e){throw yield r.abortTransaction(),new a.default("something went wrong during cancellation of your prime subscription",500)}finally{r.endSession()}}))))},2335:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteProcessedShopRequest=t.updateProcessedShopRequest=t.getProcessedShopRequest=t.getAllProcessedShopRequests=void 0;const i=r(n(2993)),d=r(n(2489)),s=r(n(4960)),a=r(n(7193)),u=n(7333);t.getAllProcessedShopRequests=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new a.default(i.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,u.sendResponse)(200,r,t)})))),t.getProcessedShopRequest=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findById(e.params.id);if(!o)return n(new s.default("Processed shop request not found",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.updateProcessedShopRequest=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findByIdAndUpdate(e.params.id,e.body,{new:!0,runValidators:!0});if(!o)return n(new s.default("Processed shop request not found",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.deleteProcessedShopRequest=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findByIdAndDelete(e.params.id)))return n(new s.default("Processed shop request not found",404));(0,u.sendResponse)(204,{status:"success",data:null},t)}))))},4633:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteProcessedDeleteShopRequest=t.updateProcessedDeleteShopRequest=t.createProcessedDeleteShopRequest=t.getProcessedDeleteShopRequest=t.getAllProcessedDeleteShopRequests=void 0;const i=r(n(6805)),d=r(n(2489)),s=r(n(4960)),a=r(n(7193)),u=n(7333);t.getAllProcessedDeleteShopRequests=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new a.default(i.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,u.sendResponse)(200,r,t)})))),t.getProcessedDeleteShopRequest=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findById(e.params.id);if(!o)return n(new s.default("Processed delete shop request not found",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.createProcessedDeleteShopRequest=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n={status:"success",data:yield i.default.create(e.body)};(0,u.sendResponse)(201,n,t)})))),t.updateProcessedDeleteShopRequest=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findByIdAndUpdate(e.params.id,e.body,{new:!0});if(!o)return n(new s.default("Processed delete shop request not found",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.deleteProcessedDeleteShopRequest=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findByIdAndDelete(e.params.id)))return n(new s.default("Processed delete shop request not found",404));(0,u.sendResponse)(204,{status:"success",data:null},t)}))))},9085:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteProcessedRefundRequest=t.updateProcessedRefundRequest=t.getProcessedRefundRequest=t.getProcessedRefundRequests=void 0;const i=r(n(8603)),d=r(n(2489)),s=r(n(4960)),a=r(n(7193)),u=n(7333);t.getProcessedRefundRequests=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new a.default(i.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,u.sendResponse)(200,r,t)})))),t.getProcessedRefundRequest=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findById(e.params.id);if(!o)return n(new s.default("No processed refund request found with this id.",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.updateProcessedRefundRequest=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findById(e.params.id)))return n(new s.default("No processed refund request found with this id",404));const o={status:"success",data:yield i.default.findByIdAndUpdate(e.params.id,e.body,{new:!0,runValidators:!0})};(0,u.sendResponse)(200,o,t)})))),t.deleteProcessedRefundRequest=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findById(e.params.id)))return n(new s.default("No processed refund request found with this id.",404));yield i.default.deleteOne({_id:e.params.id}),(0,u.sendResponse)(204,{status:"success",data:null},t)}))))},5653:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteProcessedReturnProductRequest=t.updateProcessedReturnProductRequest=t.getProcessedReturnProductRequest=t.getProcessedReturnProductRequests=void 0;const i=r(n(1385)),d=r(n(2489)),s=r(n(4960)),a=r(n(7193)),u=n(7333);t.getProcessedReturnProductRequests=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new a.default(i.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,u.sendResponse)(200,r,t)})))),t.getProcessedReturnProductRequest=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findById(e.params.id);if(!o)return n(new s.default("No processed refund request found with this id.",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.updateProcessedReturnProductRequest=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findByIdAndUpdate(e.params.id,e.body,{new:!0,runValidators:!0});if(!o)return n(new s.default("No processed refund request found with this id",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.deleteProcessedReturnProductRequest=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findByIdAndDelete(e.params.id)))return n(new s.default("No processed refund request found with this id.",404));(0,u.sendResponse)(200,{status:"success",data:null},t)}))))},3797:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteProcessedSupportTicket=t.updateProcessedSupportTicket=t.getProcessedSupportTicket=t.getProcessedSupportTickets=void 0;const i=r(n(5127)),d=r(n(2489)),s=r(n(4960)),a=r(n(7193)),u=n(7333);t.getProcessedSupportTickets=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new a.default(i.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,u.sendResponse)(200,r,t)})))),t.getProcessedSupportTicket=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findById(e.params.id);if(!o)return n(new s.default("No support ticket found with that ID",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.updateProcessedSupportTicket=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findByIdAndUpdate(e.params.id,e.body,{new:!0,runValidators:!0});if(!o)return n(new s.default("No support ticket found with this ID",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.deleteProcessedSupportTicket=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findByIdAndDelete(e.params.id)))return n(new s.default("No support ticket found with this ID",404));(0,u.sendResponse)(204,{status:"success",message:"Support ticket deleted successfully"},t)}))))},4163:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteProduct=t.updateProduct=t.createProduct=t.getProduct=t.getAllProducts=void 0;const i=r(n(2059)),d=r(n(2489)),s=r(n(4960)),a=r(n(7193)),u=n(7333);t.getAllProducts=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new a.default(i.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,u.sendResponse)(200,r,t)})))),t.getProduct=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findById(e.params.id);if(!o)return n(new s.default("Product not found",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.createProduct=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.create(e.body);if(!o)return n(new s.default("something went wrong",400));const r={status:"success",data:o};(0,u.sendResponse)(201,r,t)})))),t.updateProduct=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findByIdAndUpdate(e.params.id,e.body,{new:!0,runValidators:!0});if(!o)return n(new s.default("Product not found",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.deleteProduct=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findByIdAndDelete(e.params.id)))return n(new s.default("Product not found",404));(0,u.sendResponse)(204,{status:"success",data:null},t)}))))},7949:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.rejectReturnItems=t.approveReturnItems=t.getReturnItemRequest=t.getAllReturnItemsRequests=t.deleteReturnItemRequest=t.getMyReturnRequestItem=t.getAllMyReturnItems=t.cancelReturnRequest=t.requestReturnItems=void 0;const i=r(n(6037)),d=r(n(5496)),s=r(n(5976)),a=r(n(5061)),u=n(4876),l=n(581),c=r(n(2489)),p=r(n(4960)),f=r(n(7193)),h=n(7333),m=r(n(6538)),y=r(n(4880)),g=r(n(7176)),v=r(n(3848)),b=r(n(2559)),x=r(n(1302)),w=r(n(8915));t.requestReturnItems=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{orderId:o,quantity:r,returnReason:i}=e.body,s=e.user,u=e.returnedProduct,c=yield d.default.create({user:s._id,order:o,product:u.product,quantity:r,returnReason:i,refundAmount:u.priceAfterDiscount});if(!c)return n(new p.default("Something went wrong please tray agin.",400));if(c.product.sourceType===l.ProductSourceType.Shop){const e=yield a.default.findById(c.product.shopId);e&&(0,b.default)(e,c)}(0,y.default)(s,c);const f={status:"success",data:c};(0,h.sendResponse)(201,f,t)})))),t.cancelReturnRequest=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{id:o}=e.params;if(!o)return n(new p.default("Invalid request provide request ID",400));const r=yield d.default.findById(o);if(!r)return n(new p.default("No return request with this ID",404));if(r.returnStatus!==u.ReturnStatus.Pending)return n(new p.default("You can't cancel this request only pending cancellation requests can be cancelled.",400));(0,g.default)(e.user,r);const i={status:"success",data:r};(0,h.sendResponse)(200,i,t)})))),t.getAllMyReturnItems=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new f.default(d.default.find({user:e.user._id}),e.query).filter().sort().limitFields().paginate(),o={status:"success",data:yield n.execute()};(0,h.sendResponse)(200,o,t)})))),t.getMyReturnRequestItem=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{id:o}=e.params;if(!o)return n(new p.default("Invalid request provide request ID",400));const r=yield d.default.findOne({_id:o,user:e.user._id});if(!r)return n(new p.default("No return request with this ID",404));const i={status:"success",data:r};(0,h.sendResponse)(200,i,t)})))),t.deleteReturnItemRequest=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{id:o}=e.params;if(!o)return n(new p.default("Invalid request provide request ID",400));const r=yield d.default.findByIdAndDelete({_id:o,user:e.user._id});if(!r)return n(new p.default("No return request with this ID",404));const i={status:"success",data:r};(0,h.sendResponse)(200,i,t)})))),t.getAllReturnItemsRequests=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new f.default(d.default.find(),e.query).filter().sort().limitFields().paginate(),o={status:"success",data:yield n.execute()};(0,h.sendResponse)(200,o,t)})))),t.getReturnItemRequest=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{id:o}=e.params;if(!o)return n(new p.default("Invalid request provide request ID",400));const r=yield d.default.findById(o);if(!r)return n(new p.default("No return request with this ID",404));const i={status:"success",data:r};(0,h.sendResponse)(200,i,t)})))),t.approveReturnItems=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{order:n,userToReturn:o,returnRequest:r}=e,d=yield i.default.startSession();d.startTransaction();try{let i;const c=r.product.sourceType===l.ProductSourceType.Shop;c&&(i=yield a.default.findById(r.product.shopId).session(d)),r.returnStatus=u.ReturnStatus.Approved,r.receivedItemsStatus=u.ReceivedItemsStatus.Received,r.processedBy=e.user._id,r.processedDate=new Date,yield r.save({session:d});const p=new s.default({order:n._id,user:o._id,refundAmount:r.refundAmount,refundMethod:"giftCard",refundType:"return",refundStatus:"pending"});c&&i&&(p.isRelatedToShop=!0,p.shop=i),yield p.save({session:d}),c&&i&&(0,x.default)(i,p),setImmediate((()=>{(0,m.default)(o,p,r)})),yield d.commitTransaction();const f={status:"success",data:r};(0,h.sendResponse)(200,f,t)}catch(e){throw yield d.abortTransaction(),new p.default(e.message||"Something went wrong please try again.",400)}finally{yield d.endSession()}})))),t.rejectReturnItems=(0,c.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{order:o,userToReturn:r,returnRequest:i}=e,{rejectionReason:d}=e.body;if(!d)return new p.default("You have to provide reason for reject return item / product request..",400);if(i.returnStatus=u.ReturnStatus.Rejected,i.receivedItemsStatus=u.ReceivedItemsStatus.Received,i.processedBy=e.user._id,i.processedDate=new Date,i.rejectionReason=d,!(yield i.save()))return n(new p.default("Something went wrong while updating return request.",400));if(i.product.sourceType===l.ProductSourceType.Shop){const e=yield a.default.findById(i.product.shopId);e&&(0,w.default)(e,i)}(0,v.default)(r,i);const s={status:"success",data:i};(0,h.sendResponse)(200,s,t)}))))},1737:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.rejectRefundRequest=t.confirmRefundRequest=t.deleteRefundRequest=t.getRefundRequest=t.getAllRefundRequestsConfirmed=t.getAllRefundRequestsNotConfirmed=t.getAllRefundRequests=t.createRefundRequest=void 0;const i=r(n(5976)),d=r(n(8603)),s=n(1132),a=r(n(2489)),u=r(n(4960)),l=r(n(7193)),c=n(7333),p=r(n(6818)),f=r(n(3537)),h=r(n(7740)),m=r(n(4378));t.createRefundRequest=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n={status:"success",data:yield i.default.create({user:e.body.user,order:e.body.order,refundAmount:e.body.refundAmount,refundMethod:e.body.refundMethod,refundType:e.body.refundType})};(0,c.sendResponse)(201,n,t)})))),t.getAllRefundRequests=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new l.default(i.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,c.sendResponse)(200,r,t)})))),t.getAllRefundRequestsNotConfirmed=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new l.default(i.default.find({refundStatus:"pending"}),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,c.sendResponse)(200,r,t)})))),t.getAllRefundRequestsConfirmed=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new l.default(i.default.find({refundStatus:"confirmed"}),e.query).filter().sort().limitFields().paginate(),o={status:"success",data:yield n.execute()};(0,c.sendResponse)(200,o,t)})))),t.getRefundRequest=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{id:o}=e.params;if(!o)return n(new u.default("Invalid request provide request ID",400));const r=yield i.default.findById(o);if(!r)return n(new u.default("Refund request not found",404));const d={status:"success",data:r};(0,c.sendResponse)(200,d,t)})))),t.deleteRefundRequest=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{id:o}=e.params;return o?(yield i.default.findByIdAndDelete({_id:o}))?void(0,c.sendResponse)(200,{status:"success",data:null},t):n(new u.default("No Refund Request with this id",404)):n(new u.default("Invalid request provide request ID",400))})))),t.confirmRefundRequest=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{refundRequest:r,userToRefund:i,order:a}=e;i.giftCard+=r.refundAmount,yield i.save({validateBeforeSave:!1}),r.refundStatus=s.RefundStatus.Confirmed,r.processedBy=e.user._id,r.refundProcessedAt=new Date,yield r.save(),r.isRelatedToShop&&r.shop&&(r.shop.balance-=r.refundAmount,yield r.shop.save({validateBeforeSave:!1}),(0,m.default)(r.shop,r)),(0,p.default)(i,r),((e,t,n,r,i)=>{o(void 0,void 0,void 0,(function*(){if(!(yield d.default.create({user:{_id:e._id,email:e.email,name:e.name,phoneNumber:e.phoneNumber},order:t,processedBy:{_id:r._id,email:r.email,name:r.name,phoneNumber:r.phoneNumber,role:r.role},refundAmount:n.refundAmount,refundMethod:n.refundMethod,refundType:n.refundType,refundStatus:"confirmed",refundProcessedAt:new Date,refundCreatedAt:n.createdAt,refundLastUpdate:n.updatedAt})))return i(new u.default("Error while processing refund request",500))}))})(i,a,r,e.user,n);const l={status:"success",data:r};(0,c.sendResponse)(200,l,t)})))),t.rejectRefundRequest=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{rejectReason:o}=e.body;if(!o)return n(new u.default("Please provide reject reason  for the refund request",400));const{refundRequest:r,userToRefund:i,order:d}=e;r.refundStatus=s.RefundStatus.Rejected,r.rejectReason=o,yield r.save(),r.isRelatedToShop&&r.shop&&(0,h.default)(r.shop,r),(0,f.default)(i,r);const a={status:"success",data:r};(0,c.sendResponse)(200,a,t)}))))},1510:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.resolveReport=t.deleteReport=t.updateReport=t.getReport=t.getAllReports=t.createReport=void 0;const i=r(n(656)),d=r(n(2489)),s=r(n(4960)),a=r(n(7193)),u=n(7333);t.createReport=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shop:n,user:o}=e,{reason:r,description:d}=e.body,s={status:"success",data:yield i.default.create({reportedShop:n._id,reportedBy:o._id,reason:r,description:d})};(0,u.sendResponse)(201,s,t)})))),t.getAllReports=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new a.default(i.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,u.sendResponse)(200,r,t)})))),t.getReport=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findById(e.params.id);if(!o)return n(new s.default("No report found with that ID",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.updateReport=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findByIdAndUpdate(e.params.id,e.body);if(!o)return n(new s.default("No report found with that ID",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.deleteReport=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findByIdAndDelete(e.params.id)))return n(new s.default("No report found with that ID",404));(0,u.sendResponse)(204,{status:"success",message:"Report deleted successfully"},t)})))),t.resolveReport=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{report:n}=e;n.resolved=!0,n.resolvedBy=e.user,n.resolvedAt=new Date,void 0!==e.body.resolvedByComments&&(n.resolvedByComments=e.body.resolvedByComments);const o={status:"success",message:"Report resolved successfully",data:yield n.save()};(0,u.sendResponse)(200,o,t)}))))},2254:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getProductReviews=t.deleteReview=t.updateReview=t.addReview=t.getReview=t.getReviews=void 0;const i=r(n(1177)),d=r(n(4960)),s=r(n(2489)),a=r(n(7193)),u=n(7333);t.getReviews=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new a.default(i.default.find({user:e.user._id}),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,u.sendResponse)(200,r,t)})))),t.getReview=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findById(e.params.id);if(!o)return n(new d.default("Review not found",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.addReview=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{productId:n,rating:o,comment:r}=e.body,d={status:"success",data:yield i.default.create({user:e.user._id,product:n,rating:o,comment:r})};(0,u.sendResponse)(201,d,t)})))),t.updateReview=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOneAndUpdate({_id:e.params.id,user:e.user._id},e.body,{new:!0,runValidators:!0});if(!o)return n(new d.default("Review not found",404));const r={status:"success",data:o};(0,u.sendResponse)(200,r,t)})))),t.deleteReview=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findOneAndDelete({_id:e.params.id,user:e.user._id})))return n(new d.default("Review not found",404));(0,u.sendResponse)(204,{status:"success",data:null},t)})))),t.getProductReviews=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new a.default(i.default.find({product:e.params.productId}),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,u.sendResponse)(200,r,t)}))))},2759:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cancelDeleteShopRequest=t.rejectDeleteShopRequest=t.approveDeleteShopRequest=t.deleteDeleteShopRequest=t.updateDeleteShopRequest=t.createDeleteShopRequest=t.getDeleteShopRequest=t.getAllDeleteShopRequests=void 0;const i=r(n(6037)),d=r(n(619)),s=r(n(6805)),a=r(n(5061)),u=n(8473),l=r(n(2489)),c=r(n(4960)),p=r(n(7193)),f=n(7333),h=n(8098),m=r(n(4943)),y=r(n(1516)),g=r(n(5704));t.getAllDeleteShopRequests=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new p.default(d.default.find(),e.query).filter().sort().limitFields().paginate(),o={status:"success",data:yield n.execute()};(0,f.sendResponse)(200,o,t)})))),t.getDeleteShopRequest=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield d.default.findById(e.params.id);if(!o)return n(new c.default("No delete shop request found with this id",404));const r={status:"success",data:o};(0,f.sendResponse)(200,r,t)})))),t.createDeleteShopRequest=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{userId:o,shopId:r,reason:i}=e.body,s=yield d.default.create({user:o,shop:r,reason:i});if(!s)return n(new c.default("Something went wrong",400));const a={status:"success",data:s};(0,f.sendResponse)(201,a,t)})))),t.updateDeleteShopRequest=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield d.default.findByIdAndUpdate(e.params.id,e.body,{new:!0,runValidators:!0});if(!o)return n(new c.default("No delete shop request found with this id",404));const r={status:"success",data:o};(0,f.sendResponse)(200,r,t)})))),t.deleteDeleteShopRequest=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield d.default.findByIdAndDelete(e.params.id)))return n(new c.default("No delete shop request found with this id",404));(0,f.sendResponse)(200,{status:"success",data:null},t)})))),t.approveDeleteShopRequest=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.startSession();o.startTransaction();try{const{shopOwner:r,deleteShopRequest:i,shop:l}=e;i.requestStatus=u.RequestStatus.Approved,i.processedBy=e.user,yield i.save({session:o,validateBeforeSave:!1});const c={user:{name:r.name,email:r.email,phoneNumber:r.phoneNumber},shop:{shopName:l.shopName,email:l.email,phone:l.phone},processedBy:{name:e.user.name,email:e.user.email},reason:i.reason,processedAt:new Date,requestStatus:i.requestStatus};yield s.default.create([c],{session:o}),yield a.default.findByIdAndDelete(l._id).session(o),yield d.default.findByIdAndDelete(i._id).session(o),yield(0,h.cascadeShopDeletion)(l,o,n),r.myShop=void 0,yield r.save({session:o,validateBeforeSave:!1}),yield o.commitTransaction(),yield(0,m.default)(r,l,i);const p={status:"success",message:"Shop deleted successfully.",data:null};(0,f.sendResponse)(200,p,t)}catch(e){throw yield o.abortTransaction(),e instanceof c.default?e:new c.default("Error occurred during shop deletion approval",500)}finally{o.endSession()}})))),t.rejectDeleteShopRequest=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopOwner:n,deleteShopRequest:o,shop:r}=e;o.requestStatus=u.RequestStatus.Rejected,o.processedBy=e.user,yield o.save({validateBeforeSave:!1});const i={user:{name:n.name,email:n.email,phoneNumber:n.phoneNumber},shop:{shopName:r.shopName,email:r.email,phone:r.phone},processedBy:{name:e.user.name,email:e.user.email},reason:o.reason,processedAt:new Date,requestStatus:o.requestStatus};yield s.default.create(i),yield d.default.findByIdAndDelete(o._id),(0,g.default)(n,r,o),(0,f.sendResponse)(200,{status:"success",message:"Shop deleted request rejected contact shops support for more data.",data:null},t)})))),t.cancelDeleteShopRequest=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopOwner:n,deleteShopRequest:o,shop:r}=e;o.requestStatus=u.RequestStatus.Cancelled,o.processedBy=e.user,yield o.save({validateBeforeSave:!1});const i={user:{name:n.name,email:n.email,phoneNumber:n.phoneNumber},shop:{shopName:r.shopName,email:r.email,phone:r.phone},processedBy:{name:e.user.name,email:e.user.email},reason:o.reason,processedAt:new Date,requestStatus:o.requestStatus};yield s.default.create(i),yield d.default.findByIdAndDelete(o._id),(0,y.default)(n,r,o),(0,f.sendResponse)(200,{status:"success",message:"Shop deleted request canceled successfully if you have more question contact shops support.",data:null},t)}))))},587:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.unfreezeProduct=t.freezeProduct=t.deleteProduct=t.updateProduct=t.addProduct=t.getAllProducts=void 0;const i=r(n(5061)),d=r(n(2059)),s=r(n(2489)),a=r(n(4960)),u=r(n(7193)),l=n(7333),c=r(n(5448)),p=r(n(502)),f=r(n(8912)),h=r(n(8611)),m=r(n(332));t.getAllProducts=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=yield i.default.findById(e.params.shopId),o=new u.default(d.default.find({shopId:n.id}),e.query).filter().sort().limitFields().paginate(),r=yield o.execute(),s={status:"success",results:r.length,data:r};(0,l.sendResponse)(200,s,t)})))),t.addProduct=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield d.default.create(e.productInformation);if(e.shop.productCount+=1,yield e.shop.save(),!o)return n(new a.default("something went wrong while creating the new product",500));(0,c.default)(e.user,e.shop,o);const r={status:"success",data:o};(0,l.sendResponse)(201,r,t)})))),t.updateProduct=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{product:n,shop:o}=e;yield d.default.updateOne({_id:n._id},e.body),(0,p.default)(e.user,o,n),(0,l.sendResponse)(200,{status:"success",message:"Product updated successfully"},t)})))),t.deleteProduct=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{product:n,shop:o}=e;yield d.default.deleteOne({_id:n._id}),(0,f.default)(e.user,e.shop,n),(0,l.sendResponse)(200,{status:"success",message:"Product deleted successfully"},t)})))),t.freezeProduct=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{product:n,shop:o}=e;yield d.default.updateOne({_id:n._id},{freezed:!0}),(0,h.default)(e.user,o,n),(0,l.sendResponse)(200,{status:"success",message:"Product has been frozen successfully"},t)})))),t.unfreezeProduct=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{product:n,shop:o}=e;yield d.default.updateOne({_id:n._id},{freezed:!1}),(0,m.default)(e.user,o,n),(0,l.sendResponse)(200,{status:"success",message:"Product has been unfrozen successfully"},t)}))))},2238:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.rejectShopRequest=t.confirmShopRequest=t.deleteShopRequest=t.updateShopRequest=t.getShopRequest=t.getAllShopRequests=t.createShopRequest=t.cancelShopRequest=void 0;const i=r(n(6884)),d=r(n(5061)),s=r(n(2993)),a=n(7652),u=r(n(2489)),l=r(n(4960)),c=r(n(7193)),p=n(7333),f=r(n(8112)),h=r(n(9039)),m=r(n(1242)),y=r(n(9764)),g=(e,t,n,r)=>o(void 0,void 0,void 0,(function*(){(yield s.default.create({user:{name:e.name,email:e.email,phoneNumber:e.phoneNumber,_id:e._id,role:e.role},shopDescription:t.shopDescription,requestStatus:r,processedBy:{name:n.name,email:n.email,phoneNumber:n.phoneNumber,_id:n._id,role:n.role},processedDate:new Date,requestCreatedDate:t.createdAt,requestLastUpdatedDate:t.updatedAt}))&&(yield i.default.findByIdAndDelete(t._id))})),v=(e,t,n)=>o(void 0,void 0,void 0,(function*(){t.requestStatus=e,t.processedBy=n._id,t.processedAt=new Date,yield t.save()}));t.cancelShopRequest=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopRequest:n}=e;yield v(a.RequestStatus.Cancelled,n,e.user),(0,h.default)(e.user,n),yield g(e.user,n,e.user,"cancelled");const o={status:"success",message:"Shop request cancelled successfully.",data:n};(0,p.sendResponse)(200,o,t)})))),t.createShopRequest=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopDescription:n}=e.body,o=e.user,r=yield i.default.create({shopDescription:n,user:o._id});(0,f.default)(o,r);const d={status:"success",message:"Shop request created successfully.",data:r};(0,p.sendResponse)(201,d,t)})))),t.getAllShopRequests=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new c.default(i.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,p.sendResponse)(200,r,t)})))),t.getShopRequest=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findById(e.params.id);if(!o)return n(new l.default("Shop request not found",404));const r={status:"success",data:o};(0,p.sendResponse)(200,r,t)})))),t.updateShopRequest=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findByIdAndUpdate(e.params.id,e.body,{new:!0,runValidators:!0});if(!o)return n(new l.default("Shop request not found",404));const r={status:"success",message:"Shop request updated successfully.",data:o};(0,p.sendResponse)(200,r,t)})))),t.deleteShopRequest=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findByIdAndDelete(e.params.id)))return n(new l.default("Shop request not found",404));(0,p.sendResponse)(204,{status:"success",message:"Shop request deleted successfully.",data:null},t)})))),t.confirmShopRequest=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{userToOpenShop:n,shopRequest:o}=e,r=((e,t)=>({owner:e._id,email:e.email,phone:e.phoneNumber,shopName:e.name,shopDescription:t.shopDescription||""}))(n,o),i=yield d.default.create(r);n.myShop=i,yield n.save({validateBeforeSave:!1}),yield v(a.RequestStatus.Approved,o,e.user),(0,y.default)(n,i),yield g(n,o,e.user,"approved");const s={status:"success",message:"Shop request approved successfully.",data:o};(0,p.sendResponse)(200,s,t)})))),t.rejectShopRequest=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{rejectionReason:n}=e.body,{shopRequest:o,userToOpenShop:r}=e;yield v(a.RequestStatus.Rejected,o,e.user),(0,m.default)(r,o,n),yield g(r,o,e.user,"rejected");const i={status:"success",message:"Shop request rejected successfully.",data:o};(0,p.sendResponse)(200,i,t)}))))},6518:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteShopRequest=t.deactivateShop=t.activateShop=t.getMyShop=t.resetShopEmailAddressToDefault=t.verifyChangedShopEMail=t.updateShopEmailAddress=t.updateShopBanner=t.updateShopInformation=void 0;const i=n(9896),d=r(n(1416)),s=r(n(5061)),a=r(n(619)),u=r(n(2489)),l=r(n(4960)),c=n(7333),p=r(n(7110)),f=r(n(2086)),h=r(n(7460)),m=r(n(8352)),y=r(n(871));t.updateShopInformation=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=e.shop,{shopName:o,shopDescription:r,shopPhoneNumber:a,photo:u}=e.body;console.log(e.body);const l={};if(o&&(l.shopName=o),r&&(l.description=r),a&&(l.phoneNumber=a),e.file){const t=yield d.default.v2.uploader.upload(e.file.path);yield i.promises.unlink(e.file.path),l.photo=t.secure_url,l.photoPublicId=t.public_id}const p={status:"success",message:"Shop information updated successfully.",data:yield s.default.findByIdAndUpdate(n._id,l,{new:!0})};(0,c.sendResponse)(200,p,t)})))),t.updateShopBanner=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=e.shop;if(e.file){const t=yield d.default.v2.uploader.upload(e.file.path);yield i.promises.unlink(e.file.path),n.banner=t.secure_url,n.bannerId=t.public_id,yield n.save()}(0,c.sendResponse)(200,{status:"success",message:"Shop banner updated successfully."},t)})))),t.updateShopEmailAddress=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{email:n}=e.body,{shop:o}=e,r=e.user,i=o.createChangeEmailVerificationToken();(0,p.default)(r,o,i,n),o.tempChangedEmail=n,yield o.save({validateBeforeSave:!1}),(0,c.sendResponse)(200,{status:"success",message:"Shop email verification email successfully sent, check your email to confirm the email change"},t)})))),t.verifyChangedShopEMail=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{user:o,shop:r}=e,i=r.tempChangedEmail;if(!i)return n(new l.default("something went wrong pleas tray again to request shop email change.",404));r.email=i,r.tempChangedEmail=void 0,r.changeEmailVerificationToken=void 0,r.changeEmailVerificationTokenExpiresAt=void 0,yield r.save({validateBeforeSave:!1}),(0,h.default)(o,r),(0,f.default)(i,o,r),(0,c.sendResponse)(200,{status:"success",message:"Shop email successfully updated your shop will be manged by the new email."},t)})))),t.resetShopEmailAddressToDefault=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=e.user.myShop;if(!o)return n(new l.default("You don't have a shop yet, please create one first.",404));const r=yield s.default.findById(o);if(r.email===e.user.email)return n(new l.default("Shop email is already the default email address.",400));r.email=e.user.email,yield r.save({validateBeforeSave:!1}),(0,m.default)(e.user,r),(0,c.sendResponse)(200,{status:"success",message:"Shop email successfully reset to the default account  email."},t)})))),t.getMyShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=e.user.myShop;if(!o)return n(new l.default("You don't have a shop yet, please create one first.",404));const r={status:"success",data:yield s.default.findById(o)};(0,c.sendResponse)(200,r,t)})))),t.activateShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=e.user.myShop;if(!o)return n(new l.default("You don't have a shop yet, please create one first.",404));const r=yield s.default.findById(o);if(r.isActive)return n(new l.default("Shop is already active.",400));r.isActive=!0,yield r.save({validateBeforeSave:!1}),(0,c.sendResponse)(200,{status:"success",message:"Shop successfully activated."},t)})))),t.deactivateShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=e.user.myShop;if(!o)return n(new l.default("You don't have a shop yet, please create one first.",404));const r=yield s.default.findById(o);if(!r.isActive)return n(new l.default("Shop is already un active.",400));r.isActive=!1,yield r.save({validateBeforeSave:!1}),(0,c.sendResponse)(200,{status:"success",message:"Shop un activated successfully."},t)})))),t.deleteShopRequest=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=e.body.reason,r=e.user,i=e.user.myShop;if(!o)return n(new l.default("Please provide a reason for deleting the shop.",400));const d=yield s.default.findById(i);if(!d)return n(new l.default("You don't have a shop yet, please create one first.",404));if(yield a.default.findOne({shop:d._id}))return n(new l.default("Delete shop request for this shop already created please wait until your request processed.",400));const u=yield a.default.create({user:r._id,shop:d._id,reason:o});d.isActive=!1,yield d.save({validateBeforeSave:!1}),(0,y.default)(r,d,u),(0,c.sendResponse)(200,{status:"success",message:"Shop request successfully sent for deletion."},t)}))))},2773:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getSingleOrderCreatedOnShop=t.getAllOrdersCreatedOnShop=t.unfreezingProductInShop=t.freezingProductInShop=t.getSingleProductInShop=t.getAllProductsInShop=t.unActiveShop=t.activateShop=t.updateShop=t.deleteShop=t.getShop=t.getAllShops=void 0;const i=r(n(6037)),d=r(n(5061)),s=r(n(2059)),a=r(n(5027)),u=r(n(2489)),l=r(n(4960)),c=r(n(7193)),p=n(7333),f=n(8098);t.getAllShops=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new c.default(d.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,p.sendResponse)(200,r,t)})))),t.getShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopId:o}=e.params,r=yield d.default.findById(o);if(!r)return n(new l.default("No shop found with this id.",404));const i={status:"success",data:r};(0,p.sendResponse)(200,i,t)})))),t.deleteShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.startSession();o.startTransaction();try{const r=yield d.default.findByIdAndDelete(e.params.shopId).session(o);if(!r)throw new l.default("Shop not found",404);yield(0,f.cascadeShopDeletion)(r,o,n),yield o.commitTransaction();const i={status:"success",data:null};(0,p.sendResponse)(204,i,t)}catch(e){throw yield o.abortTransaction(),e}finally{o.endSession()}})))),t.updateShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopId:o}=e.params,r=yield d.default.findByIdAndUpdate(o,e.body,{new:!0,runValidators:!0});if(!r)return n(new l.default("No shop found with this id.",404));const i={status:"success",data:r};(0,p.sendResponse)(200,i,t)})))),t.activateShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopId:o}=e.params,r=yield d.default.findById(o);if(!r)return n(new l.default("No shop found with this id.",404));if(r.isActive)return n(new l.default("Shop is already active.",400));r.isActive=!0,yield r.save();const i={status:"success",message:"Shop activated successfully.",data:r};(0,p.sendResponse)(200,i,t)})))),t.unActiveShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopId:o}=e.params,r=yield d.default.findById(o);if(!r)return n(new l.default("No shop found with this id.",404));if(!r.isActive)return n(new l.default("Shop is already un-active.",400));r.isActive=!1,yield r.save();const i={status:"success",message:"Shop un-activated successfully.",data:r};(0,p.sendResponse)(200,i,t)})))),t.getAllProductsInShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopId:o}=e.params,r=yield d.default.findById(o);if(!r)return n(new l.default("No shop found with this id.",404));const i=new c.default(s.default.find({sourceType:"shop",shopId:r._id}),e.query).filter().sort().limitFields().paginate(),a=yield i.execute(),u={status:"success",results:a.length,data:a};(0,p.sendResponse)(200,u,t)})))),t.getSingleProductInShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield s.default.findOne({sourceType:"shop",shopId:e.params.shopId,_id:e.params.productId});if(!o)return n(new l.default("No product found with this id and related to this shop ",404));const r={status:"success",data:o};(0,p.sendResponse)(200,r,t)})))),t.freezingProductInShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopId:o,productId:r}=e.params,i=yield d.default.findById(o);if(!i)return n(new l.default("No shop found with this id.",404));const a=yield s.default.findOne({sourceType:"shop",shopId:i._id,_id:r});if(!a)return n(new l.default("No product found with this id and related to this shop ",404));if(a.freezed)return n(new l.default("Product is already frozen.",400));a.freezed=!0,yield a.save();const u={status:"success",message:"Product frozen successfully.",data:a};(0,p.sendResponse)(200,u,t)})))),t.unfreezingProductInShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopId:o,productId:r}=e.params,i=yield d.default.findById(o);if(!i)return n(new l.default("No shop found with this id.",404));const a=yield s.default.findOne({sourceType:"shop",shopId:i._id,_id:r});if(!a)return n(new l.default("No product found with this id and related to this shop ",404));if(!a.freezed)return n(new l.default("Product is not frozen.",400));a.freezed=!1,yield a.save();const u={status:"success",message:"Product un-freezed successfully",data:a};(0,p.sendResponse)(200,u,t)})))),t.getAllOrdersCreatedOnShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopId:o}=e.params,r=yield d.default.findById(o);if(!r)return n(new l.default("No shop found with this id.",404));const i=new c.default(a.default.find({shop:r._id}),e.query).filter().sort().limitFields().paginate(),s=yield i.execute(),u={status:"success",results:s.length,data:s};(0,p.sendResponse)(200,u,t)})))),t.getSingleOrderCreatedOnShop=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopId:o,orderId:r}=e.params,i=yield a.default.findOne({shop:o,_id:r});if(!i)return n(new l.default("No order found with this id and related to this shop.",404));const d={status:"success",data:i};(0,p.sendResponse)(200,d,t)}))))},4347:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.clearShoppingCart=t.decreaseItemQuantity=t.removeItemFromShoppingCart=t.addItemToShoppingCart=t.getShoppingCart=t.updateShoppingCart=t.deleteShoppingCart=t.getShoppingCartById=t.getAllShoppingCarts=void 0;const i=r(n(1573)),d=r(n(7543)),s=r(n(2489)),a=r(n(4960)),u=r(n(7193)),l=n(7333),c=n(8216);t.getAllShoppingCarts=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new u.default(i.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,l.sendResponse)(200,r,t)})))),t.getShoppingCartById=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findById(e.params.id);if(!o)return n(new a.default("Shopping cart not found",404));const r={status:"success",data:o};(0,l.sendResponse)(200,r,t)})))),t.deleteShoppingCart=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findByIdAndDelete(e.params.id)))return n(new a.default("Shopping cart not found",404));(0,l.sendResponse)(204,{status:"success",message:"Shopping cart deleted successfully"},t)})))),t.updateShoppingCart=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findByIdAndUpdate(e.params.id,e.body,{new:!0,runValidators:!0});if(!o)return n(new a.default("Shopping cart not found with provided id",404));const r={status:"success",data:o};(0,l.sendResponse)(200,r,t)})))),t.getShoppingCart=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.findOne({user:e.user._id});if(!o)return yield(0,c.createAndAssignShoppingCart)(e.user),n(new a.default("Your shopping cart not exits we created a shopping cart for you please tray again and if the problem still exits contact support.",400));const r={status:"success",data:o};(0,l.sendResponse)(200,r,t)})))),t.addItemToShoppingCart=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{productId:o,quantity:r}=e.body,{userShopCart:s,product:u,userShoppingCartItem:c}=e;if(c&&(c.quantity+=r,yield c.save()),!c){const t=yield d.default.create({cart:e.user.shoppingCart,product:o,quantity:r,price:u.price});s.items.push(t),yield s.save()}const p=yield i.default.findById(e.user.shoppingCart);if(!p)return n(new a.default("something went wrong",400));p.calculateTotals(),p.save();const f={status:"success",data:p};(0,l.sendResponse)(200,f,t)})))),t.removeItemFromShoppingCart=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{userShopCart:n,userShoppingCartItem:o}=e;yield d.default.findByIdAndDelete(o._id),n.items=n.items.filter((e=>!e.equals(o._id))),n.calculateTotals(),yield n.save();const r={status:"success",data:n};(0,l.sendResponse)(200,r,t)})))),t.decreaseItemQuantity=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{userShoppingCartItem:o}=e,{quantity:r}=e.body;(1===o.quantity||o.quantity<=r||o.quantity-r==0)&&(yield d.default.findByIdAndDelete(o._id)),o.quantity>r&&(o.quantity-=r,yield o.save());const s=yield i.default.findById(e.user.shoppingCart);if(!s)return n(new a.default("Something went wrong with your shopping-Cart",404));s.calculateTotals(),yield s.save(),(0,l.sendResponse)(200,{status:"success",message:"Product quantity updated successfully"},t)})))),t.clearShoppingCart=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield i.default.startSession();o.startTransaction();try{const r=yield i.default.findOneAndUpdate({user:e.user._id},{$set:{items:[],total_quantity:0,total_discount:0,total_price:0,total_shipping_cost:0,payment_status:"pending",payment_method:"cash"}},{new:!0,session:o});if(!r)return yield o.abortTransaction(),n(new a.default("You are not authorized",401));if(!(yield d.default.deleteMany({cart:e.user.shoppingCart},{session:o})).acknowledged)return yield o.abortTransaction(),n(new a.default("Failed to clear the shopping cart",400));yield o.commitTransaction();const s={status:"success",data:r};(0,l.sendResponse)(200,s,t)}catch(e){return yield o.abortTransaction(),n(new a.default(e.message||"Failed to clear the shopping cart",500))}finally{o.endSession()}}))))},1351:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.processSupportTicket=t.deleteShopSupportTicket=t.updateShopSupportTicket=t.getShopSupportTicket=t.getShopSupportTickets=t.createShopSupportTicket=t.deleteMyShopSupportTicket=t.updateMyShopSupportTicket=t.getMyShopSupportTicket=t.getMyShopSupportTickets=t.openShopSupportTicket=void 0;const i=n(9896),d=r(n(1416)),s=r(n(7378)),a=n(4990),u=r(n(2489)),l=r(n(4960)),c=r(n(7193)),p=n(7333),f=r(n(9701)),h=r(n(4693));t.openShopSupportTicket=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{subject:n,description:o,category:r}=e.body,a={subject:n,description:o,category:r,user:e.user._id,shop:e.shop._id};if(e.file){const t=yield d.default.v2.uploader.upload(e.file.path);yield i.promises.unlink(e.file.path),a.img=t.secure_url,a.imgPublicId=t.public_id}const u=yield s.default.create(a);(0,f.default)(e.shop,e.user,u);const l={status:"success",data:u};(0,p.sendResponse)(201,l,t)})))),t.getMyShopSupportTickets=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new c.default(s.default.find({shop:e.user.myShop}),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,p.sendResponse)(200,r,t)})))),t.getMyShopSupportTicket=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield s.default.findOne({shop:e.user.myShop,_id:e.params.ticketId});if(!o)return n(new l.default("Ticket not found",404));const r={status:"success",data:o};(0,p.sendResponse)(200,r,t)})))),t.updateMyShopSupportTicket=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{subject:o,description:r,category:a}=e.body,u={};if(o&&(u.subject=o),r&&(u.description=r),a&&(u.category=a),e.file){const t=yield d.default.v2.uploader.upload(e.file.path);yield i.promises.unlink(e.file.path),u.img=t.secure_url,u.imgPublicId=t.public_id}const c=yield s.default.findOneAndUpdate({_id:e.params.ticketId,user:e.user._id},u,{new:!0,runValidators:!0});if(!c)return n(new l.default("Ticket not found with this id",404));const f={status:"success",data:c};(0,p.sendResponse)(200,f,t)})))),t.deleteMyShopSupportTicket=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield s.default.findOneAndDelete({shop:e.user.myShop,_id:e.params.ticketId});if(!o)return n(new l.default("Ticket not found with this id",404));o.imgPublicId&&(yield d.default.v2.uploader.destroy(o.imgPublicId)),(0,p.sendResponse)(200,{status:"success",message:"Ticket deleted successfully",data:null},t)})))),t.createShopSupportTicket=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{subject:n,description:o,category:r,userId:a,shopId:u}=e.body,l={subject:n,description:o,category:r,user:e.userToCreateTicket._id,shop:e.shop._id};if(e.file){const t=yield d.default.v2.uploader.upload(e.file.path);yield i.promises.unlink(e.file.path),l.img=t.secure_url,l.imgPublicId=t.public_id}const c=yield s.default.create(l);(0,f.default)(e.shop,e.userToCreateTicket,c);const h={status:"success",data:c};(0,p.sendResponse)(201,h,t)})))),t.getShopSupportTickets=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new c.default(s.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,p.sendResponse)(200,r,t)})))),t.getShopSupportTicket=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield s.default.findById(e.params.ticketId);if(!o)return n(new l.default("Ticket not found",404));const r={status:"success",data:o};(0,p.sendResponse)(200,r,t)})))),t.updateShopSupportTicket=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{subject:o,description:r,category:a,status:u}=e.body,c={};if(o&&(c.subject=o),r&&(c.description=r),a&&(c.category=a),u&&(c.status=u),e.file){const t=yield d.default.v2.uploader.upload(e.file.path);yield i.promises.unlink(e.file.path),c.img=t.secure_url,c.imgPublicId=t.public_id}const f=yield s.default.findByIdAndUpdate(e.params.ticketId,c,{new:!0,runValidators:!0});if(!f)return n(new l.default("Ticket not found with this id",404));const h={status:"success",data:f};(0,p.sendResponse)(200,h,t)})))),t.deleteShopSupportTicket=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield s.default.findByIdAndDelete(e.params.ticketId);if(!o)return n(new l.default("No Ticket  found with this id",404));o.imgPublicId&&(yield d.default.v2.uploader.destroy(o.imgPublicId)),(0,p.sendResponse)(200,{status:"success",message:"Ticket deleted successfully",data:null},t)})))),t.processSupportTicket=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopOwner:n,shop:o,ticket:r}=e,{ticketResponse:i}=e.body;r.status=a.SupportTicketStatus.Closed,r.ticketResponse=i,r.ticketProcessedDate=new Date,r.processedBy={user:e.user._id,name:e.user.name,email:e.user.email,phoneNumber:e.user.phoneNumber,role:e.user.role};const d=yield r.save();(0,h.default)(o,n,d);const s={status:"success",data:d};(0,p.sendResponse)(200,s,t)}))))},6931:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.supportTicketResponse=t.deleteSupportTicket=t.updateSupportTicket=t.createSupportTicket=t.getSupportTicket=t.getSupportTickets=t.deleteMySupportTicket=t.updateMySupportTicket=t.getMySupportTicket=t.getMySupportTickets=t.openSupportTicket=void 0;const i=r(n(5127)),d=r(n(6909)),s=r(n(2819)),a=n(7003),u=r(n(4960)),l=r(n(2489)),c=n(7333),p=r(n(7193)),f=r(n(8085)),h=r(n(2316));t.openSupportTicket=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{subject:n,description:o,category:r}=e.body,i=yield d.default.create({user:e.user._id,subject:n,description:o,category:r});(0,f.default)(e.user,i);const s={status:"success",data:i};(0,c.sendResponse)(201,s,t)})))),t.getMySupportTickets=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new p.default(d.default.find({user:e.user._id}),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,c.sendResponse)(200,r,t)})))),t.getMySupportTicket=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield d.default.findOne({_id:e.params.id,user:e.user._id});if(!o)return n(new u.default("Support Ticket not found with this id.",404));const r={status:"success",data:o};(0,c.sendResponse)(200,r,t)})))),t.updateMySupportTicket=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{subject:o,description:r,category:i}=e.body,s={};o&&(s.subject=o),r&&(s.description=r),i&&(s.category=i);const a=yield d.default.findOneAndUpdate({_id:e.params.id,user:e.user._id},s,{new:!0,runValidators:!0});if(!a)return n(new u.default("Support Ticket not found with this id.",404));const l={status:"success",data:a};(0,c.sendResponse)(200,l,t)})))),t.deleteMySupportTicket=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield d.default.findOneAndDelete({_id:e.params.id,user:e.user._id});if(!o)return n(new u.default("Support Ticket not found with this id",404));const r={status:"success",data:o};(0,c.sendResponse)(200,r,t)})))),t.getSupportTickets=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new p.default(d.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,c.sendResponse)(200,r,t)})))),t.getSupportTicket=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield d.default.findById({_id:e.params.id});if(!o)return n(new u.default("Support Ticket not found with this id.",404));const r={status:"success",data:o};(0,c.sendResponse)(200,r,t)})))),t.createSupportTicket=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{subject:o,description:r,category:i,userId:a}=e.body,l=yield s.default.findById(a);if(!l)return n(new u.default("User you tray to create support ticket for is not exist please provide a valid user id.",404));const p=yield d.default.create({user:l._id,subject:o,description:r,category:i});(0,f.default)(l,p);const h={status:"success",data:p};(0,c.sendResponse)(201,h,t)})))),t.updateSupportTicket=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield d.default.findByIdAndUpdate(e.params.id,e.body,{new:!0,runValidators:!0});if(!o)return n(new u.default("Support Ticket not found with this id.",404));const r={status:"success",data:o};(0,c.sendResponse)(200,r,t)})))),t.deleteSupportTicket=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield d.default.findByIdAndDelete(e.params.id);if(!o)return n(new u.default("Support Ticket not found",404));const r={status:"success",data:o};(0,c.sendResponse)(200,r,t)})))),t.supportTicketResponse=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{id:r}=e.params,{ticketResponse:l}=e.body;if(!l)return n(new u.default("Please provide a response",400));const p=yield d.default.findById(r);if(!p)return n(new u.default("No support ticket found with this id.",404));const f=yield s.default.findById(p.user);if(!f)return n(new u.default("User who open this support ticket is no longer exist.",404));p.status=a.TicketStatus.Closed,p.processedBy={user:e.user._id,name:e.user.name,email:e.user.email,phoneNumber:e.user.phoneNumber,role:e.user.role},p.ticketProcessedDate=new Date,p.ticketResponse=l;const m=yield p.save();(0,h.default)(f,m,l),((e,t)=>{o(void 0,void 0,void 0,(function*(){(yield i.default.create({user:e,subject:t.subject,description:t.description,category:t.category,status:t.status,processedBy:{user:t.processedBy.user,name:t.processedBy.name,email:t.processedBy.email,phoneNumber:t.processedBy.phoneNumber,role:t.processedBy.role},ticketCreatedDate:t.createdAt,ticketLastUpdatedDate:t.updatedAt,ticketProcessedDate:t.ticketProcessedDate,ticketResponse:t.ticketResponse}))&&(yield d.default.findByIdAndDelete(t._id))}))})(f,m),(0,c.sendResponse)(200,{status:"success",message:"Support Ticket response sent successfully"},t)}))))},9194:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.convertLoyaltyPointsIntoBalance=t.getMe=t.deleteMe=t.deactivateMe=t.updateMyPassword=t.updateMyInfo=t.deactivateUser=t.activateUser=t.deleteUser=t.updateUser=t.createUser=t.getUser=t.getAllUsers=void 0;const i=n(9896),d=r(n(1416)),s=r(n(6037)),a=r(n(2819)),u=r(n(1573)),l=r(n(2489)),c=r(n(4960)),p=n(5138),f=n(5269),h=n(7333),m=n(8148),y=r(n(7193));t.getAllUsers=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new y.default(a.default.find(),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,h.sendResponse)(200,r,t)})))),t.getUser=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield a.default.findById(e.params.id);if(!o)return n(new c.default("User not found",404));const r={status:"success",data:o};(0,h.sendResponse)(200,r,t)})))),t.createUser=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield a.default.create(e.body);if(!o)return n(new c.default("something went wrong during creating the user account .",400));yield u.default.create({user:o._id});const r={status:"success",data:o};(0,h.sendResponse)(201,r,t)})))),t.updateUser=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield a.default.findByIdAndUpdate(e.params.id,e.body,{new:!0,runValidators:!0});if(!o)return n(new c.default("User not found",404));const r={status:"success",data:o};(0,h.sendResponse)(200,r,t)})))),t.deleteUser=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield s.default.startSession();o.startTransaction();try{const r=yield a.default.findByIdAndDelete(e.params.id,{session:o});if(!r)return yield o.abortTransaction(),o.endSession(),n(new c.default("User not found",404));yield(0,p.cascadeUserDeletion)(r,o,n),yield o.commitTransaction(),o.endSession();const i={status:"success",data:null};(0,h.sendResponse)(204,i,t)}catch(e){return yield o.abortTransaction(),o.endSession(),n(new c.default("Error occurred during user deletion",500))}})))),t.activateUser=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield a.default.findById(e.params.id);return o?o.active?n(new c.default("User already activated",400)):(o.active=!0,yield o.save({validateBeforeSave:!1}),void(0,h.sendResponse)(200,{status:"success",data:null},t)):n(new c.default("No user exist with this id.",404))})))),t.deactivateUser=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield a.default.findById(e.params.id);return o?o.active?(o.active=!1,yield o.save({validateBeforeSave:!1}),void(0,h.sendResponse)(200,{status:"success",data:null},t)):n(new c.default("User already deactivated",400)):n(new c.default("No user exist with this id.",404))})))),t.updateMyInfo=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=Object.assign({},e.body);if(e.file){const t=yield d.default.v2.uploader.upload(e.file.path);yield i.promises.unlink(e.file.path),o.photo=t.secure_url,o.photoPublicId=t.public_id,e.user.photoPublicId&&(yield d.default.v2.uploader.destroy(e.user.photoPublicId))}const r=yield a.default.findByIdAndUpdate(e.user._id,o,{new:!0,runValidators:!0});if(!r)return n(new c.default("You are not authorized",401));const s={status:"success",data:r};(0,h.sendResponse)(200,s,t)})))),t.updateMyPassword=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{currentPassword:o,newPassword:r,passwordConfirmation:i}=e.body,d=yield a.default.findById(e.user._id).select("+password");if(!(yield d.comparePassword(o,d.password)))return n(new c.default("Current password is incorrect",401));d.password=r,d.passwordConfirmation=i,yield d.save(),(0,f.createSendToken)(d,200,t)})))),t.deactivateMe=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){e.user.active=!1,yield e.user.save({validateBeforeSave:!1}),(0,h.sendResponse)(200,{status:"success",data:null},t)})))),t.deleteMe=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield s.default.startSession();o.startTransaction();try{const r=yield a.default.findByIdAndDelete(e.user._id,{session:o});if(!r)return yield o.abortTransaction(),o.endSession(),n(new c.default("You are not authorized",401));yield(0,p.cascadeUserDeletion)(r,o,n),yield o.commitTransaction(),o.endSession();const i={status:"success",data:null};(0,h.sendResponse)(204,i,t)}catch(e){return yield o.abortTransaction(),o.endSession(),n(new c.default("Error occurred during account deletion",500))}})))),t.getMe=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=yield a.default.findById(e.user._id);if(!o)return n(new c.default("Your not authorized ",401));const r={status:"success",data:o};(0,h.sendResponse)(200,r,t)})))),t.convertLoyaltyPointsIntoBalance=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{user:o}=e;if(o.loyaltyPoints<1e3)return n(new c.default("You don't have enough points to convert",400));const r=1e3*Math.floor(o.loyaltyPoints/1e3),{monetaryValue:i}=(0,m.getPointsAndValue)(r);o.loyaltyPoints-=r,o.giftCard=(o.giftCard||0)+i,yield o.save({validateBeforeSave:!1});const d={status:"success",message:`You have successfully converted ${r} points into ${i} $ gift card balance`};(0,h.sendResponse)(200,d,t)}))))},8889:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.clearWishlist=t.removeItemFromWishlist=t.addItemToWishlist=t.getWishlist=void 0;const i=r(n(3915)),d=r(n(4960)),s=r(n(2489)),a=n(7333),u=r(n(7193));t.getWishlist=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const n=new u.default(i.default.find({user:e.user._id}),e.query).filter().sort().limitFields().paginate(),o=yield n.execute(),r={status:"success",results:o.length,data:o};(0,a.sendResponse)(200,r,t)})))),t.addItemToWishlist=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(yield i.default.findOne({user:e.user._id,product:e.params.productId}))return n(new d.default("Item already on the wishlist",400));const o=yield i.default.create({user:e.user._id,product:e.params.productId});if(!o)return n(new d.default("something went wrong",400));const r={status:"success",results:1,data:o};(0,a.sendResponse)(200,r,t)})))),t.removeItemFromWishlist=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.findOneAndDelete({user:e.user._id,__id:e.params.productId})))return n(new d.default("something went wrong",400));(0,a.sendResponse)(204,{status:"success",data:null},t)})))),t.clearWishlist=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.deleteMany({user:e.user._id})))return n(new d.default("something went wrong",400));(0,a.sendResponse)(204,{status:"success",data:null},t)}))))},688:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your Order has been Cancelled",html:`\n      <!DOCTYPE html>\n      <html lang="en">\n      <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Order Cancellation</title>\n    <style>\n        body {\n            font-family: 'Helvetica Neue', Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 600px;\n            margin: 0 auto;\n            padding: 20px;\n            background-color: #f9f9f9;\n        }\n        .container {\n            background-color: #ffffff;\n            padding: 40px;\n            border-radius: 8px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n        }\n        .header {\n            color: #E74C3C;\n            font-size: 28px;\n            margin-bottom: 20px;\n        }\n        .alert {\n            background-color: #fff5f5;\n            border-left: 4px solid #E74C3C;\n            padding: 15px;\n            margin-bottom: 20px;\n        }\n        .alert p {\n            margin: 0;\n            color: #E74C3C;\n        }\n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-bottom: 20px;\n        }\n        th, td {\n            padding: 10px;\n            border: 1px solid #ddd;\n            text-align: left;\n        }\n        th {\n            background-color: #f2f2f2;\n        }\n        .footer {\n            border-top: 1px solid #e0e0e0;\n            padding-top: 20px;\n            margin-top: 40px;\n            text-align: center;\n            font-size: 14px;\n            color: #777;\n        }\n        @media only screen and (max-width: 600px) {\n            table, tr, td {\n                display: block;\n            }\n            tr {\n                margin-bottom: 10px;\n            }\n            td {\n                border: none;\n                position: relative;\n                padding-left: 50%;\n            }\n            td:before {\n                content: attr(data-label);\n                position: absolute;\n                left: 6px;\n                width: 45%;\n                padding-right: 10px;\n                white-space: nowrap;\n                font-weight: bold;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class="container">\n        <h2 class="header">Hello ${e.name},</h2>\n        <p>We are writing to confirm that your order has been cancelled.</p>\n        \n        <div class="alert">\n            <p>Please note: There was an issue with the order.</p>\n        </div>\n\n        <table>\n            <tr>\n                <th>Order ID</th>\n                <td data-label="Order ID">${t._id}</td>\n            </tr>\n            <tr>\n                <th>Cancellation Date</th>\n                <td data-label="Cancellation Date">${(new Date).toLocaleDateString()}</td>\n            </tr>\n        </table>\n\n        <p>If you have already paid for the order, the amount will be refunded to your account as soon as possible.</p>\n        \n        <h3>Need help?</h3>\n        <p>If you have any questions or need further assistance, please contact our customer support team at <a href="mailto:support@ecommerceapp.com" style="color: #E74C3C; text-decoration: none; border-bottom: 1px solid #E74C3C;">support@ecommerceapp.com</a></p>\n\n        <p>Best regards,<br><strong>E-commerce Application Team</strong></p>\n\n        <div class="footer">\n            <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n        </div>\n    </div>\n</body>\n</html>\n      </html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Cancellation confirmation email sent")}))}},128:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your Order has been Delivered",html:`\n      <!DOCTYPE html>\n      <html lang="en">\n   <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Order Delivered</title>\n    <style>\n        body {\n            font-family: 'Helvetica Neue', Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 600px;\n            margin: 0 auto;\n            padding: 20px;\n            background-color: #f0f8f0;\n        }\n        .container {\n            background-color: #ffffff;\n            padding: 40px;\n            border-radius: 8px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n        }\n        .header {\n            color: #4CAF50;\n            font-size: 28px;\n            margin-bottom: 20px;\n        }\n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-bottom: 20px;\n        }\n        th, td {\n            padding: 10px;\n            border: 1px solid #ddd;\n            text-align: left;\n        }\n        th {\n            background-color: #e8f5e9;\n            color: #4CAF50;\n        }\n        .footer {\n            border-top: 1px solid #e0e0e0;\n            padding-top: 20px;\n            margin-top: 40px;\n            text-align: center;\n            font-size: 14px;\n            color: #777;\n        }\n        @media only screen and (max-width: 600px) {\n            table, tr, td {\n                display: block;\n            }\n            tr {\n                margin-bottom: 10px;\n            }\n            td {\n                border: none;\n                position: relative;\n                padding-left: 50%;\n            }\n            td:before {\n                content: attr(data-label);\n                position: absolute;\n                left: 6px;\n                width: 45%;\n                padding-right: 10px;\n                white-space: nowrap;\n                font-weight: bold;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class="container">\n        <h2 class="header">Hello ${e.name},</h2>\n        <p>We are pleased to inform you that your order has been successfully delivered.</p>\n        \n        <h3>Order Details</h3>\n        <table>\n            <tr>\n                <th>Order ID</th>\n                <td data-label="Order ID">${t._id}</td>\n            </tr>\n            <tr>\n                <th>Order Status</th>\n                <td data-label="Order Status">${t.orderStatus}</td>\n            </tr>\n            <tr>\n                <th>Payment Method</th>\n                <td data-label="Payment Method">${t.paymentMethod}</td>\n            </tr>\n            <tr>\n                <th>Payment Status</th>\n                <td data-label="Payment Status">${t.paymentStatus}</td>\n            </tr>\n            <tr>\n                <th>Shipping Address</th>\n                <td data-label="Shipping Address">${t.shippingAddress}</td>\n            </tr>\n            <tr>\n                <th>Phone Number</th>\n                <td data-label="Phone Number">${t.phoneNumber}</td>\n            </tr>\n        </table>\n\n        <h3>Order Summary</h3>\n        <table>\n            <thead>\n                <tr>\n                    <th>Item</th>\n                    <th>Quantity</th>\n                    <th>Price</th>\n                </tr>\n            </thead>\n            <tbody>\n                ${t.items.map((e=>`\n                <tr>\n                    <td data-label="Item">${e.product.name}</td>\n                    <td data-label="Quantity">${e.quantity}</td>\n                    <td data-label="Price">$${e.priceAfterDiscount.toFixed(2)}</td>\n                </tr>\n                `)).join("")}\n            </tbody>\n        </table>\n\n        <h3>Financial Summary</h3>\n        <table>\n            <tr>\n                <th>Description</th>\n                <th>Amount</th>\n            </tr>\n            <tr>\n                <td data-label="Description">Subtotal</td>\n                <td data-label="Amount">$${t.totalPrice.toFixed(2)}</td>\n            </tr>\n            <tr>\n                <td data-label="Description">Shipping Cost</td>\n                <td data-label="Amount">$${t.shippingCost.toFixed(2)}</td>\n            </tr>\n            <tr>\n                <td data-label="Description">Tax Amount</td>\n                <td data-label="Amount">$${t.taxAmount.toFixed(2)}</td>\n            </tr>\n            <tr>\n                <td data-label="Description">Total Discount</td>\n                <td data-label="Amount">-$${t.totalDiscount.toFixed(2)}</td>\n            </tr>\n            <tr>\n                <th>Total</th>\n                <td data-label="Total">$${(t.totalPrice-t.taxAmount).toFixed(2)}</td>\n            </tr>\n        </table>\n\n        <p>We hope you enjoy your purchase! If you have any questions or need further assistance, please contact our customer support team at <a href="mailto:support@ecommerceapp.com" style="color: #4CAF50; text-decoration: none; border-bottom: 1px solid #4CAF50;">support@ecommerceapp.com</a></p>\n\n        <p>Best regards,<br><strong>E-commerce Application Team</strong></p>\n\n        <div class="footer">\n            <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n        </div>\n    </div>\n</body>\n</html>\n      </html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Delivery confirmation email sent")}))}},3537:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your Refund Request has been Rejected!",html:`\n <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Refund Request Update</title>\n</head>\n<body style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;">\n    <div style="background-color: #f4f4f4; padding: 20px; border-radius: 5px;">\n        <h1 style="color: #e74c3c; text-align: center;">Refund Request Update</h1>\n        \n        <p style="font-size: 16px;">Dear ${e.name},</p>\n        \n        <p style="font-size: 16px;">We regret to inform you that your refund request for order #${t.order} has been rejected.</p>\n        \n        <div style="background-color: #ffffff; border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin-top: 20px;">\n            <h2 style="color: #333; border-bottom: 1px solid #ddd; padding-bottom: 10px;">Refund Request Details</h2>\n            <table style="width: 100%; border-collapse: collapse;">\n                <tr>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Request ID:</strong></td>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">${t._id}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Order ID:</strong></td>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">${t.order}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Requested Amount:</strong></td>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">$${t.refundAmount}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Refund Type:</strong></td>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">${t.refundType}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Request Status:</strong></td>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd; color: #e74c3c;"><strong>${t.refundStatus}</strong></td>\n                </tr>\n                <tr>\n                    <td style="padding: 8px;"><strong>Processed On:</strong></td>\n                    <td style="padding: 8px;">${new Date(t.refundProcessedAt).toLocaleDateString()}</td>\n                </tr>\n            </table>\n        </div>\n        \n        <div style="background-color: #fdf2f2; border: 1px solid #e74c3c; border-radius: 5px; padding: 15px; margin-top: 20px;">\n            <h3 style="color: #e74c3c; margin-top: 0;">Reason for Rejection</h3>\n            <p style="margin-bottom: 0;">${t.rejectReason}</p>\n        </div>\n        \n        <p style="font-size: 16px; margin-top: 20px;">If you believe this decision was made in error or if you need further clarification, please don't hesitate to contact our customer support team. We're here to assist you and address any concerns you may have.</p>\n        \n        <p style="font-size: 16px;">Thank you for your understanding and continued patronage.</p>\n\n        <div style="text-align: center; margin-top: 30px; font-size: 14px; color: #666; border-top: 1px solid #ddd; padding-top: 20px;">\n            <p>\n                Best regards,<br>\n                <strong>E-commerce Application Team</strong>\n            </p>\n            <p>&copy; ${(new Date).getFullYear()} Your E-commerce Company. All rights reserved.</p>\n        </div>\n    </div>\n</body>\n</html>\n      `};n.sendMail(o,((t,n)=>{t?console.log(t.message):console.log(`Refund request reject email sent to${e.email}`)}))}},6818:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your Refund Request has been Approved!",html:`\n    <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Refund Approval Notification</title>\n</head>\n<body style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;">\n    <div style="background-color: #f4f4f4; padding: 20px; border-radius: 5px;">\n        <h1 style="color: #4CAF50; text-align: center;">Great news, ${e.name}!</h1>\n        \n        <p style="font-size: 16px;">Your refund request for order #${t.order} has been approved.</p>\n        \n        <p style="font-size: 18px; font-weight: bold; text-align: center;">\n            The amount of <span style="color: #4CAF50;">$${t.refundAmount}</span> has been credited to your gift card balance.\n        </p>\n        \n        <p style="font-size: 16px;">You can use this gift card amount towards your future purchases on our platform.</p>\n        \n        <div style="background-color: #ffffff; border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin-top: 20px;">\n            <h2 style="color: #333; border-bottom: 1px solid #ddd; padding-bottom: 10px;">Refund Summary</h2>\n            <table style="width: 100%; border-collapse: collapse;">\n                <tr>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Request ID:</strong></td>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">${t._id}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Order ID:</strong></td>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">${t.order}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Refund Amount:</strong></td>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">$${t.refundAmount}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Refund Method:</strong></td>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">${t.refundMethod}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Refund Type:</strong></td>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">${t.refundType}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Refund Status:</strong></td>\n                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">${t.refundStatus}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 8px;"><strong>Processed On:</strong></td>\n                    <td style="padding: 8px;">${new Date(t.refundProcessedAt).toLocaleDateString()}</td>\n                </tr>\n            </table>\n        </div>\n        \n        <p style="font-size: 16px; margin-top: 20px;">We hope you'll enjoy using your gift card balance!</p>\n        \n        <p style="font-size: 16px;">If you have any questions or need further assistance, please do not hesitate to contact our customer support team.</p>\n\n        <div style="text-align: center; margin-top: 30px; font-size: 14px; color: #666; border-top: 1px solid #ddd; padding-top: 20px;">\n            <p>\n                Best regards,<br>\n                <strong>E-commerce Application Team</strong>\n            </p>\n            <p>&copy; ${(new Date).getFullYear()} Your E-commerce Company. All rights reserved.</p>\n        </div>\n    </div>\n</body>\n</html>\n      `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Refund request success email sent")}))}},5720:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6634));t.default=e=>o(void 0,void 0,void 0,(function*(){const t=(0,i.default)(),n={from:"E-commerce Application <noreply@your-ecommerce-platform.com>",to:"mohamedramadan11b@gmail.com",subject:`Admin Alert: Product Out of Stock - ${e.name}`,html:`\n    <!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>Admin Notification: Product Out of Stock</title>\n  <style>\n    body {\n      font-family: 'Arial', sans-serif;\n      color: #333333;\n      line-height: 1.6;\n      background-color: #f4f4f4;\n      margin: 0;\n      padding: 0;\n    }\n    .container {\n      max-width: 600px;\n      margin: 20px auto;\n      background-color: #ffffff;\n      border-radius: 8px;\n      overflow: hidden;\n      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);\n    }\n    .header {\n      background-color: #f8f8f8;\n      border-bottom: 2px solid #e74c3c;\n      padding: 20px;\n      text-align: center;\n    }\n    .header h1 {\n      color: #e74c3c;\n      margin: 0;\n      font-size: 24px;\n    }\n    .content {\n      padding: 30px;\n    }\n    h2 {\n      color: #e74c3c;\n      margin-bottom: 20px;\n      font-size: 22px;\n      border-bottom: 1px solid #e0e0e0;\n      padding-bottom: 10px;\n    }\n    .product-info {\n      margin-bottom: 20px;\n      width: 100%;\n      border-collapse: separate;\n      border-spacing: 0;\n      border: 1px solid #e0e0e0;\n      border-radius: 5px;\n      overflow: hidden;\n    }\n    .product-info th {\n      text-align: left;\n      padding: 12px;\n      background-color: #f8f8f8;\n      border-bottom: 1px solid #e0e0e0;\n      color: #e74c3c;\n    }\n    .product-info td {\n      padding: 12px;\n      border-bottom: 1px solid #e0e0e0;\n    }\n    .product-info tr:last-child td {\n      border-bottom: none;\n    }\n    a {\n      color: #e74c3c;\n      text-decoration: none;\n    }\n    a:hover {\n      text-decoration: underline;\n    }\n    .cta {\n      text-align: center;\n      margin: 30px 0;\n    }\n    .cta-button {\n      display: inline-block;\n      padding: 12px 24px;\n      color: #ffffff;\n      background-color: #e74c3c;\n      border-radius: 5px;\n      text-decoration: none;\n      font-size: 16px;\n      font-weight: bold;\n      transition: background-color 0.3s ease;\n    }\n    .cta-button:hover {\n      background-color: #c0392b;\n      text-decoration: none;\n    }\n    .footer {\n      background-color: #f8f8f8;\n      border-top: 2px solid #e74c3c;\n      color: #666666;\n      text-align: center;\n      padding: 20px;\n      font-size: 14px;\n    }\n    .footer a {\n      color: #e74c3c;\n    }\n  </style>\n</head>\n<body>\n  <div class="container">\n    <div class="header">\n      <h1>E-commerce Platform Admin Alert</h1>\n    </div>\n    <div class="content">\n      <h2>Product Out of Stock Notification</h2>\n      <p>Dear Admin,</p>\n      <p>This is an automated notification to inform you that a product in our inventory is now out of stock. Please find the details below:</p>\n\n      \x3c!-- Product Information --\x3e\n      <table class="product-info">\n        <tr>\n          <th>Product Name:</th>\n          <td><a href="" target="_blank">${e.name}</a></td>\n        </tr>\n        <tr>\n          <th>Product ID:</th>\n          <td>${e._id}</td>\n        </tr>\n        <tr>\n          <th>Category:</th>\n          <td>${e.category}</td>\n        </tr>\n        <tr>\n          <th>Brand:</th>\n          <td>${e.brand}</td>\n        </tr>\n        <tr>\n          <th>Price:</th>\n          <td>$${e.price.toFixed(2)}</td>\n        </tr>\n        <tr>\n          <th>Availability Status:</th>\n          <td>Out of Stock</td>\n        </tr>\n        <tr>\n          <th>Source Type:</th>\n          <td>${e.sourceType}</td>\n        </tr>\n        <tr>\n          <th>Last Known Stock:</th>\n          <td>${e.stock_quantity}</td>\n        </tr>\n      </table>\n\n      <p>Please take the necessary actions to restock this item or update its availability status in our system. If this product is no longer available or needs to be removed from the platform, please update the product listing accordingly.</p>\n\n      <div class="cta">\n        <a href="" target="_blank" class="cta-button">Manage Product</a>\n      </div>\n\n      <p>If you need any additional information or assistance, please don't hesitate to contact the IT department.</p>\n\n      <p>Best regards,</p>\n      <p>E-commerce Platform System</p>\n    </div>\n    <div class="footer">\n      <p>&copy; 2024 <a href="https://www.your-ecommerce-platform.com" target="_blank">E-commerce Platform</a>. All rights reserved.</p>\n      <p>Admin Portal: <a href="" target="_blank">Access Admin Dashboard</a></p>\n    </div>\n  </div>\n</body>\n</html>\n    `};try{yield t.sendMail(n),console.log("Admin notification for out of stock product sent successfully")}catch(e){console.error("Error sending admin notification email:",e)}}))},9703:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6634));t.default=e=>o(void 0,void 0,void 0,(function*(){const t=(0,i.default)(),n=e.items.map((e=>`\n    <tr>\n      <td style="padding: 12px; border-bottom: 1px solid #ddd; font-size: 16px;">${e.product.name}</td>\n      <td style="padding: 12px; border-bottom: 1px solid #ddd; text-align: center; font-size: 16px;">${e.quantity}</td>\n      <td style="padding: 12px; border-bottom: 1px solid #ddd; text-align: right; font-size: 16px;">$${e.price.toFixed(2)}</td>\n      <td style="padding: 12px; border-bottom: 1px solid #ddd; text-align: right; font-size: 16px;">$${e.discount.toFixed(2)}</td>\n      <td style="padding: 12px; border-bottom: 1px solid #ddd; text-align: right; font-size: 16px;">$${e.priceAfterDiscount.toFixed(2)}</td>\n    </tr>\n  `)).join(""),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:"mohamedramadan11b@gmail.com",subject:"New Website Order Received",html:`\n      <!DOCTYPE html>\n      <html lang="en">\n      <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <title>New Website Order Received</title>\n      </head>\n      <body style="font-family: Arial, sans-serif; color: #333; line-height: 1.6; background-color: #f7f7f7; margin: 0; padding: 20px; font-size: 16px;">\n        <div style="max-width: 600px; margin: 0 auto; background-color: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);">\n          <h2 style="color: #4CAF50; text-align: center; margin-bottom: 20px; font-size: 24px;">New Website Order Received</h2>\n          <p>Hello Website Admin,</p>\n          <p>A new order has been placed on the website. Here are the details:</p>\n          \n          \x3c!-- Order Summary --\x3e\n          <h3 style="color: #333; margin-top: 30px; font-size: 20px;">Order Details</h3>\n          <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">\n            <tbody>\n              <tr style="background-color: #f2f2f2;">\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 16px;">Order ID:</td>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-size: 16px;">${e._id}</td>\n              </tr>\n              <tr>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 16px;">Order Date:</td>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-size: 16px;">${e.createdAt.toLocaleString()}</td>\n              </tr>\n              <tr style="background-color: #f2f2f2;">\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 16px;">Total Items:</td>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-size: 16px;">${e.itemsQuantity}</td>\n              </tr>\n              <tr>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 16px;">Subtotal Price:</td>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-size: 16px;">$${e.subtotalPrice.toFixed(2)}</td>\n              </tr>\n              <tr style="background-color: #f2f2f2;">\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 16px;">Total Discount:</td>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-size: 16px;">$${e.totalDiscount.toFixed(2)}</td>\n              </tr>\n              <tr>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 16px;">Net Price:</td>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-size: 16px;">$${e.netPrice.toFixed(2)}</td>\n              </tr>\n              <tr style="background-color: #f2f2f2;">\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 16px;">Shipping Address:</td>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-size: 16px;">${e.shippingAddress}</td>\n              </tr>\n              <tr>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 16px;">Payment Status:</td>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-size: 16px;">${e.paymentStatus}</td>\n              </tr>\n              <tr style="background-color: #f2f2f2;">\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 16px;">Payment Method:</td>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-size: 16px;">${e.paymentMethod}</td>\n              </tr>\n              <tr>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 16px;">Shipping Status:</td>\n                <td style="padding: 12px; border-bottom: 1px solid #ddd; font-size: 16px;">${e.shippingStatus}</td>\n              </tr>\n            </tbody>\n          </table>\n\n          \x3c!-- Order Items --\x3e\n          <h3 style="color: #333; margin-top: 30px; font-size: 20px;">Order Items</h3>\n          <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">\n            <thead>\n              <tr style="background-color: #f2f2f2;">\n                <th style="padding: 12px; text-align: left; border-bottom: 2px solid #ddd; font-size: 16px;">Product</th>\n                <th style="padding: 12px; text-align: center; border-bottom: 2px solid #ddd; font-size: 16px;">Quantity</th>\n                <th style="padding: 12px; text-align: right; border-bottom: 2px solid #ddd; font-size: 16px;">Price</th>\n                <th style="padding: 12px; text-align: right; border-bottom: 2px solid #ddd; font-size: 16px;">Discount</th>\n                <th style="padding: 12px; text-align: right; border-bottom: 2px solid #ddd; font-size: 16px;">Price After Discount</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${n}\n            </tbody>\n          </table>\n\n          <p style="margin-top: 20px;">Thank you for your attention.</p>\n          <p>Best regards,</p>\n          <p>E-commerce Application Team</p>\n        </div>\n      </body>\n      </html>\n    `};try{yield t.sendMail(o),console.log("Email sent successfully")}catch(e){console.error("Error sending email:",e)}}))},839:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{var n;const o=(0,r.default)(),i=t.items.map((e=>`\n    <tr>\n      <td style="padding: 12px; border-bottom: 1px solid #e0e0e0;">${e.product.name}</td>\n      <td style="padding: 12px; border-bottom: 1px solid #e0e0e0; text-align: center;">${e.quantity}</td>\n      <td style="padding: 12px; border-bottom: 1px solid #e0e0e0; text-align: right;">$${e.priceAfterDiscount.toFixed(2)}</td>\n    </tr>\n  `)).join(""),d={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your Order has been Shipped",html:`\n      <div style="font-family: Arial, sans-serif; color: #333; line-height: 1.6; max-width: 600px; margin: 0 auto;">\n        <h2 style="color: #4CAF50; text-align: center;">Hello ${e.name},</h2>\n        <p style="font-size: 16px;">We are excited to inform you that your order with ID <strong>${t._id}</strong> has been successfully shipped.</p>\n\n        \x3c!-- Order Summary Table --\x3e\n        <div style="background-color: #f8f8f8; padding: 15px; border-radius: 8px; margin-top: 20px;">\n          <h3 style="color: #2C3E50; margin-bottom: 10px;">Order Summary</h3>\n          <table style="width: 100%; border-collapse: collapse;">\n            <thead>\n              <tr style="background-color: #f0f0f0; border-bottom: 2px solid #ccc;">\n                <th style="padding: 12px; text-align: left;">Product</th>\n                <th style="padding: 12px; text-align: center;">Quantity</th>\n                <th style="padding: 12px; text-align: right;">Price</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${i}\n            </tbody>\n          </table>\n          <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">\n            <tr>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0;"><strong>Total Items:</strong></td>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0; text-align: right;">${t.itemsQuantity}</td>\n            </tr>\n            <tr>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0;"><strong>Total Price:</strong></td>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0; text-align: right;">$${t.totalPrice.toFixed(2)}</td>\n            </tr>\n            <tr>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0;"><strong>Shipping Cost:</strong></td>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0; text-align: right;">$${t.shippingCost.toFixed(2)}</td>\n            </tr>\n            <tr>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0;"><strong>Discount Applied:</strong></td>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0; text-align: right;">-$${t.totalDiscount.toFixed(2)}</td>\n            </tr>\n            <tr>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0;"><strong>Estimated Delivery Date:</strong></td>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0; text-align: right;">${(null===(n=t.estimatedDeliveryDate)||void 0===n?void 0:n.toLocaleDateString())||"N/A"}</td>\n            </tr>\n          </table>\n        </div>\n\n        \x3c!-- Shipping Details Table --\x3e\n        <div style="background-color: #f8f8f8; padding: 15px; border-radius: 8px; margin-top: 20px;">\n          <h3 style="color: #2C3E50; margin-bottom: 10px;">Shipping Details</h3>\n          <table style="width: 100%; border-collapse: collapse;">\n            <tr>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0;"><strong>Shipping Address:</strong></td>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0; text-align: right;">${t.shippingAddress}</td>\n            </tr>\n            <tr>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0;"><strong>Phone Number:</strong></td>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0; text-align: right;">${t.phoneNumber}</td>\n            </tr>\n            <tr>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0;"><strong>Payment Method:</strong></td>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0; text-align: right;">${t.paymentMethod}</td>\n            </tr>\n            <tr>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0;"><strong>Payment Status:</strong></td>\n              <td style="padding: 10px; border-top: 1px solid #e0e0e0; text-align: right;">${t.paymentStatus}</td>\n            </tr>\n          </table>\n        </div>\n\n        <p style="font-size: 16px; margin-top: 20px;">If you have any questions or need further assistance, please do not hesitate to contact our customer support team.</p>\n        <p style="font-size: 16px; margin-top: 20px;">Best regards,<br><span style="font-weight: bold;">E-commerce Application Team</span></p>\n      </div>\n    `};o.sendMail(d,((e,t)=>{e?console.log(e.message):console.log("Shipping confirmation email sent")}))}},8085:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Support Ticket Received",html:`\n    <div style="font-family: Arial, sans-serif; color: #333; line-height: 1.6; max-width: 600px; margin: auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;">\n  \x3c!-- Header --\x3e\n  <h1 style="color: #2C3E50; text-align: center; font-size: 24px; margin-bottom: 20px;">Support Ticket Confirmation</h1>\n\n  \x3c!-- Greeting --\x3e\n  <p style="font-size: 18px; margin-bottom: 20px;">Hello ${e.name},</p>\n\n  \x3c!-- Main Content --\x3e\n  <p style="margin-bottom: 20px;">Thank you for reaching out to our support team. Weâ€™ve received your support ticket and are here to assist you. Below are the details of your request:</p>\n\n  <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">\n    <tr style="background-color: #f8f8f8;">\n      <td style="padding: 10px; border: 1px solid #ddd;"><strong>Ticket ID:</strong></td>\n      <td style="padding: 10px; border: 1px solid #ddd;">${t._id}</td>\n    </tr>\n    <tr>\n      <td style="padding: 10px; border: 1px solid #ddd;"><strong>Subject:</strong></td>\n      <td style="padding: 10px; border: 1px solid #ddd;">${t.subject}</td>\n    </tr>\n    <tr style="background-color: #f8f8f8;">\n      <td style="padding: 10px; border: 1px solid #ddd;"><strong>Description:</strong></td>\n      <td style="padding: 10px; border: 1px solid #ddd;">${t.description}</td>\n    </tr>\n    <tr>\n      <td style="padding: 10px; border: 1px solid #ddd;"><strong>Status:</strong></td>\n      <td style="padding: 10px; border: 1px solid #ddd;">${t.status}</td>\n    </tr>\n    <tr style="background-color: #f8f8f8;">\n      <td style="padding: 10px; border: 1px solid #ddd;"><strong>Category:</strong></td>\n      <td style="padding: 10px; border: 1px solid #ddd;">${t.category}</td>\n    </tr>\n  </table>\n\n  <p style="margin-bottom: 20px;">Our support team is currently reviewing your ticket and will get back to you as soon as possible. We appreciate your patience and will work to resolve your issue promptly.</p>\n\n  <p style="margin-bottom: 20px;">In the meantime, if you need to provide additional information or have further questions, you can reply directly to this email, and weâ€™ll update your ticket accordingly.</p>\n\n  \x3c!-- Button --\x3e\n  <div style="text-align: center; margin: 30px 0;">\n    <a href="https://your-website.com/tickets/${t._id}" style="background-color: #3498DB; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; font-size: 16px;">View Your Ticket</a>\n  </div>\n\n  \x3c!-- Closing --\x3e\n  <p style="border-top: 1px solid #ddd; padding-top: 20px; text-align: center; margin-top: 30px; font-size: 14px;">\n    Best regards,<br><strong>The E-commerce Application Team</strong>\n  </p>\n\n  <p style="text-align: center; font-size: 12px; color: #777;">Â© 2024 E-commerce Application. All rights reserved.</p>\n</div>\n\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Support ticket confirmation email sent")}))}},2833:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:t.shopEmail,subject:`Shop Analytics Report - ${t.month} ${t.year}`,html:`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Shop Analytics Report</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            margin: 0;\n            padding: 0;\n        }\n        .container {\n            max-width: 800px;\n            margin: 20px auto;\n            background: #fff;\n            border-radius: 8px;\n            overflow: hidden;\n            box-shadow: 0 0 10px rgba(0,0,0,0.1);\n        }\n        .header {\n            background-color: #4a90e2;\n            color: #ffffff;\n            padding: 20px;\n            text-align: center;\n        }\n        .header h1 {\n            margin: 0;\n            font-size: 24px;\n        }\n        .content {\n            padding: 20px;\n        }\n        .section {\n            margin-bottom: 20px;\n        }\n        .section h2 {\n            color: #4a90e2;\n            font-size: 20px;\n            border-bottom: 2px solid #4a90e2;\n            padding-bottom: 5px;\n        }\n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-top: 10px;\n        }\n        th, td {\n            border: 1px solid #ddd;\n            padding: 8px;\n            text-align: left;\n        }\n        th {\n            background-color: #f2f2f2;\n            font-weight: bold;\n        }\n        .highlight {\n            background-color: #e6f3ff;\n        }\n        .footer {\n            background-color: #f8f8f8;\n            padding: 10px 20px;\n            text-align: center;\n            font-size: 12px;\n            color: #666;\n        }\n    </style>\n</head>\n<body>\n    <div class="container">\n        <div class="header">\n            <h1>Shop Analytics Report</h1>\n        </div>\n        <div class="content">\n            <div class="section">\n                <h2>Shop Information</h2>\n                <table>\n                    <tr>\n                        <th>Shop Name</th>\n                        <td>${t.shopName}</td>\n                    </tr>\n                    <tr>\n                        <th>Report Period</th>\n                        <td>${t.month} ${t.year}</td>\n                    </tr>\n                </table>\n            </div>\n            <div class="section">\n                <h2>Financial Overview</h2>\n                <table>\n                    <tr>\n                        <th>Metric</th>\n                        <th>Amount</th>\n                    </tr>\n                    <tr>\n                        <td>Total Revenue</td>\n                        <td>$${t.financialInformation.totalRevenue.toFixed(2)}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Refund</td>\n                        <td>$${t.financialInformation.totalRefund.toFixed(2)}</td>\n                    </tr>\n                    <tr>\n                        <td>Average Order Value</td>\n                        <td>$${t.financialInformation.averageOrderValue.toFixed(2)}</td>\n                    </tr>\n                    <tr class="highlight">\n                        <td><strong>Total Profit</strong></td>\n                        <td><strong>$${t.financialInformation.totalProfit.toFixed(2)}</strong></td>\n                    </tr>\n                </table>\n            </div>\n            <div class="section">\n                <h2>Order Statistics</h2>\n                <table>\n                    <tr>\n                        <th>Status</th>\n                        <th>Count</th>\n                    </tr>\n                    <tr>\n                        <td>Total Orders</td>\n                        <td>${t.orders.totalOrders}</td>\n                    </tr>\n                    <tr>\n                        <td>Shipped Orders</td>\n                        <td>${t.orders.totalShippedOrders}</td>\n                    </tr>\n                    <tr>\n                        <td>Delivered Orders</td>\n                        <td>${t.orders.totalDeliveredOrders}</td>\n                    </tr>\n                    <tr>\n                        <td>Cancelled Orders</td>\n                        <td>${t.orders.totalCancelledOrders}</td>\n                    </tr>\n                    <tr>\n                        <td>Pending Orders</td>\n                        <td>${t.orders.totalPendingOrders}</td>\n                    </tr>\n                </table>\n            </div>\n            <div class="section">\n                <h2>Return and Refund Information</h2>\n                <table>\n                    <tr>\n                        <th>Metric</th>\n                        <th>Count</th>\n                    </tr>\n                    <tr>\n                        <td>Total Return Items</td>\n                        <td>${t.returnInformation.totalReturnItems}</td>\n                    </tr>\n                    <tr>\n                        <td>Accepted Return Items</td>\n                        <td>${t.returnInformation.totalAcceptedReturnItems}</td>\n                    </tr>\n                    <tr>\n                        <td>Rejected Return Items</td>\n                        <td>${t.returnInformation.totalRejectedReturnItems}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Refund Requests</td>\n                        <td>${t.refundInformation.totalRefundRequests}</td>\n                    </tr>\n                    <tr>\n                        <td>Accepted Refund Requests</td>\n                        <td>${t.refundInformation.totalAcceptedRefundRequests}</td>\n                    </tr>\n                    <tr>\n                        <td>Rejected Refund Requests</td>\n                        <td>${t.refundInformation.totalRejectedRefundRequests}</td>\n                    </tr>\n                </table>\n            </div>\n            <div class="section">\n                <h2>Product Information</h2>\n                <table>\n                    <tr>\n                        <th>Metric</th>\n                        <th>Count</th>\n                    </tr>\n                    <tr>\n                        <td>Total Products</td>\n                        <td>${t.productInformation.totalProducts}</td>\n                    </tr>\n                    <tr>\n                        <td>Active Products</td>\n                        <td>${t.productInformation.totalActiveProducts}</td>\n                    </tr>\n                    <tr>\n                        <td>Inactive Products</td>\n                        <td>${t.productInformation.totalInactiveProducts}</td>\n                    </tr>\n                    <tr>\n                        <td>Out of Stock Products</td>\n                        <td>${t.productInformation.totalOutOfStockProducts}</td>\n                    </tr>\n                    <tr>\n                        <td>In Stock Products</td>\n                        <td>${t.productInformation.totalInStockProducts}</td>\n                    </tr>\n                    <tr>\n                        <td>Freezed Products</td>\n                        <td>${t.productInformation.totalFreezedProducts}</td>\n                    </tr>\n                    <tr>\n                        <td>Unfreezed Products</td>\n                        <td>${t.productInformation.totalUnFreezedProducts}</td>\n                    </tr>\n                    <tr>\n                        <td>New Products</td>\n                        <td>${t.productInformation.newProducts}</td>\n                    </tr>\n                </table>\n            </div>\n        </div>\n        <div class="footer">\n            <p>This is an automated report for ${t.shopName}.</p>\n        </div>\n    </div>\n</body>\n</html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Shop analytics report email sent successfully.")}))}},9532:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:t,subject:`Website Analytics Report - ${e.month} ${e.year}`,html:`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Website Analytics Report</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            margin: 0;\n            padding: 0;\n        }\n        .container {\n            max-width: 800px;\n            margin: 20px auto;\n            background: #fff;\n            border-radius: 8px;\n            overflow: hidden;\n            box-shadow: 0 0 10px rgba(0,0,0,0.1);\n        }\n        .header {\n            background-color: #4a90e2;\n            color: #ffffff;\n            padding: 20px;\n            text-align: center;\n        }\n        .header h1 {\n            margin: 0;\n            font-size: 24px;\n        }\n        .content {\n            padding: 20px;\n        }\n        .section {\n            margin-bottom: 20px;\n        }\n        .section h2 {\n            color: #4a90e2;\n            font-size: 20px;\n            border-bottom: 2px solid #4a90e2;\n            padding-bottom: 5px;\n        }\n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-top: 10px;\n        }\n        th, td {\n            border: 1px solid #ddd;\n            padding: 8px;\n            text-align: left;\n        }\n        th {\n            background-color: #f2f2f2;\n            font-weight: bold;\n        }\n        .highlight {\n            background-color: #e6f3ff;\n        }\n        .footer {\n            background-color: #f8f8f8;\n            padding: 10px 20px;\n            text-align: center;\n            font-size: 12px;\n            color: #666;\n        }\n    </style>\n</head>\n<body>\n    <div class="container">\n        <div class="header">\n            <h1>Website Analytics Report</h1>\n        </div>\n        <div class="content">\n            <div class="section">\n                <h2>Report Information</h2>\n                <table>\n                    <tr>\n                        <th>Report Period</th>\n                        <td>${e.month} ${e.year}</td>\n                    </tr>\n                </table>\n            </div>\n            \n            <div class="section">\n                <h2>Financial Summary (Last 30 Days)</h2>\n                <table>\n                    <tr>\n                        <th>Metric</th>\n                        <th>Amount</th>\n                    </tr>\n                    <tr>\n                        <td>Total Sales</td>\n                        <td>$${e.financialSummary.totalSales.toFixed(2)}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Shop Sales</td>\n                        <td>$${e.financialSummary.totalShopSales.toFixed(2)}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Website Sales</td>\n                        <td>$${e.financialSummary.totalWebsiteSales.toFixed(2)}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Processed Refunds</td>\n                        <td>$${e.financialSummary.totalProcessedRefunds.toFixed(2)}</td>\n                    </tr>\n                    <tr class="highlight">\n                        <td><strong>Total Website Profit</strong></td>\n                        <td><strong>$${e.financialSummary.totalWebsiteProfit.toFixed(2)}</strong></td>\n                    </tr>\n                    <tr>\n                        <td>Average Order Value</td>\n                        <td>$${e.financialSummary.averageOrderValue.toFixed(2)}</td>\n                    </tr>\n                </table>\n            </div>\n\n            <div class="section">\n                <h2>Shop Analytics</h2>\n                <table>\n                    <tr>\n                        <th>Metric</th>\n                        <th>Count</th>\n                    </tr>\n                    <tr>\n                        <td>Total Shops</td>\n                        <td>${e.shopAnalytics.totalShops}</td>\n                    </tr>\n                    <tr>\n                        <td>Active Shops</td>\n                        <td>${e.shopAnalytics.activeShops}</td>\n                    </tr>\n                    <tr>\n                        <td>Inactive Shops</td>\n                        <td>${e.shopAnalytics.inactiveShops}</td>\n                    </tr>\n                    <tr>\n                        <td>Shops with Products</td>\n                        <td>${e.shopAnalytics.shopsWithProducts}</td>\n                    </tr>\n                    <tr>\n                        <td>New Joining Shops</td>\n                        <td>${e.shopAnalytics.newJoiningShops}</td>\n                    </tr>\n                    <tr>\n                        <td>Shops with Orders</td>\n                        <td>${e.shopAnalytics.shopsWithOrders}</td>\n                    </tr>\n                    <tr>\n                        <td>Shops Support Tickets</td>\n                        <td>${e.shopAnalytics.shopsSupportTickets}</td>\n                    </tr>\n                    <tr>\n                        <td>New Shop Requests</td>\n                        <td>${e.shopAnalytics.newShopsRequests}</td>\n                    </tr>\n                    <tr>\n                        <td>New Delete Shop Requests</td>\n                        <td>${e.shopAnalytics.newDeleteShopsRequests}</td>\n                    </tr>\n                </table>\n            </div>\n\n            <div class="section">\n                <h2>Order Analytics</h2>\n                <table>\n                    <tr>\n                        <th>Metric</th>\n                        <th>Count</th>\n                    </tr>\n                    <tr>\n                        <td>Total Orders</td>\n                        <td>${e.orderAnalytics.totalOrders}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Shop Orders</td>\n                        <td>${e.orderAnalytics.totalShopOrders}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Website Orders</td>\n                        <td>${e.orderAnalytics.totalWebsiteOrders}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Pending Orders</td>\n                        <td>${e.orderAnalytics.totalPendingOrders}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Cancelled Orders</td>\n                        <td>${e.orderAnalytics.totalCancelledOrders}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Delivered Orders</td>\n                        <td>${e.orderAnalytics.totalDeliveredOrders}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Return Items</td>\n                        <td>${e.orderAnalytics.totalReturnItems}</td>\n                    </tr>\n                </table>\n            </div>\n\n            <div class="section">\n                <h2>Product Analytics</h2>\n                <table>\n                    <tr>\n                        <th>Metric</th>\n                        <th>Count</th>\n                    </tr>\n                    <tr>\n                        <td>Total Products</td>\n                        <td>${e.productAnalytics.totalProducts}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Shop Products</td>\n                        <td>${e.productAnalytics.totalShopProducts}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Website Products</td>\n                        <td>${e.productAnalytics.totalWebsiteProducts}</td>\n                    </tr>\n                    <tr>\n                        <td>New Products</td>\n                        <td>${e.productAnalytics.newProducts}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Out of Stock Products</td>\n                        <td>${e.productAnalytics.totalOutOfStockProducts}</td>\n                    </tr>\n                    <tr>\n                        <td>Total In Stock Products</td>\n                        <td>${e.productAnalytics.totalInStockProducts}</td>\n                    </tr>\n                </table>\n            </div>\n\n            <div class="section">\n                <h2>User Analytics</h2>\n                <table>\n                    <tr>\n                        <th>Metric</th>\n                        <th>Count</th>\n                    </tr>\n                    <tr>\n                        <td>Total Users</td>\n                        <td>${e.userAnalytics.totalUsers}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Shop Owners</td>\n                        <td>${e.userAnalytics.totalShopOwners}</td>\n                    </tr>\n                    <tr>\n                        <td>New Users</td>\n                        <td>${e.userAnalytics.newUsers}</td>\n                    </tr>\n                    <tr>\n                        <td>Users with Orders</td>\n                        <td>${e.userAnalytics.usersWithOrders}</td>\n                    </tr>\n                    <tr>\n                        <td>Users with No Orders</td>\n                        <td>${e.userAnalytics.usersWithNoOrders}</td>\n                    </tr>\n                </table>\n            </div>\n\n            <div class="section">\n                <h2>Refund Analytics</h2>\n                <table>\n                    <tr>\n                        <th>Metric</th>\n                        <th>Count</th>\n                    </tr>\n                    <tr>\n                        <td>Total Refund Requests</td>\n                        <td>${e.refundAnalytics.totalRefundRequests}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Processed Refund Requests</td>\n                        <td>${e.refundAnalytics.totalProcessedRefundRequests}</td>\n                    </tr>\n                    <tr>\n                        <td>New Refund Requests</td>\n                        <td>${e.refundAnalytics.newRefundRequests}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Refund Requests for Cancelled Orders</td>\n                        <td>${e.refundAnalytics.totalRefundRequestsForCancelledOrders}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Refund Requests for Return Items</td>\n                        <td>${e.refundAnalytics.totalRefundRequestsForReturnItems}</td>\n                    </tr>\n                    <tr>\n                        <td>Rejected Refund Requests</td>\n                        <td>${e.refundAnalytics.rejectedRefundRequests}</td>\n                    </tr>\n                </table>\n            </div>\n\n            <div class="section">\n                <h2>Return Items Analytics</h2>\n                <table>\n                    <tr>\n                        <th>Metric</th>\n                        <th>Count</th>\n                    </tr>\n                    <tr>\n                        <td>Total Return Items Requests</td>\n                        <td>${e.returnItemsAnalytics.totalReturnItemsRequests}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Processed Return Items Requests</td>\n                        <td>${e.returnItemsAnalytics.totalProcessedReturnItemsRequests}</td>\n                    </tr>\n                    <tr>\n                        <td>New Return Items Requests</td>\n                        <td>${e.returnItemsAnalytics.newReturnItemsRequests}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Rejected Return Items Requests</td>\n                        <td>${e.returnItemsAnalytics.totalRejectedReturnItemsRequests}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Cancelled Return Items Requests</td>\n                        <td>${e.returnItemsAnalytics.totalCancelledReturnItemsRequests}</td>\n                    </tr>\n                </table>\n            </div>\n\n            <div class="section">\n                <h2>Support Ticket Analytics</h2>\n                <table>\n                    <tr>\n                        <th>Metric</th>\n                        <th>Count</th>\n                    </tr>\n                    <tr>\n                        <td>Total Users Support Tickets</td>\n                        <td>${e.supportTicketAnalytics.totalUsersSupportTickets}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Processed Support Tickets</td>\n                        <td>${e.supportTicketAnalytics.totalProcessedSupportTickets}</td>\n                    </tr>\n                    <tr>\n                        <td>New User Support Tickets</td>\n                        <td>${e.supportTicketAnalytics.newUserSupportTickets}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Shop Support Tickets</td>\n                        <td>${e.supportTicketAnalytics.totalShopSupportTickets}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Processed Shop Support Tickets</td>\n                        <td>${e.supportTicketAnalytics.totalProcessedShopSupportTickets}</td>\n                    </tr>\n                    <tr>\n                        <td>New Shop Support Tickets</td>\n                        <td>${e.supportTicketAnalytics.newShopSupportTickets}</td>\n                    </tr>\n                </table>\n            </div>\n\n            <div class="section">\n                <h2>Prime Subscription Analytics</h2>\n                <table>\n                    <tr>\n                        <th>Metric</th>\n                        <th>Count</th>\n                    </tr>\n                    <tr>\n                        <td>Total Prime Subscriptions</td>\n                        <td>${e.primeSubscriptionAnalytics.totalPrimeSubscriptions}<tr>\n                        <td>New Prime Subscriptions</td>\n                        <td>${e.primeSubscriptionAnalytics.newPrimeSubscriptions}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Active Prime Subscriptions</td>\n                        <td>${e.primeSubscriptionAnalytics.totalActivePrimeSubscriptions}</td>\n                    </tr>\n                    <tr>\n                        <td>Total Inactive Prime Subscriptions</td>\n                        <td>${e.primeSubscriptionAnalytics.totalInactivePrimeSubscriptions}</td>\n                    </tr>\n                </table>\n            </div>\n        </div>\n        <div class="footer">\n            <p>This is an automated report generated on ${(new Date).toLocaleString()}. For any questions or concerns, please contact our support team.</p>\n        </div>\n    </div>\n</body>\n</html>\n    `};n.sendMail(o,((e,t)=>{e?console.log("Error sending website analytics report email:",e.message):console.log("Website analytics report email sent successfully.")}))}},2792:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{var n,o,i,d,s;const a=(0,r.default)(),u={from:"E-commerce Application <your-email@example.com>",to:e.email,subject:t.subject,html:`\n    <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>${t.subject}</title>\n    <style>\n        body {\n            font-family: 'Arial', 'Helvetica', sans-serif;\n            line-height: 1.6;\n            background-color: #f5f7fa;\n            color: #333;\n            margin: 0;\n            padding: 0;\n        }\n        .container {\n            background-color: #ffffff;\n            max-width: 600px;\n            margin: 20px auto;\n            padding: 0;\n            border-radius: 8px;\n            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);\n            overflow: hidden;\n        }\n        .header {\n            background-color: #3c4e62;\n            color: #ffffff;\n            padding: 25px;\n            text-align: center;\n            font-size: 24px;\n        }\n        .content {\n            padding: 30px;\n        }\n        .greeting {\n            font-size: 22px;\n            font-weight: bold;\n            color: #3c4e62;\n            margin-bottom: 20px;\n        }\n        .message-content {\n            background-color: #f0f4f8;\n            color: #333;\n            padding: 25px;\n            border-radius: 8px;\n            border-left: 4px solid #5b7a9d;\n            margin-bottom: 25px;\n        }\n        .details-box {\n            background-color: #e8eef3;\n            border: 1px solid #c0d0e0;\n            border-radius: 6px;\n            padding: 15px;\n            margin-top: 25px;\n            font-size: 0.9em;\n        }\n        .details-box h3 {\n            margin-top: 0;\n            color: #3c4e62;\n            font-size: 1.1em;\n        }\n        .footer {\n            background-color: #3c4e62;\n            padding: 20px;\n            text-align: center;\n            font-size: 14px;\n            color: #ecf0f1;\n        }\n        a {\n            color: #5b7a9d;\n            text-decoration: none;\n        }\n        .btn {\n            display: inline-block;\n            padding: 12px 24px;\n            background-color: #5b7a9d;\n            color: #ffffff;\n            border-radius: 6px;\n            text-decoration: none;\n            font-weight: bold;\n            margin-top: 25px;\n            transition: background-color 0.3s ease;\n        }\n        .btn:hover {\n            background-color: #4c6987;\n        }\n        @media only screen and (max-width: 600px) {\n            .container {\n                margin: 10px;\n                width: calc(100% - 20px);\n            }\n            .content {\n                padding: 20px;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class="container">\n        <div class="header">\n            E-commerce Application\n        </div>\n        <div class="content">\n            <div class="greeting">Hello, ${e.shopName}!</div>\n            \n            <div class="message-content">\n                <p>${t.content}</p>\n            </div>\n\n            <a href="#" class="btn">View Details</a>\n\n            <div class="details-box">\n                <h3>Message Details</h3>\n                <p><strong>Category:</strong> ${(null===(n=t.metaData)||void 0===n?void 0:n.category)||"N/A"}</p>\n                <p><strong>Priority:</strong> ${(null===(o=t.metaData)||void 0===o?void 0:o.priority)||"N/A"}</p>\n                <p><strong>Tags:</strong> ${(null===(d=null===(i=t.metaData)||void 0===i?void 0:i.tags)||void 0===d?void 0:d.join(", "))||"N/A"}</p>\n                <p><strong>Action Required:</strong> ${(null===(s=t.metaData)||void 0===s?void 0:s.actionRequired)?"Yes":"No"}</p>\n            </div>\n        </div>\n\n        <div class="footer">\n            <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n            <p>\n                <a href="#" style="color: #ecf0f1;">Unsubscribe</a> | \n                <a href="#" style="color: #ecf0f1;">Privacy Policy</a>\n            </p>\n        </div>\n    </div>\n</body>\n  `};a.sendMail(u,((t,n)=>{t?console.error("Error sending email:",t.message):console.log("Email successfully sent to:",e.email)}))}},2961:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:t.subject,html:`<!DOCTYPE html>\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>${t.subject}</title>\n    <style>\n        body {\n            font-family: 'Arial', 'Helvetica', sans-serif;\n            line-height: 1.6;\n            background-color: #f5f7fa;\n            color: #333;\n            margin: 0;\n            padding: 0;\n        }\n        .container {\n            background-color: #ffffff;\n            max-width: 600px;\n            margin: 20px auto;\n            padding: 0;\n            border-radius: 8px;\n            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);\n            overflow: hidden;\n        }\n        .header {\n            background-color: #3c4e62;\n            color: #ffffff;\n            padding: 25px;\n            text-align: center;\n            font-size: 24px;\n        }\n        .content {\n            padding: 30px;\n        }\n        .greeting {\n            font-size: 22px;\n            font-weight: bold;\n            color: #3c4e62;\n            margin-bottom: 20px;\n        }\n        .message-content {\n            background-color: #f0f4f8;\n            color: #333;\n            padding: 25px;\n            border-radius: 8px;\n            border-left: 4px solid #5b7a9d;\n            margin-bottom: 25px;\n        }\n        .user-info {\n            background-color: #e8eef3;\n            border: 1px solid #c0d0e0;\n            border-radius: 6px;\n            padding: 15px;\n            margin-top: 25px;\n            font-size: 0.9em;\n        }\n        .user-info h3 {\n            margin-top: 0;\n            color: #3c4e62;\n            font-size: 1.1em;\n        }\n        .footer {\n            background-color: #3c4e62;\n            padding: 20px;\n            text-align: center;\n            font-size: 14px;\n            color: #ecf0f1;\n        }\n        a {\n            color: #5b7a9d;\n            text-decoration: none;\n        }\n        .btn {\n            display: inline-block;\n            padding: 12px 24px;\n            background-color: #5b7a9d;\n            color: #ffffff;\n            border-radius: 6px;\n            text-decoration: none;\n            font-weight: bold;\n            margin-top: 25px;\n            transition: background-color 0.3s ease;\n        }\n        .btn:hover {\n            background-color: #4c6987;\n        }\n        .prime-badge {\n            display: inline-block;\n            background-color: #ffd700;\n            color: #333;\n            padding: 5px 10px;\n            border-radius: 15px;\n            font-size: 0.8em;\n            font-weight: bold;\n            margin-left: 10px;\n        }\n        @media only screen and (max-width: 600px) {\n            .container {\n                margin: 10px;\n                width: calc(100% - 20px);\n            }\n            .content {\n                padding: 20px;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class="container">\n        <div class="header">\n            E-commerce Application\n        </div>\n        <div class="content">\n            <div class="greeting">\n                Hello, ${e.name}!\n                ${e.isPrimeUser?'<span class="prime-badge">Prime Member</span>':""}\n            </div>\n            \n            <div class="message-content">\n                <p>${t.content}</p>\n            </div>\n\n            <a href="#" class="btn">View Account Details</a>\n\n            <div class="user-info">\n                <h3>Your Account Information</h3>\n                <p><strong>Email:</strong> ${e.email}</p>\n                <p><strong>Phone:</strong> ${e.phoneNumber}</p>\n                <p><strong>Loyalty Points:</strong> ${e.loyaltyPoints}</p>\n                <p><strong>Gift Card Balance:</strong> $${e.giftCard}</p>\n                ${e.isPrimeUser?`<p><strong>Prime Status:</strong> ${e.primeSubscriptionStatus}</p>`:""}\n                <p><strong>Shipping Address:</strong> ${e.shippingAddress||e.address||"N / A"}</p>\n            </div>\n        </div>\n\n        <div class="footer">\n            <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n            <p>\n                <a href="#" style="color: #ecf0f1;">Unsubscribe</a> | \n                <a href="#" style="color: #ecf0f1;">Privacy Policy</a>\n            </p>\n        </div>\n    </div>\n</body>\n</html>`};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Message send to user email successfully!")}))}},6289:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your Prime Membership Cancellation Confirmation",html:`\n     <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Prime Membership Cancellation Confirmation</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 600px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        .header {\n            background-color: #232f3e;\n            color: #ffffff;\n            padding: 20px;\n            text-align: center;\n        }\n        .content {\n            background-color: #f6f6f6;\n            padding: 20px;\n            border-radius: 5px;\n        }\n        .button {\n            display: inline-block;\n            background-color: #ff9900;\n            color: #ffffff;\n            padding: 10px 20px;\n            text-decoration: none;\n            border-radius: 5px;\n            margin-top: 20px;\n        }\n        .footer {\n            margin-top: 20px;\n            text-align: center;\n            font-size: 12px;\n            color: #666;\n        }\n    </style>\n</head>\n<body>\n    <div class="header">\n        <h1>Prime Membership Cancellation Confirmation</h1>\n    </div>\n    <div class="content">\n        <p>Dear ${e.name},</p>\n        <p>We're sorry to see you go. This email confirms that your Prime Membership has been cancelled as requested.</p>\n        <h2>Important Information:</h2>\n        <ul>\n            <li>Your membership benefits will remain active until: ${new Date(t.endDate).toLocaleDateString()}</li>\n            <li>No further payments will be taken from your account for this subscription.</li>\n            <li>You'll continue to have access to Prime benefits until the end date mentioned above.</li>\n        </ul>\n        <p>We hope you've enjoyed your time as a Prime Member. Remember, you're welcome to reactivate your membership at any time to enjoy these benefits again:</p>\n        <ul>\n            <li>Free and fast shipping on eligible items</li>\n            <li>Exclusive deals and discounts</li>\n            <li>Early access to new products</li>\n            <li>Premium customer support</li>\n        </ul>\n        <p>If you've changed your mind or cancelled by mistake, you can easily reactivate your membership:</p>\n        <a href="${process.env.FRONTEND_URL}/reactivate-membership" class="button">Reactivate Membership</a>\n    </div>\n    <div class="footer">\n        <p>If you have any questions about your cancellation or need assistance, our customer support team is always here to help.</p>\n        <p>We hope to see you again soon!</p>\n        <p>&copy; ${(new Date).getFullYear()} Your E-commerce Platform. All rights reserved.</p>\n    </div>\n</body>\n</html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Cancellation confirmation email sent successfully.")}))}},6053:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your Prime Membership is Expiring Soon - Renew Now!",html:`\n    <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Your Prime Membership is Expiring Soon</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 600px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        .header {\n            background-color: #232f3e;\n            color: #ffffff;\n            padding: 20px;\n            text-align: center;\n        }\n        .content {\n            background-color: #f6f6f6;\n            padding: 20px;\n            border-radius: 5px;\n        }\n        .button {\n            display: inline-block;\n            background-color: #ff9900;\n            color: #ffffff;\n            padding: 10px 20px;\n            text-decoration: none;\n            border-radius: 5px;\n            margin-top: 20px;\n        }\n        .footer {\n            margin-top: 20px;\n            text-align: center;\n            font-size: 12px;\n            color: #666;\n        }\n    </style>\n</head>\n<body>\n    <div class="header">\n        <h1>Your Prime Membership is Expiring Soon</h1>\n    </div>\n    <div class="content">\n        <p>Dear ${e.name},</p>\n        <p>We hope you've been enjoying your Prime Membership! This is a friendly reminder that your membership is set to expire soon.</p>\n        <h2>Membership Details:</h2>\n        <ul>\n            <li>Current Plan: ${t.plan}</li>\n            <li>Expiration Date: ${new Date(t.endDate).toLocaleDateString()}</li>\n        </ul>\n        <p>Don't miss out on these exclusive benefits:</p>\n        <ul>\n            <li>Free and fast shipping on eligible items</li>\n            <li>Exclusive deals and discounts</li>\n            <li>Early access to new products</li>\n            <li>Premium customer support</li>\n        </ul>\n        <p>To ensure uninterrupted access to these amazing perks, renew your membership now:</p>\n        <a href="${process.env.FRONTEND_URL}/renew-membership" class="button">Renew Now</a>\n        <p>By renewing, you'll continue to enjoy all the benefits of Prime Membership without any interruption.</p>\n    </div>\n    <div class="footer">\n        <p>If you have any questions about your membership or need assistance with renewal, our customer support team is always here to help.</p>\n        <p>Thank you for being a valued Prime Member!</p>\n        <p>&copy; ${(new Date).getFullYear()} Your E-commerce Platform. All rights reserved.</p>\n    </div>\n</body>\n</html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Expiration reminder email sent successfully.")}))}},5857:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your Prime Membership Has Expired - Reactivate Now",html:`\n  <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Your Prime Membership Has Expired</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 600px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        .header {\n            background-color: #232f3e;\n            color: #ffffff;\n            padding: 20px;\n            text-align: center;\n        }\n        .content {\n            background-color: #f6f6f6;\n            padding: 20px;\n            border-radius: 5px;\n        }\n        .button {\n            display: inline-block;\n            background-color: #ff9900;\n            color: #ffffff;\n            padding: 10px 20px;\n            text-decoration: none;\n            border-radius: 5px;\n            margin-top: 20px;\n        }\n        .footer {\n            margin-top: 20px;\n            text-align: center;\n            font-size: 12px;\n            color: #666;\n        }\n    </style>\n</head>\n<body>\n    <div class="header">\n        <h1>Your Prime Membership Has Expired</h1>\n    </div>\n    <div class="content">\n        <p>Dear ${e.name},</p>\n        <p>We hope this email finds you well. We wanted to inform you that your Prime Membership has expired, and we were unable to process the automatic renewal.</p>\n        <h2>Membership Details:</h2>\n        <ul>\n            <li>Previous Plan: ${t.plan}</li>\n            <li>Expiration Date: ${new Date(t.endDate).toLocaleDateString()}</li>\n        </ul>\n        <p>The automatic renewal may have failed due to one of the following reasons:</p>\n        <ul>\n            <li>Outdated payment information</li>\n            <li>Insufficient funds in the associated account</li>\n            <li>Technical issues during the payment process</li>\n        </ul>\n        <p>As a result, your Prime Membership benefits are no longer active. These include:</p>\n        <ul>\n            <li>Free and fast shipping on eligible items</li>\n            <li>Exclusive deals and discounts</li>\n            <li>Early access to new products</li>\n            <li>Premium customer support</li>\n        </ul>\n        <p>We'd love to have you back as a Prime Member. To reactivate your membership and continue enjoying these benefits, please click the button below:</p>\n        <a href="${process.env.FRONTEND_URL}/reactivate-membership" class="button">Reactivate Membership</a>\n        <p>If you encounter any issues or need assistance with reactivation, our customer support team is ready to help.</p>\n    </div>\n    <div class="footer">\n        <p>Thank you for being a part of our community. We hope to welcome you back to Prime Membership soon!</p>\n        <p>&copy; ${(new Date).getFullYear()} Your E-commerce Platform. All rights reserved.</p>\n    </div>\n</body>\n</html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Expired membership email sent successfully.")}))}},7115:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Welcome to prime memberShip. ",html:`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Welcome to Prime Membership!</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 600px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        .header {\n            background-color: #232f3e;\n            color: #ffffff;\n            padding: 20px;\n            text-align: center;\n        }\n        .content {\n            background-color: #f6f6f6;\n            padding: 20px;\n            border-radius: 5px;\n        }\n        .button {\n            display: inline-block;\n            background-color: #ff9900;\n            color: #ffffff;\n            padding: 10px 20px;\n            text-decoration: none;\n            border-radius: 5px;\n            margin-top: 20px;\n        }\n        .footer {\n            margin-top: 20px;\n            text-align: center;\n            font-size: 12px;\n            color: #666;\n        }\n    </style>\n</head>\n<body>\n    <div class="header">\n        <h1>Welcome to Prime Membership!</h1>\n    </div>\n    <div class="content">\n        <p>Dear ${e.name},</p>\n        <p>Welcome to our exclusive Prime Membership program! We're thrilled to have you on board and can't wait for you to experience all the amazing benefits we have in store for you.</p>\n        <h2>Your Membership Details:</h2>\n        <ul>\n            <li>Membership Status: ${t.status}</li>\n            <li>Plan: ${t.plan}</li>\n            <li>Start Date: ${new Date(t.startDate).toLocaleDateString()}</li>\n            <li>Next Billing Date: ${new Date(t.nextBillingDate).toLocaleDateString()}</li>\n        </ul>\n        <p>As a Prime Member, you'll enjoy:</p>\n        <ul>\n            <li>Free and fast shipping on eligible items</li>\n            <li>Exclusive deals and discounts</li>\n            <li>Early access to new products</li>\n            <li>Premium customer support</li>\n        </ul>\n        <p>Ready to start shopping? Click the button below to explore our latest offerings!</p>\n        <a href="${process.env.FRONTEND_URL}" class="button">Start Shopping</a>\n    </div>\n    <div class="footer">\n        <p>If you have any questions about your membership, please don't hesitate to contact our customer support team.</p>\n        <p>&copy; ${(new Date).getFullYear()} Your E-commerce Platform. All rights reserved.</p>\n    </div>\n</body>\n</html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Welcome membership message send successfully.")}))}},9764:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{var n,o;const i=(0,r.default)(),d={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Shop Request Accepted",text:`Dear ${e.name},\n\nWe are pleased to inform you that your request to open a shop named "${t.shopName}" with shop ID ${t._id} has been accepted. You can now start adding products and managing your shop.\n\nShop Details:\nName: ${t.shopName}\nDescription: ${t.shopDescription}\nEmail: ${t.email}\nPhone: ${t.phone}\nCategories: ${(null===(n=t.categories)||void 0===n?void 0:n.join(", "))||"N/A"}\n\nIf you have any further questions, please do not hesitate to contact us.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n   <div style="font-family: 'Roboto', Arial, sans-serif; line-height: 1.6; color: #333; font-size: 16px; background-color: #f0fff0; padding: 20px 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="text-align: center; color: #28a745; margin-bottom: 30px; font-size: 28px; font-weight: bold;">Shop Request Accepted</h2>\n    <p style="margin-bottom: 20px;">Dear ${e.name},</p>\n    <p style="margin-bottom: 20px;">We are pleased to inform you that your request to open a shop named "<strong style="color: #28a745;">${t.shopName}</strong>" with shop ID <strong style="color: #28a745; background-color: #e8f5e9; padding: 2px 5px; border-radius: 3px;">${t._id}</strong> has been accepted. You can now start adding products and managing your shop.</p>\n    <div style="background-color: #e8f5e9; border: 1px solid #c3e6cb; border-radius: 4px; padding: 20px; margin-bottom: 20px;">\n      <h3 style="color: #28a745; margin-top: 0;">Shop Details:</h3>\n      <ul style="list-style-type: none; padding-left: 0;">\n        <li style="margin-bottom: 10px;"><strong>Name:</strong> ${t.shopName}</li>\n        <li style="margin-bottom: 10px;"><strong>Description:</strong> ${t.shopDescription}</li>\n        <li style="margin-bottom: 10px;"><strong>Email:</strong> ${t.email}</li>\n        <li style="margin-bottom: 10px;"><strong>Phone:</strong> ${t.phone}</li>\n        <li><strong>Categories:</strong> ${(null===(o=t.categories)||void 0===o?void 0:o.join(", "))||"N/A"}</li>\n      </ul>\n    </div>\n    <p style="margin-bottom: 20px;">If you have any further questions, please do not hesitate to <a href="mailto:azaz123456az4@gmail.com" style="color: #28a745; text-decoration: none; border-bottom: 1px solid #28a745;">contact us</a>.</p>\n    <p style="margin-bottom: 10px;">Best regards,</p>\n    <p style="margin-bottom: 30px;"><strong>Your E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p style="margin-bottom: 10px;">This email was sent to ${e.email} because you requested to open a shop on our platform and your request has been accepted.</p>\n      <p>&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</div>\n    `};i.sendMail(d,((e,t)=>{e?console.log(e.message):console.log("Shop request acceptance email sent successfully.")}))}},9039:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Shop Request Cancellation Confirmation",text:`Dear ${e.name},\n\nWe are writing to confirm that your request to open a shop with application ID ${t._id} has been successfully cancelled. If this was a mistake or if you have any further questions, please do not hesitate to contact us.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n<div style="font-family: 'Helvetica Neue', Arial, sans-serif; line-height: 1.6; color: #333; font-size: 16px; background-color: #f8f8f8; padding: 20px 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="text-align: center; color: #c82333; margin-bottom: 30px; font-size: 28px; font-weight: bold;">Shop Request Cancellation</h2>\n    <p style="margin-bottom: 20px;">Dear ${e.name},</p>\n    <p style="margin-bottom: 20px;">We are writing to confirm that your request to open a shop with application ID <strong style="color: #444; background-color: #f1f1f1; padding: 2px 5px; border-radius: 3px;">${t._id}</strong> has been successfully cancelled.</p>\n    <p style="margin-bottom: 20px; background-color: #f8d7da; border: 1px solid #f5c6cb; border-radius: 4px; padding: 15px; color: #721c24;">\n      <strong>Note:</strong> If this cancellation was made in error, you may need to submit a new shop request.\n    </p>\n    <p style="margin-bottom: 20px;">If you have any further questions or concerns, please do not hesitate to <a href="mailto:azaz123456az4@gmail.com" style="color: #0056b3; text-decoration: none; border-bottom: 1px solid #0056b3;">contact us</a>.</p>\n    <p style="margin-bottom: 10px;">Best regards,</p>\n    <p style="margin-bottom: 30px;"><strong>Your E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p style="margin-bottom: 10px;">This email was sent to ${e.email} because you requested to open a shop on our platform and subsequently cancelled the request.</p>\n      <p>&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</div>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Shop request cancellation email sent successfully.")}))}},7110:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634)),i="http://localhost:3000/api/v1/shops/my-shop/verify-changed-email";t.default=(e,t,n,o)=>{const d=(0,r.default)(),s={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Change Shop Email Address Request",text:`Dear ${e.name},\n\nThank you for submitting your request to change your shop email address to ${o}. Your request has been received. Please click on the following link to confirm the email address change: ${i}/${n}\n\nThis verification email is valid for only 30 minutes.\n\nIf you have any questions, feel free to contact us.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n   <div style="font-family: 'Arial', sans-serif; line-height: 1.6; color: #333; font-size: 16px; background-color: #f0f7ff; padding: 20px 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border: 2px solid #007BFF; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="text-align: center; color: #007BFF; margin-bottom: 30px; font-size: 28px; font-weight: bold;">Change Shop Email Request Received</h2>\n    <p style="margin-bottom: 20px;">Dear ${e.name},</p>\n    <p style="margin-bottom: 20px;">Thank you for submitting your request to change your shop email address to <strong style="color: #007BFF;">${o}</strong>. Your request has been received.</p>\n    <p style="margin-bottom: 20px;">Please click on the following button to confirm the email address change:</p>\n    <div style="text-align: center; margin-bottom: 30px;">\n      <a href="${i}/${n}" style="display: inline-block; padding: 12px 24px; background-color: #007BFF; color: #fff; text-decoration: none; border-radius: 5px; font-weight: bold; transition: background-color 0.3s ease;">Change Email Address</a>\n    </div>\n    <p style="margin-bottom: 20px; background-color: #fff3cd; border: 1px solid #ffeeba; border-radius: 4px; padding: 15px; color: #856404;">\n      <strong>Important:</strong> This verification email is valid for only 30 minutes.\n    </p>\n    <p style="margin-bottom: 20px;">If you have any questions, feel free to <a href="mailto:azaz123456az4@gmail.com" style="color: #007BFF; text-decoration: none; border-bottom: 1px solid #007BFF;">contact us</a>.</p>\n    <p style="margin-bottom: 10px;">Best regards,</p>\n    <p style="margin-bottom: 30px;"><strong>Your E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p style="margin-bottom: 10px;">This email was sent to ${e.email} because you requested to change your shop email address on our platform.</p>\n      <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</div>\n    `};d.sendMail(s,((e,t)=>{e?console.log("Error sending shop request confirmation email:",e.message):console.log("Shop request confirmation email sent successfully.")}))}},1516:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Shop Deletion Request Cancellation",text:`Dear ${e.name},\n\nWe are writing to inform you that your request to delete the shop named ${t.shopName} with application ID ${n._id} has been canceled. If you have any questions or need further assistance, please contact our shop support team.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n <div style="font-family: 'Arial', sans-serif; line-height: 1.6; color: #333; font-size: 16px; background-color: #f8f8f8; padding: 20px 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="text-align: center; color: #c82333; margin-bottom: 30px; font-size: 28px; font-weight: bold;">Shop Deletion Request Cancellation</h2>\n    <p style="margin-bottom: 20px;">Dear ${e.name},</p>\n    <p style="margin-bottom: 20px;">We are writing to inform you that your request to delete the shop named <strong style="color: #444;">${t.shopName}</strong> with application ID <strong style="color: #444;">${n._id}</strong> has been canceled.</p>\n    <p style="margin-bottom: 20px;">If you have any questions or need further assistance, please <a href="mailto:azaz123456az4@gmail.com" style="color: #0056b3; text-decoration: none; border-bottom: 1px solid #0056b3;">contact our shop support team</a>.</p>\n    <p style="margin-bottom: 10px;">Best regards,</p>\n    <p style="margin-bottom: 30px;"><strong>Your E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p style="margin-bottom: 10px;">This email was sent to ${e.email} because you requested to delete a shop on our platform.</p>\n      <p>&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</div>\n    `};o.sendMail(i,((e,t)=>{e?console.log("Error sending shop deletion cancellation email:",e.message):console.log("Shop deletion cancellation email sent successfully.")}))}},871:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Shop Deletion Request Received",text:`Dear ${e.name},\n\nWe have received your request to delete the shop named ${t.shopName} with application ID ${n._id}. Our team will process this request shortly. If you have any further questions, please do not hesitate to contact us.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n<div style="font-family: 'Segoe UI', Arial, sans-serif; line-height: 1.6; color: #333; font-size: 16px; background-color: #f4f4f4; padding: 20px 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="text-align: center; color: #e74c3c; margin-bottom: 30px; font-size: 28px;">Shop Deletion Request Received</h2>\n    <p style="margin-bottom: 20px;">Dear ${e.name},</p>\n    <p style="margin-bottom: 20px;">We have received your request to delete the shop named <strong style="color: #2c3e50;">${t.shopName}</strong> with application ID <strong style="color: #2c3e50;">${n._id}</strong>.</p>\n    <p style="margin-bottom: 20px;">Our team will process this request shortly. If you have any further questions, please do not hesitate to <a href="mailto:azaz123456az4@gmail.com" style="color: #3498db; text-decoration: none; border-bottom: 1px solid #3498db;">contact us</a>.</p>\n    <p style="margin-bottom: 10px;">Best regards,</p>\n    <p style="margin-bottom: 30px;"><strong>Your E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #7f8c8d;">\n      <p style="margin-bottom: 10px;">This email was sent to ${e.email} because you requested to delete a shop on our platform.</p>\n      <p>&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</div>\n    `};o.sendMail(i,((e,t)=>{e?console.log("Error sending shop deletion request received email:",e.message):console.log("Shop deletion request received email sent successfully.")}))}},5704:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Shop Deletion Request Rejection",text:`Dear ${e.name},\n\nWe regret to inform you that your request to delete the shop named ${t.shopName} with application ID ${n._id} has been rejected. If you have any questions or need further assistance, please contact our shop support team.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n     <div style="font-family: 'Helvetica', Arial, sans-serif; line-height: 1.6; color: #333; font-size: 16px; background-color: #f9f9f9; padding: 20px 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="text-align: center; color: #c82333; margin-bottom: 30px; font-size: 28px; font-weight: bold;">Shop Deletion Request Rejection</h2>\n    <p style="margin-bottom: 20px;">Dear ${e.name},</p>\n    <p style="margin-bottom: 20px;">We regret to inform you that your request to delete the shop named <strong style="color: #444;">${t.shopName}</strong> with application ID <strong style="color: #444;">${n._id}</strong> has been rejected.</p>\n    <p style="margin-bottom: 20px; background-color: #f8d7da; border: 1px solid #f5c6cb; border-radius: 4px; padding: 15px; color: #721c24;">\n      <strong>Reason for rejection:</strong> ${n.reason}\n    </p>\n    <p style="margin-bottom: 20px;">If you have any questions about this decision or need further assistance, please <a href="mailto:azaz123456az4@gmail.com" style="color: #0056b3; text-decoration: none; border-bottom: 1px solid #0056b3;">contact our shop support team</a>.</p>\n    <p style="margin-bottom: 10px;">Best regards,</p>\n    <p style="margin-bottom: 30px;"><strong>Your E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p style="margin-bottom: 10px;">This email was sent to ${e.email} because you requested to delete a shop on our platform.</p>\n      <p>&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</div>\n    `};o.sendMail(i,((e,t)=>{e?console.log("Error sending shop deletion rejection email:",e.message):console.log("Shop deletion rejection email sent successfully.")}))}},4943:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Shop Deletion Request Confirmation",text:`Dear ${e.name},\n\nWe are writing to confirm that your request to delete the shop named ${t.shopName} with application ID ${n._id} has been successfully processed. If this was a mistake or if you have any further questions, please do not hesitate to contact us.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n<div style="font-family: 'Segoe UI', Arial, sans-serif; line-height: 1.6; color: #333; font-size: 16px; background-color: #f6f6f6; padding: 20px 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="text-align: center; color: #c82333; margin-bottom: 30px; font-size: 28px; font-weight: bold;">Shop Deletion Request Confirmation</h2>\n    <p style="margin-bottom: 20px;">Dear ${e.name},</p>\n    <p style="margin-bottom: 20px;">We are writing to confirm that your request to delete the shop named <strong style="color: #444;">${t.shopName}</strong> with application ID <strong style="color: #444;">${n._id}</strong> has been successfully processed.</p>\n    <div style="background-color: #f8d7da; border: 1px solid #f5c6cb; border-radius: 4px; padding: 15px; margin-bottom: 20px;">\n      <p style="margin: 0; color: #721c24;"><strong>Important:</strong> This action is irreversible. If you believe this was a mistake, please contact us immediately.</p>\n    </div>\n    <p style="margin-bottom: 20px;">If you have any further questions or concerns, please do not hesitate to <a href="mailto:azaz123456az4@gmail.com" style="color: #0056b3; text-decoration: none; border-bottom: 1px solid #0056b3;">contact us</a>.</p>\n    <p style="margin-bottom: 10px;">Best regards,</p>\n    <p style="margin-bottom: 30px;"><strong>Your E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p style="margin-bottom: 10px;">This email was sent to ${e.email} because you requested to delete a shop on our platform.</p>\n      <p>&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</div>\n    `};o.sendMail(i,((e,t)=>{e?console.log("Error sending shop deletion confirmation email:",e.message):console.log("Shop deletion confirmation email sent successfully.")}))}},6620:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6634));t.default=(e,t)=>o(void 0,void 0,void 0,(function*(){const n=(0,i.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:t.email,subject:`Product Unavailable: ${e.name}`,html:`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>Product Out of Stock Notification</title>\n  <style>\n    body {\n      font-family: 'Arial', sans-serif;\n      color: #333333;\n      line-height: 1.6;\n      background-color: #f4f4f4;\n      margin: 0;\n      padding: 0;\n    }\n    .container {\n      max-width: 600px;\n      margin: 20px auto;\n      background-color: #ffffff;\n      border-radius: 8px;\n      overflow: hidden;\n      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);\n    }\n    .header {\n      background-color: #f8f8f8;\n      border-bottom: 2px solid #3498db;\n      padding: 20px;\n      text-align: center;\n    }\n    .header h1 {\n      color: #3498db;\n      margin: 0;\n      font-size: 24px;\n    }\n    .content {\n      padding: 30px;\n    }\n    h2 {\n      color: #3498db;\n      margin-bottom: 20px;\n      font-size: 22px;\n      border-bottom: 1px solid #e0e0e0;\n      padding-bottom: 10px;\n    }\n    h3 {\n      color: #3498db;\n      font-size: 18px;\n      margin-top: 25px;\n      margin-bottom: 15px;\n    }\n    .product-info, .shop-info {\n      margin-bottom: 20px;\n      width: 100%;\n      border-collapse: separate;\n      border-spacing: 0;\n      border: 1px solid #e0e0e0;\n      border-radius: 5px;\n      overflow: hidden;\n    }\n    .product-info th, .shop-info th {\n      text-align: left;\n      padding: 12px;\n      background-color: #f8f8f8;\n      border-bottom: 1px solid #e0e0e0;\n      color: #3498db;\n    }\n    .product-info td, .shop-info td {\n      padding: 12px;\n      border-bottom: 1px solid #e0e0e0;\n    }\n    .product-info tr:last-child td, .shop-info tr:last-child td {\n      border-bottom: none;\n    }\n    a {\n      color: #3498db;\n      text-decoration: none;\n    }\n    a:hover {\n      text-decoration: underline;\n    }\n    .cta {\n      text-align: center;\n      margin: 30px 0;\n    }\n    .cta-button {\n      display: inline-block;\n      padding: 12px 24px;\n      color: #ffffff;\n      background-color: #3498db;\n      border-radius: 5px;\n      text-decoration: none;\n      font-size: 16px;\n      font-weight: bold;\n      transition: background-color 0.3s ease;\n    }\n    .cta-button:hover {\n      background-color: #2980b9;\n      text-decoration: none;\n    }\n    .footer {\n      background-color: #f8f8f8;\n      border-top: 2px solid #3498db;\n      color: #666666;\n      text-align: center;\n      padding: 20px;\n      font-size: 14px;\n    }\n    .footer a {\n      color: #3498db;\n    }\n  </style>\n</head>\n<body>\n  <div class="container">\n    <div class="header">\n      <h1>E-commerce Platform</h1>\n    </div>\n    <div class="content">\n      <h2>Product Out of Stock Notification</h2>\n      <p>Dear ${t.shopName},</p>\n      <p>We wanted to inform you that one of your products listed on our platform is now out of stock. Please find the details below:</p>\n\n      \x3c!-- Product Information --\x3e\n      <h3>Product Details</h3>\n      <table class="product-info">\n        <tr>\n          <th>Product Name:</th>\n          <td><a href="" target="_blank">${e.name}</a></td>\n        </tr>\n        <tr>\n          <th>Category:</th>\n          <td>${e.category}</td>\n        </tr>\n        <tr>\n          <th>Brand:</th>\n          <td>${e.brand}</td>\n        </tr>\n        <tr>\n          <th>Price:</th>\n          <td>$${e.price.toFixed(2)}</td>\n        </tr>\n        <tr>\n          <th>Availability Status:</th>\n          <td>Out of Stock</td>\n        </tr>\n      </table>\n\n      \x3c!-- Shop Information --\x3e\n      <h3>Shop Details</h3>\n      <table class="shop-info">\n        <tr>\n          <th>Shop Name:</th>\n          <td><a href="" target="_blank">${t.shopName}</a></td>\n        </tr>\n        <tr>\n          <th>Owner Name:</th>\n          <td>${t.shopName}</td>\n        </tr>\n        <tr>\n          <th>Email:</th>\n          <td><a href="mailto:${t.email}">${t.email}</a></td>\n        </tr>\n        <tr>\n          <th>Phone:</th>\n          <td>${t.phone}</td>\n        </tr>\n      </table>\n\n      <p>Please review your inventory and restock the item as soon as possible to ensure its availability to customers. If you need assistance with updating your inventory, feel free to reach out to our support team.</p>\n\n      <div class="cta">\n        <a href="" target="_blank" class="cta-button">Manage Your Shop</a>\n      </div>\n\n      <p>Thank you for your continued partnership with us.</p>\n      <p>Best regards,</p>\n      <p>E-commerce Platform Team</p>\n    </div>\n    <div class="footer">\n      <p>&copy; 2024 <a style="text-color:green;" href="https://www.your-ecommerce-platform.com" target="_blank">E-commerce Platform</a>. All rights reserved.</p>\n      <p>123 Commerce Street, City, State, ZIP </p>\n      <p> support@your-E-commerce-platform.com | (555) 123-4567</p>\n    </div>\n  </div>\n</body>\n</html>\n    `};try{yield n.sendMail(o),console.log("Product Unavailability Email sent successfully")}catch(e){console.error("Error sending email:",e)}}))},8112:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Shop Request Received",text:`Dear ${e.name},\n\nThank you for your interest in opening a shop on our e-commerce platform. We have received your request. Your application ID is ${t._id}. Our team will review your request and get back to you shortly.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n<div style="font-family: 'Helvetica Neue', Arial, sans-serif; line-height: 1.6; color: #333; font-size: 16px; background-color: #f7f7f7; padding: 20px 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 15px rgba(0,0,0,0.1);">\n    <h2 style="text-align: center; color: #0056b3; margin-bottom: 30px; font-size: 28px; font-weight: 600;">Shop Request Received</h2>\n    <p style="margin-bottom: 20px;">Dear ${e.name},</p>\n    <p style="margin-bottom: 20px;">Thank you for your interest in opening a shop on our e-commerce platform. We have received your request.</p>\n    <p style="margin-bottom: 20px;">Your application ID is: <strong style="color: #0056b3; font-size: 18px; display: inline-block; padding: 5px 10px; background-color: #e6f2ff; border-radius: 4px;">${t._id}</strong></p>\n    <p style="margin-bottom: 20px;">Our team will review your request and get back to you shortly.</p>\n    <p style="margin-bottom: 20px;">If you have any questions in the meantime, please do not hesitate to <a href="mailto:azaz123456az4@gmail.com" style="color: #0056b3; text-decoration: none; border-bottom: 1px solid #0056b3;">contact us</a>.</p>\n    <p style="margin-bottom: 10px;">Best regards,</p>\n    <p style="margin-bottom: 30px;"><strong>Your E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p style="margin-bottom: 10px;">This email was sent to ${e.email} because you requested to open a shop on our platform.</p>\n      <p>&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</div>\n  `};n.sendMail(o,((e,t)=>{e?console.log("Error sending shop request confirmation email:",e.message):console.log("Shop request confirmation email sent successfully.")}))}},1242:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Shop Request Rejection Notice",text:`Dear ${e.name},\n\nWe regret to inform you that your request to open a shop with application ID ${t._id} has been rejected. The reason for the rejection is as follows:\n\n${n}\n\nIf you have any further questions or need assistance, please do not hesitate to contact us.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n   <div style="font-family: 'Helvetica Neue', Arial, sans-serif; line-height: 1.6; color: #333; font-size: 16px; background-color: #f9f9f9; padding: 20px 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="text-align: center; color: #dc3545; margin-bottom: 30px; font-size: 28px; font-weight: bold;">Shop Request Rejected</h2>\n    <p style="margin-bottom: 20px;">Dear ${e.name},</p>\n    <p style="margin-bottom: 20px;">We regret to inform you that your request to open a shop with application ID <strong style="color: #444; background-color: #f1f1f1; padding: 2px 5px; border-radius: 3px;">${t._id}</strong> has been rejected.</p>\n    <div style="background-color: #f8d7da; border: 1px solid #f5c6cb; border-radius: 4px; padding: 20px; margin-bottom: 20px;">\n      <p style="margin: 0; color: #721c24;"><strong>Reason for rejection:</strong></p>\n      <p style="margin: 10px 0 0; font-style: italic;">${n}</p>\n    </div>\n    <p style="margin-bottom: 20px;">If you have any further questions or need assistance, please do not hesitate to <a href="mailto:azaz123456az4@gmail.com" style="color: #0056b3; text-decoration: none; border-bottom: 1px solid #0056b3;">contact us</a>.</p>\n    <p style="margin-bottom: 10px;">Best regards,</p>\n    <p style="margin-bottom: 30px;"><strong>Your E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p style="margin-bottom: 10px;">This email was sent to ${e.email} because you requested to open a shop on our platform and the request has been rejected.</p>\n      <p>&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</div>\n    `};o.sendMail(i,((e,t)=>{e?console.log(e.message):console.log("Shop request rejection email sent successfully.")}))}},8352:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Reset Your Shop Email Address",text:`Dear ${e.name},\n\nYour shop email address has been reset to the default email address (${e.email}).\n\nIf you have any questions, feel free to contact us.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n  <div style="font-family: 'Segoe UI', Arial, sans-serif; line-height: 1.6; color: #333; font-size: 16px; background-color: #f0f7ff; padding: 20px 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border: 2px solid #007BFF; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="text-align: center; color: #007BFF; margin-bottom: 30px; font-size: 28px; font-weight: bold;">Reset Your Shop Email Address</h2>\n    <p style="margin-bottom: 20px;">Dear ${e.name},</p>\n    <div style="background-color: #e6f3ff; border: 1px solid #b8daff; border-radius: 4px; padding: 20px; margin-bottom: 20px;">\n      <p style="margin: 0; color: #004085;">Your shop email address has been reset to the default email address:</p>\n      <p style="margin: 10px 0 0; font-weight: bold; font-size: 18px; color: #007BFF;">${e.email}</p>\n    </div>\n    <p style="margin-bottom: 20px;">If you did not request this change or have any questions, please <a href="mailto:azaz123456az4@gmail.com" style="color: #007BFF; text-decoration: none; border-bottom: 1px solid #007BFF;">contact us</a> immediately.</p>\n    <p style="margin-bottom: 10px;">Best regards,</p>\n    <p style="margin-bottom: 30px;"><strong>Your E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p style="margin-bottom: 10px;">This email was sent to ${e.email} because you requested to reset your shop email address on our platform.</p>\n      <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</div>\n        `};n.sendMail(o,((e,t)=>{e?console.log("Error sending welcome email to new address:",e.message):console.log("Welcome email sent to new address successfully.")}))}},1043:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6634));t.default=(e,t)=>o(void 0,void 0,void 0,(function*(){var n;const o=(0,i.default)(),r=t.items.map((e=>`\n    <tr>\n      <td style="padding: 14px; border-bottom: 1px solid #eee; font-size: 16px;">${e.product.name}</td>\n      <td style="padding: 14px; border-bottom: 1px solid #eee; text-align: center; font-size: 16px;">${e.quantity}</td>\n      <td style="padding: 14px; border-bottom: 1px solid #eee; text-align: right; font-size: 16px;">$${e.price.toFixed(2)}</td>\n      <td style="padding: 14px; border-bottom: 1px solid #eee; text-align: right; font-size: 16px;">$${e.discount.toFixed(2)}</td>\n      <td style="padding: 14px; border-bottom: 1px solid #eee; text-align: right; font-size: 16px;">$${e.priceAfterDiscount.toFixed(2)}</td>\n    </tr>\n  `)).join(""),d={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"New Order Received",html:`\n      <!DOCTYPE html>\n      <html lang="en">\n      <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <title>New Order Received</title>\n      </head>\n      <body style="font-family: Arial, sans-serif; color: #333; line-height: 1.8; background-color: #f4f4f4; margin: 0; padding: 0;">\n        <div style="max-width: 600px; margin: 20px auto; background-color: #ffffff; padding: 30px; border-radius: 5px; box-shadow: 0 0 10px rgba(0,0,0,0.1);">\n          <h2 style="color: #4CAF50; text-align: center; margin-bottom: 25px; font-size: 24px;">New Order Received</h2>\n          \n          <p style="font-size: 18px; margin-bottom: 20px;">Hello <strong>${e.shopName}</strong>,</p>\n          <p style="font-size: 18px; margin-bottom: 20px;">You have received a new order. Please find the details below:</p>\n          \n          \x3c!-- First Table: Order Summary --\x3e\n          <h3 style="color: #333; margin-top: 30px; font-size: 20px;">Order Summary</h3>\n          <table style="width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 16px;">\n            <tbody>\n              <tr style="background-color: #f2f2f2;">\n                <td style="padding: 14px; border-bottom: 1px solid #eee; font-weight: bold;">Order ID:</td>\n                <td style="padding: 14px; border-bottom: 1px solid #eee;">${t._id}</td>\n              </tr>\n              <tr>\n                <td style="padding: 14px; border-bottom: 1px solid #eee; font-weight: bold;">Order Date:</td>\n                <td style="padding: 14px; border-bottom: 1px solid #eee;">${t.createdAt.toLocaleString()}</td>\n              </tr>\n              <tr style="background-color: #f2f2f2;">\n                <td style="padding: 14px; border-bottom: 1px solid #eee; font-weight: bold;">Total Items:</td>\n                <td style="padding: 14px; border-bottom: 1px solid #eee;">${t.itemsQuantity}</td>\n              </tr>\n              <tr>\n                <td style="padding: 14px; border-bottom: 1px solid #eee; font-weight: bold;">Subtotal Price:</td>\n                <td style="padding: 14px; border-bottom: 1px solid #eee;">$${t.subtotalPrice.toFixed(2)}</td>\n              </tr>\n              <tr style="background-color: #f2f2f2;">\n                <td style="padding: 14px; border-bottom: 1px solid #eee; font-weight: bold;">Total Discount:</td>\n                <td style="padding: 14px; border-bottom: 1px solid #eee;">$${t.totalDiscount.toFixed(2)}</td>\n              </tr>\n              <tr>\n                <td style="padding: 14px; border-bottom: 1px solid #eee; font-weight: bold;">Platform Fee:</td>\n                <td style="padding: 14px; border-bottom: 1px solid #eee;">$${t.platformFee?t.platformFee.toFixed(2):"N/A"}</td>\n              </tr>\n              <tr style="background-color: #f2f2f2;">\n                <td style="padding: 14px; border-bottom: 1px solid #eee; font-weight: bold;">Net Price:</td>\n                <td style="padding: 14px; border-bottom: 1px solid #eee;">$${t.netPrice.toFixed(2)}</td>\n              </tr>\n              <tr>\n                <td style="padding: 14px; border-bottom: 1px solid #eee; font-weight: bold;">Payment Status:</td>\n                <td style="padding: 14px; border-bottom: 1px solid #eee;">${t.paymentStatus}</td>\n              </tr>\n              <tr style="background-color: #f2f2f2;">\n                <td style="padding: 14px; border-bottom: 1px solid #eee; font-weight: bold;">Shipping Status:</td>\n                <td style="padding: 14px; border-bottom: 1px solid #eee;">${t.shippingStatus}</td>\n              </tr>\n              <tr>\n                <td style="padding: 14px; border-bottom: 1px solid #eee; font-weight: bold;">Order Status:</td>\n                <td style="padding: 14px; border-bottom: 1px solid #eee;">${t.orderStatus}</td>\n              </tr>\n              ${t.discountCodes.length>0?`<tr style="background-color: #f2f2f2;">\n                <td style="padding: 14px; border-bottom: 1px solid #eee; font-weight: bold;">Discount Codes:</td>\n                <td style="padding: 14px; border-bottom: 1px solid #eee;">${null===(n=t.discountCodes)||void 0===n?void 0:n.join(", ")}</td>\n              </tr>`:""}\n            </tbody>\n          </table>\n\n          \x3c!-- Second Table: Order Items --\x3e\n          <h3 style="color: #333; margin-top: 30px; font-size: 20px;">Order Items</h3>\n          <table style="width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 16px;">\n            <thead>\n              <tr style="background-color: #f2f2f2;">\n                <th style="padding: 14px; border-bottom: 1px solid #eee; text-align: left; font-weight: bold;">Product</th>\n                <th style="padding: 14px; border-bottom: 1px solid #eee; text-align: center; font-weight: bold;">Quantity</th>\n                <th style="padding: 14px; border-bottom: 1px solid #eee; text-align: right; font-weight: bold;">Price</th>\n                <th style="padding: 14px; border-bottom: 1px solid #eee; text-align: right; font-weight: bold;">Discount</th>\n                <th style="padding: 14px; border-bottom: 1px solid #eee; text-align: right; font-weight: bold;">Price After Discount</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${r}\n            </tbody>\n          </table>\n\n          <p style="font-size: 18px; margin-top: 30px;">The order will be processed soon as possible. </p>\n          <p style="font-size: 18px; margin-top: 30px;">If you have any questions, feel free to contact our support team.</p>\n          <p style="font-size: 18px; margin-top: 30px;">Best regards,<br><strong>E-commerce Application Team</strong></p>\n          \n          <footer style="margin-top: 40px; margin-bottom: 40px; text-align: center; color: #777;">\n            <p style="font-size: 18px;">&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n             <p style="font-size: 16px;">\n              <a href="https://www.yourwebsite.com" style="color: #4CAF50; text-decoration: none;">Visit our website</a>\n            </p>\n          </footer>\n        </div>\n      </body>\n      </html>\n    `};try{yield o.sendMail(d),console.log(`Order email sent to ${e.email}`)}catch(e){console.error(`Error sending email: ${e}`)}}))},2086:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e,subject:"Welcome to Your New Shop Email Address",text:`Dear ${t.name},\n\nWelcome to your new shop email address (${e}). Your shop, ${n.shopName}, is now associated with this email.\n\nIf you have any questions, feel free to contact us.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n    <div style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; font-size: 16px;">\n      <div style="max-width: 600px; margin: 0 auto; padding: 20px; border: 2px solid #007BFF; border-radius: 5px;">\n        <h2 style="text-align: center; color: #007BFF;">Welcome to Your New Shop Email Address</h2>\n        <p>Dear ${t.name},</p>\n        <p>Welcome to your new shop email address (${e}). Your shop, ${n.shopName}, is now associated with this email.</p>\n        <p>If you have any questions, feel free to <a href="mailto:azaz123456az4@gmail.com" style="color: #007BFF;">contact us</a>.</p>\n        <p>Best regards,</p>\n        <p><strong>Your E-commerce Application Team</strong></p>\n      </div>\n      <div style="text-align: center; margin-top: 20px;">\n        <p style="font-size: 12px; color: #888;">This email was sent to ${e} because you requested to change your shop email address on our platform.</p>\n        <p style="font-size: 12px; color: #888;">&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n      </div>\n    </div>\n    `};o.sendMail(i,((e,t)=>{e?console.log("Error sending welcome email to new address:",e.message):console.log("Welcome email sent to new address successfully.")}))}},4378:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Refund request related to your shop has been approved",html:`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Refund Request Approved</title>\n</head>\n<body style="font-family: 'Helvetica Neue', Arial, sans-serif; color: #333; line-height: 1.6; font-size: 16px; background-color: #f0f4f8; padding: 20px 0; margin: 0;">\n    <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n        <h2 style="color: #3498db; font-size: 28px; margin-bottom: 20px; text-align: center;">Refund Request Approved</h2>\n        <p>Hello ${e.shopName},</p>\n        <p>We are pleased to inform you that a refund request related to your shop has been approved. The refund has been processed successfully.</p>\n        <div style="background-color: #ebf5fb; border-radius: 8px; padding: 20px; margin: 20px 0;">\n            <h3 style="color: #2980b9; margin-top: 0;">Refund Request Details:</h3>\n            <table style="width: 100%; border-collapse: separate; border-spacing: 0 10px;">\n                <tr>\n                    <td style="padding: 5px 10px; font-weight: bold;">Order ID:</td>\n                    <td style="padding: 5px 10px;">${t.order}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 5px 10px; font-weight: bold;">Refund Status:</td>\n                    <td style="padding: 5px 10px; color: #2980b9; font-weight: bold;">${t.refundStatus}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 5px 10px; font-weight: bold;">Refund Amount:</td>\n                    <td style="padding: 5px 10px;">$${t.refundAmount.toFixed(2)}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 5px 10px; font-weight: bold;">Discounted Amount:</td>\n                    <td style="padding: 5px 10px;">$${t.refundAmount.toFixed(2)}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 5px 10px; font-weight: bold;">Refund Type:</td>\n                    <td style="padding: 5px 10px;">${t.refundType}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 5px 10px; font-weight: bold;">Processed On:</td>\n                    <td style="padding: 5px 10px;">${new Date(t.refundProcessedAt).toLocaleDateString()}</td>\n                </tr>\n                <tr>\n                    <td style="padding: 5px 10px; font-weight: bold;">Current Shop Balance:</td>\n                    <td style="padding: 5px 10px;">$${e.balance.toFixed(2)}</td>\n                </tr>\n            </table>\n        </div>\n        <p>The customer has been notified about the refund approval separately. If you have any questions, feel free to contact our support team.</p>\n        <div style="background-color: #f5f7fa; border-radius: 4px; padding: 15px; margin-top: 30px;">\n            <p style="margin: 0; font-weight: bold;">Need assistance?</p>\n            <p style="margin: 10px 0 0;">Email us at <a href="mailto:support@ecommerceapp.com" style="color: #3498db; text-decoration: none; border-bottom: 1px solid #3498db;">support@ecommerceapp.com</a></p>\n        </div>\n        <p style="margin-top: 30px; margin-bottom: 0;">Best regards,</p>\n        <p style="margin-top: 5px;"><strong>E-commerce Application Team</strong></p>\n        <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n            <p>&copy; ${(new Date).getFullYear()} Your E-commerce Company. All rights reserved.</p>\n        </div>\n    </div>\n</body>\n</html>\n\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Refund  request approve email  sent to  shop .")}))}},7740:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Refund request related to your shop has been rejected",html:`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Refund Request Update</title>\n</head>\n<body style="font-family: 'Helvetica Neue', Arial, sans-serif; color: #333; line-height: 1.6; font-size: 16px; background-color: #f0f4f8; padding: 20px 0; margin: 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="color: #3498db; font-size: 28px; margin-bottom: 20px; text-align: center;">Refund Request Update</h2>\n    <p>Hello ${e.shopName},</p>\n    <p>We are writing to inform you that a refund request related to your shop has been processed. The refund has been rejected, and no action is required from your end.</p>\n    <div style="background-color: #ebf5fb; border-radius: 8px; padding: 20px; margin: 20px 0;">\n      <h3 style="color: #2980b9; margin-top: 0;">Refund Request Details:</h3>\n      <table style="width: 100%; border-collapse: separate; border-spacing: 0 10px;">\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Order ID:</td>\n          <td style="padding: 5px 10px;">${t.order}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Refund Status:</td>\n          <td style="padding: 5px 10px; color: #e74c3c; font-weight: bold;">${t.refundStatus}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Refund Amount:</td>\n          <td style="padding: 5px 10px;">$${t.refundAmount.toFixed(2)}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Refund Type:</td>\n          <td style="padding: 5px 10px;">${t.refundType}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Processed On:</td>\n          <td style="padding: 5px 10px;">${new Date(t.refundProcessedAt).toLocaleDateString()}</td>\n        </tr>\n      </table>\n    </div>\n    <p>This update is for your information only. The customer has been notified about the refund decision separately.</p>\n    <p>If you have any questions about this update, please don't hesitate to contact our support team.</p>\n    <div style="background-color: #f5f7fa; border-radius: 4px; padding: 15px; margin-top: 30px;">\n      <p style="margin: 0; font-weight: bold;">Need assistance?</p>\n      <p style="margin: 10px 0 0;">Email us at <a href="mailto:support@ecommerceapp.com" style="color: #3498db; text-decoration: none; border-bottom: 1px solid #3498db;">support@ecommerceapp.com</a></p>\n    </div>\n    <p style="margin-top: 30px; margin-bottom: 0;">Best regards,</p>\n    <p style="margin-top: 5px;"><strong>E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p>&copy; ${(new Date).getFullYear()} Your E-commerce Company. All rights reserved.</p>\n    </div>\n  </div>\n</body>\n</html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Refund  request rejection email  sent to  shop .")}))}},8915:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Return  product related to your shop has been rejected",html:`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Return Request Rejected</title>\n</head>\n<body style="font-family: 'Helvetica Neue', Arial, sans-serif; color: #333; line-height: 1.6; font-size: 16px; background-color: #f0f4f8; padding: 20px 0; margin: 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="color: #3498db; font-size: 28px; margin-bottom: 20px; text-align: center;">Return Request Rejected</h2>\n    <p>Hello ${e.shopName},</p>\n    <p>We are writing to inform you that a return request for a product from your shop has been rejected. Below are the details of the rejected request:</p>\n    <div style="background-color: #ebf5fb; border-radius: 8px; padding: 20px; margin: 20px 0;">\n      <h3 style="color: #2980b9; margin-top: 0;">Return Request Details:</h3>\n      <table style="width: 100%; border-collapse: separate; border-spacing: 0 10px;">\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Request ID:</td>\n          <td style="padding: 5px 10px;">${t._id}</td>\n        </tr>\n      \n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Return Status:</td>\n          <td style="padding: 5px 10px; color: #3498db; font-weight: bold;">${t.returnStatus}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Return Reason:</td>\n          <td style="padding: 5px 10px;">${t.returnReason}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Rejection Reason:</td>\n          <td style="padding: 5px 10px;">${t.rejectionReason}</td>\n        </tr>\n      </table>\n    </div>\n    <div style="margin-bottom: 30px;">\n      <h3 style="color: #2980b9;">Product Details:</h3>\n      <table style="width: 100%; border-collapse: collapse;">\n        <tr style="background-color: #ebf5fb;">\n          <th style="padding: 10px; text-align: left; border-bottom: 2px solid #3498db;">Description</th>\n          <th style="padding: 10px; text-align: right; border-bottom: 2px solid #3498db;">Details</th>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Product Name</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">${t.product.name}</td>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Quantity</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">${t.quantity}</td>\n        </tr>\n      </table>\n    </div>\n    <p>The return request has been rejected for the reason stated above. No further action is required from your end regarding this return request.</p>\n    <p>If you have any questions or concerns about this decision, please don't hesitate to contact our support team.</p>\n    <div style="background-color: #f5f7fa; border-radius: 4px; padding: 15px; margin-top: 30px;">\n      <p style="margin: 0; font-weight: bold;">Need assistance?</p>\n      <p style="margin: 10px 0 0;">Email us at <a href="mailto:azaz123456az4@gmail.com" style="color: #3498db; text-decoration: none; border-bottom: 1px solid #3498db;">support@ecommerceapp.com</a></p>\n    </div>\n    <p style="margin-top: 30px; margin-bottom: 0;">Best regards,</p>\n    <p style="margin-top: 5px;"><strong>E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</body>\n</html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Return request rejection email  sent to product shop.")}))}},1302:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Refund request related to your shop have been created",html:`\n     <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Refund Request Notification for Shop Owner</title>\n</head>\n<body style="font-family: 'Helvetica Neue', Arial, sans-serif; color: #333; line-height: 1.6; font-size: 16px; background-color: #f0f4f8; padding: 20px 0; margin: 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="color: #2c3e50; font-size: 28px; margin-bottom: 20px; text-align: center;">New Refund Request Notification</h2>\n    <p>Dear ${e.shopName||"Shop Owner"},</p>\n    <p>A new refund request has been created for an order from your shop. Please review the details below:</p>\n    <div style="background-color: #ecf0f1; border-radius: 8px; padding: 20px; margin: 20px 0;">\n      <h3 style="color: #34495e; margin-top: 0;">Refund Request Details:</h3>\n      <table style="width: 100%; border-collapse: separate; border-spacing: 0 10px;">\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Request ID:</td>\n          <td style="padding: 5px 10px; word-break: break-all;">${t._id||"N/A"}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Order ID:</td>\n          <td style="padding: 5px 10px; word-break: break-all;">${t.order||"N/A"}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Refund Status:</td>\n          <td style="padding: 5px 10px;">${t.refundStatus||"N/A"}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Refund Type:</td>\n          <td style="padding: 5px 10px;">${t.refundType||"N/A"}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Refund Method:</td>\n          <td style="padding: 5px 10px;">${t.refundMethod||"N/A"}</td>\n        </tr>\n      </table>\n    </div>\n    <div style="margin-bottom: 30px;">\n      <h3 style="color: #34495e;">Financial Summary:</h3>\n      <table style="width: 100%; border-collapse: collapse;">\n        <tr style="background-color: #ecf0f1;">\n          <th style="padding: 10px; text-align: left; border-bottom: 2px solid #2c3e50;">Description</th>\n          <th style="padding: 10px; text-align: right; border-bottom: 2px solid #2c3e50;">Amount</th>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Refund Amount</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0; font-weight: bold;">$${t.refundAmount?t.refundAmount.toFixed(2):"0.00"}</td>\n        </tr>\n      </table>\n    </div>\n    <p>Please take the following actions:</p>\n    <ol>\n      <li>Review the refund request details in your shop management dashboard.</li>\n      <li>Ensure that the returned item(s) have been received (if applicable).</li>\n      <li>Process the refund according to your shop's policies and the platform guidelines.</li>\n      <li>Update the refund status in the system once processed.</li>\n    </ol>\n    <p>If you have any questions or concerns about this refund request, please contact our merchant support team.</p>\n    <div style="background-color: #ecf0f1; border-radius: 4px; padding: 15px; margin-top: 30px;">\n      <p style="margin: 0; font-weight: bold;">Need assistance?</p>\n      <p style="margin: 10px 0 0;">Contact our merchant support team at <a href="mailto:merchantsupport@ecommerceapp.com" style="color: #2c3e50; text-decoration: none; border-bottom: 1px solid #2c3e50;">merchantsupport@ecommerceapp.com</a></p>\n    </div>\n    <p style="margin-top: 30px; margin-bottom: 0;">Thank you for your prompt attention to this matter.</p>\n    <p style="margin-top: 5px;">Best regards,</p>\n    <p style="margin-top: 5px;"><strong>E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</body>\n</html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Refund request creation email sent")}))}},2559:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your return product request has been created",html:`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Return Request Notification</title>\n</head>\n<body style="font-family: 'Helvetica Neue', Arial, sans-serif; color: #333; line-height: 1.6; font-size: 16px; background-color: #f0f4f8; padding: 20px 0; margin: 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="color: #e67e22; font-size: 28px; margin-bottom: 20px; text-align: center;">Return Request Notification</h2>\n    <p>Hello ${e.shopName},</p>\n    <p>We would like to inform you that a return request has been made for a product from your shop. Below are the details of the request:</p>\n    <div style="background-color: #fdf3e8; border-radius: 8px; padding: 20px; margin: 20px 0;">\n      <h3 style="color: #d35400; margin-top: 0;">Return Request Details:</h3>\n      <table style="width: 100%; border-collapse: separate; border-spacing: 0 10px;">\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Request ID:</td>\n          <td style="padding: 5px 10px;">${t._id}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Order ID:</td>\n          <td style="padding: 5px 10px;">${t.order}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Return Status:</td>\n          <td style="padding: 5px 10px;">${t.returnStatus}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Received Items Status:</td>\n          <td style="padding: 5px 10px;">${t.receivedItemsStatus}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Return Reason:</td>\n          <td style="padding: 5px 10px;">${t.returnReason}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Refund Amount:</td>\n          <td style="padding: 5px 10px;">$${t.refundAmount.toFixed(2)}</td>\n        </tr>\n      </table>\n    </div>\n    <div style="margin-bottom: 30px;">\n      <h3 style="color: #d35400;">Product Details:</h3>\n      <table style="width: 100%; border-collapse: collapse;">\n        <tr style="background-color: #fdf3e8;">\n          <th style="padding: 10px; text-align: left; border-bottom: 2px solid #e67e22;">Description</th>\n          <th style="padding: 10px; text-align: right; border-bottom: 2px solid #e67e22;">Details</th>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Product Name</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">${t.product.name}</td>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Quantity</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">${t.quantity}</td>\n        </tr>\n      </table>\n    </div>\n    <p>Please review the return request and take the necessary actions. You can view and manage this request from your shop dashboard.</p>\n    <ul>\n      <li>The return request is currently in <strong>${t.returnStatus}</strong> status.</li>\n      <li>The received items status is set to <strong>${t.receivedItemsStatus}</strong>.</li>\n      <li>If the return is approved, please ensure the appropriate refund process is initiated.</li>\n    </ul>\n    <p>If you have any questions or need assistance, please contact our support team.</p>\n    <div style="background-color: #f5f7fa; border-radius: 4px; padding: 15px; margin-top: 30px;">\n      <p style="margin: 0; font-weight: bold;">Need help?</p>\n      <p style="margin: 10px 0 0;">Email us at <a href="mailto:support@ecommerceapp.com" style="color: #e67e22; text-decoration: none; border-bottom: 1px solid #e67e22;">support@ecommerceapp.com</a></p>\n    </div>\n    <p style="margin-top: 30px; margin-bottom: 0;">Best regards,</p>\n    <p style="margin-top: 5px;"><strong>E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</body>\n</html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("return product request confirmation email sent to shop successfully")}))}},9701:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <support@ecommerceapp.com>",to:e.email,subject:"Support Ticket Received",text:`Dear ${e.shopName},\n\nWe have received a support ticket from ${t.name}. Your ticket ID is ${n._id}. Our team will review your request and respond to you shortly.\n\nTicket Details:\n\nSubject: ${n.subject}\nDescription: ${n.description}\nCategory: ${n.category}\n\nBest regards,\nYour E-commerce Application Team`,html:`\n    <div style="font-family: 'Segoe UI', Arial, sans-serif; line-height: 1.6; color: #333; font-size: 16px; background-color: #f0f7ff; padding: 20px 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="text-align: center; color: #007BFF; margin-bottom: 30px; font-size: 28px; font-weight: bold;">Support Ticket Received</h2>\n    <p style="margin-bottom: 20px;">Dear ${e.shopName},</p>\n    <p style="margin-bottom: 20px;">We have received a support ticket from <strong>${t.name}</strong>. Your ticket ID is <strong style="color: #007BFF; background-color: #e6f2ff; padding: 2px 5px; border-radius: 3px;">${n._id}</strong>. Our team will review your request and respond to you shortly.</p>\n    \n    <div style="border-top: 2px solid #007BFF; margin: 30px 0; padding-top: 20px;">\n      <h3 style="color: #007BFF; margin-bottom: 20px;">Ticket Details</h3>\n      <table style="width: 100%; border-collapse: separate; border-spacing: 0 10px;">\n        <tr>\n          <td style="padding: 10px; font-weight: bold; color: #007BFF; width: 30%; vertical-align: top;">Subject:</td>\n          <td style="padding: 10px; word-wrap: break-word; background-color: #f8f9fa; border-radius: 4px;">${n.subject}</td>\n        </tr>\n        <tr>\n          <td style="padding: 10px; font-weight: bold; color: #007BFF; width: 30%; vertical-align: top;">Description:</td>\n          <td style="padding: 10px; word-wrap: break-word; background-color: #f8f9fa; border-radius: 4px;">${n.description}</td>\n        </tr>\n        <tr>\n          <td style="padding: 10px; font-weight: bold; color: #007BFF; width: 30%; vertical-align: top;">Category:</td>\n          <td style="padding: 10px; word-wrap: break-word; background-color: #f8f9fa; border-radius: 4px;">${n.category}</td>\n        </tr>\n      </table>\n    </div>\n    \n    <p style="margin-bottom: 20px;">If you have any questions in the meantime, please do not hesitate to <a href="mailto:support@ecommerceapp.com" style="color: #007BFF; text-decoration: none; border-bottom: 1px solid #007BFF;">contact us</a>.</p>\n    <p style="margin-bottom: 10px;">Best regards,</p>\n    <p style="margin-bottom: 30px;"><strong>Your E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p style="margin-bottom: 10px;">This email was sent to ${e.email} because a support ticket was submitted on your shop's behalf.</p>\n      <p>&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</div>\n  `};o.sendMail(i,((e,t)=>{e?console.log("Error sending support ticket received email:",e.message):console.log("Support ticket received email sent successfully.")}))}},4693:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <support@ecommerceapp.com>",to:e.email,subject:"Support Ticket Processed",text:`Dear ${e.shopName},\n\nYour support ticket with ID ${n._id} has been processed. Here are the details of your ticket:\n\nSubject: ${n.subject}\nCategory: ${n.category}\nDescription: ${n.description}\n\nResponse from our team:\n\n${n.ticketResponse}\n\nIf you have any further questions, please do not hesitate to contact us.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n    <div style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; font-size: 1rem;">\n      <div style="max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 5px;">\n        <h2 style="text-align: center; color: #007BFF;">Support Ticket Processed</h2>\n        <p>Dear ${e.shopName},</p>\n        <p>Your support ticket has been processed. Here are the details of your ticket:</p>\n        \n        <div style="border-top: 2px solid #007BFF; margin: 20px 0; padding-top: 10px;">\n          <h3 style="color: #333;">Ticket Details</h3>\n          <table style="width: 100%; border-collapse: collapse;">\n            <tr style="border-bottom: 1px solid #ddd;">\n              <td style="padding: 10px; font-weight: bold; color: #007BFF;">Ticket ID:</td>\n              <td style="padding: 10px; word-wrap: break-word;">${n._id}</td>\n            </tr>\n            <tr style="border-bottom: 1px solid #ddd;">\n              <td style="padding: 10px; font-weight: bold; color: #007BFF;">Subject:</td>\n              <td style="padding: 10px; word-wrap: break-word;">${n.subject}</td>\n            </tr>\n            <tr style="border-bottom: 1px solid #ddd;">\n              <td style="padding: 10px; font-weight: bold; color: #007BFF;">Description:</td>\n              <td style="padding: 10px; word-wrap: break-word;">${n.description}</td>\n            </tr>\n            <tr style="border-bottom: 1px solid #ddd;">\n              <td style="padding: 10px; font-weight: bold; color: #007BFF;">Category:</td>\n              <td style="padding: 10px; word-wrap: break-word;">${n.category}</td>\n            </tr>\n          </table>\n        </div>\n        \n        <div style="border-top: 2px solid #007BFF; margin: 20px 0; padding-top: 10px;">\n          <h3 style="color: #333;">Ticket Response</h3>\n          <div style="padding: 10px; background-color: #f9f9f9; border-radius: 5px; word-wrap: break-word; max-height: 200px; overflow-y: auto;">\n            ${n.ticketResponse}\n          </div>\n        </div>\n        \n        <p>If you have any further questions, please do not hesitate to <a href="mailto:support@ecommerceapp.com" style="color: #007BFF;">contact us</a>.</p>\n        <p>Best regards,</p>\n        <p><strong>Your E-commerce Application Team</strong></p>\n      </div>\n      <div style="text-align: center; margin-top: 20px;">\n        <p style="font-size: 12px; color: #888;">This email was sent to ${e.email} because a support ticket was processed on your shop's behalf.</p>\n        <p style="font-size: 12px; color: #888;">&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n      </div>\n    </div>\n  `};o.sendMail(i,((e,t)=>{e?console.log("Error sending support ticket processed email:",e.message):console.log("Support ticket processed email sent successfully.")}))}},7460:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o=t.email,i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your Shop Email Address Has Been Updated Successfully!",text:`Dear ${e.name},\n\nYour shop email address for ${t.shopName} has been successfully updated to ${o}. You can now manage all your shop operations using this new email address.\n\nIf you have any questions, feel free to contact us.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n      <div style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; font-size: 16px;">\n        <div style="max-width: 600px; margin: 0 auto; padding: 20px; border: 2px solid #007BFF; border-radius: 5px;">\n          <h2 style="text-align: center; color: #007BFF;">Shop Email Address Updated Successfully!</h2>\n          <p>Dear ${e.name},</p>\n          <p>We're happy to inform you that your shop email address for "${t.shopName}" has been successfully updated to ${o}.</p>\n          <p>You can now manage all your shop operations, including receiving order notifications, managing customer inquiries, and updating product listings, using this new email address.</p>\n          <p>If you have any questions, feel free to <a href="mailto:azaz123456az4@gmail.com" style="color: #007BFF;">contact us</a>.</p>\n          <p>Best regards,</p>\n          <p><strong>Your E-commerce Application Team</strong></p>\n        </div>\n        <div style="text-align: center; margin-top: 20px;">\n          <p style="font-size: 12px; color: #888;">This email was sent to ${o} because you requested to change your shop email address on our platform.</p>\n          <p style="font-size: 12px; color: #888;">&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n        </div>\n      </div>\n      `};n.sendMail(i,((e,t)=>{e?console.log("Error sending welcome email to new address:",e.message):console.log("Welcome email sent to new address successfully.")}))}},5448:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:t.email,subject:"New Product Added Successfully",html:`\n      <!DOCTYPE html>\n      <html lang="en">\n     <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Product Added Successfully</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 600px;\n            margin: 0 auto;\n            padding: 20px;\n            background-color: #f4f4f4;\n        }\n        .container {\n            background-color: #ffffff;\n            padding: 40px;\n            border-radius: 8px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n        }\n        .header {\n            color: #28a745;\n            font-size: 28px;\n            margin-bottom: 20px;\n            text-align: center;\n        }\n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-bottom: 20px;\n        }\n        th, td {\n            padding: 10px;\n            border: 1px solid #ddd;\n            text-align: left;\n        }\n        th {\n            background-color: #f2f2f2;\n            font-weight: bold;\n        }\n        .footer {\n            text-align: center;\n            margin-top: 20px;\n            font-size: 12px;\n            color: #888;\n        }\n        @media only screen and (max-width: 600px) {\n            table, tr, td {\n                display: block;\n            }\n            tr {\n                margin-bottom: 10px;\n            }\n            td {\n                border: none;\n                position: relative;\n                padding-left: 50%;\n            }\n            td:before {\n                content: attr(data-label);\n                position: absolute;\n                left: 6px;\n                width: 45%;\n                padding-right: 10px;\n                white-space: nowrap;\n                font-weight: bold;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class="container">\n        <h2 class="header">Product Added Successfully</h2>\n        <p>Dear ${e.name},</p>\n        <p>We are pleased to inform you that your new product has been successfully added to your shop. Your product is now visible to customers and available for purchase.</p>\n        \n        <h3>Product Details</h3>\n        <table>\n            <tr>\n                <th>Product Name</th>\n                <td data-label="Product Name">${n.name}</td>\n            </tr>\n            <tr>\n                <th>Category</th>\n                <td data-label="Category">${n.category}</td>\n            </tr>\n            <tr>\n                <th>Price</th>\n                <td data-label="Price">$${n.price.toFixed(2)}</td>\n            </tr>\n            <tr>\n                <th>Stock Quantity</th>\n                <td data-label="Stock Quantity">${n.stock_quantity}</td>\n            </tr>\n        </table>\n\n        <h3>Shop Information</h3>\n        <table>\n            <tr>\n                <th>Shop Name</th>\n                <td data-label="Shop Name">${t.shopName}</td>\n            </tr>\n            <tr>\n                <th>Shop Email</th>\n                <td data-label="Shop Email">${t.email}</td>\n            </tr>\n        </table>\n\n        <p>If you have any questions or need to make changes to your product listing, please don't hesitate to contact our support team.</p>\n        \n        <p>Best regards,<br><strong>Your E-commerce Application Team</strong></p>\n    </div>\n    <div class="footer">\n        <p>This email was sent to ${t.email} because you added a new product to your shop on our platform.</p>\n        <p>&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n    </div>\n</body>\n</html>\n      </html>\n    `};o.sendMail(i,((e,t)=>{e?console.log(e.message):console.log("Product addition confirmation email sent successfully.")}))}},8912:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:t.email,subject:"Product Deletion Confirmation",text:`Dear ${e.name},\n\nWe are writing to confirm that your product "${n.name}" has been successfully deleted from your shop. If this was a mistake or if you have any further questions, please do not hesitate to contact us.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n  <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Product Deletion Confirmation</title>\n    <style>\n        /* Base styles */\n        body, html {\n            margin: 0;\n            padding: 0;\n            font-family: Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            background-color: #f4f4f4;\n        }\n        .container {\n            max-width: 600px;\n            margin: 20px auto;\n            background-color: #ffffff;\n            border-radius: 8px;\n            overflow: hidden;\n            box-shadow: 0 0 10px rgba(0,0,0,0.1);\n        }\n        .header {\n            background-color: #dc3545;\n            color: #ffffff;\n            padding: 20px;\n            text-align: center;\n        }\n        .content {\n            padding: 30px;\n        }\n        .footer {\n            background-color: #f8f9fa;\n            padding: 20px;\n            text-align: center;\n            font-size: 12px;\n            color: #6c757d;\n        }\n        h1, h2 {\n            margin: 0;\n            line-height: 1.2;\n        }\n        h1 {\n            font-size: 24px;\n            margin-bottom: 10px;\n        }\n        h2 {\n            font-size: 18px;\n            font-weight: normal;\n        }\n        .product-details {\n            background-color: #f8f9fa;\n            border-radius: 4px;\n            padding: 15px;\n            margin: 20px 0;\n        }\n        .product-details p {\n            margin: 5px 0;\n        }\n        .button {\n            display: inline-block;\n            padding: 10px 20px;\n            background-color: #007bff;\n            color: #ffffff;\n            text-decoration: none;\n            border-radius: 5px;\n            margin-top: 20px;\n        }\n        @media only screen and (max-width: 600px) {\n            .container {\n                width: 100%;\n                margin: 0;\n                border-radius: 0;\n            }\n            .content, .footer {\n                padding: 20px;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class="container">\n        <div class="header">\n            <h1>Product Deletion Confirmation</h1>\n            <h2>Your E-commerce Application</h2>\n        </div>\n        <div class="content">\n            <p>Dear ${e.name},</p>\n            <p>We are writing to confirm that your product has been successfully deleted from your shop. Here are the details of the deleted product:</p>\n            \n            <div class="product-details">\n                <p><strong>Product Name:</strong> ${n.name}</p>\n                <p><strong>Category:</strong> ${n.category}</p>\n                <p><strong>Brand:</strong> ${n.brand}</p>\n                <p><strong>Price:</strong> $${n.price.toFixed(2)}</p>\n                <p><strong>Stock Quantity:</strong> ${n.stock_quantity}</p>\n                <p><strong>Average Rating:</strong> ${n.averageRating.toFixed(1)} (${n.totalReviews} reviews)</p>\n            </div>\n\n            <p>If this deletion was a mistake or if you have any further questions, please don't hesitate to contact our support team.</p>\n            \n            <a href="mailto:azaz123456az4@gmail.com" class="button">Contact Support</a>\n\n            <p>Thank you for using our platform to manage your shop inventory.</p>\n            \n            <p>Best regards,<br><strong>Your E-commerce Application Team</strong></p>\n        </div>\n        <div class="footer">\n            <p>This email was sent to ${t.email} because you deleted a product from your shop on our platform.</p>\n            <p>&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n        </div>\n    </div>\n</body>\n</html>\n    `};o.sendMail(i,((e,t)=>{e?console.log(e.message):console.log("Product deletion confirmation email sent successfully.")}))}},8611:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:t.email,subject:"Product Freeze Confirmation",text:`Dear ${e.name},\n\nWe are writing to confirm that your product "${n.name}" has been successfully frozen. It will no longer appear to customers or be available for purchase.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n      <div style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; font-size:1rem;">\n        <div style="max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 5px;">\n          <h2 style="text-align: center; color: #dc3545;">Product Freeze Confirmation</h2>\n          <p>Dear ${e.name},</p>\n          <p>We are writing to confirm that your product "<strong>${n.name}</strong>" has been successfully frozen. It will no longer appear to customers or be available for purchase.</p>\n          <p>If this was a mistake or if you have any further questions, please do not hesitate to <a href="mailto:azaz123456az4@gmail.com" style="color: #007BFF;">contact us</a>.</p>\n          <p>Best regards,</p>\n          <p><strong>Your E-commerce Application Team</strong></p>\n        </div>\n        <div style="text-align: center; margin-top: 20px;">\n          <p style="font-size: 12px; color: #888;">This email was sent to ${t.email} because you froze a product in your shop on our platform.</p>\n          <p style="font-size: 12px; color: #888;">&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n        </div>\n      </div>\n    `};o.sendMail(i,((e,t)=>{e?console.log(e.message):console.log("Product freeze confirmation email sent successfully.")}))}},332:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:t.email,subject:"Product Unfreeze Confirmation",text:`Dear ${e.name},\n\nWe are writing to confirm that your product "${n.name}" has been successfully unfrozen. It is now visible to customers and available for purchase.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n      <div style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; font-size:1rem;">\n        <div style="max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 5px;">\n          <h2 style="text-align: center; color: #28a745;">Product Unfreeze Confirmation</h2>\n          <p>Dear ${e.name},</p>\n          <p>We are writing to confirm that your product "<strong>${n.name}</strong>" has been successfully unfrozen. It is now visible to customers and available for purchase.</p>\n          <p>If you have any questions or need further assistance, please do not hesitate to <a href="mailto:azaz123456az4@gmail.com" style="color: #007BFF;">contact us</a>.</p>\n          <p>Best regards,</p>\n          <p><strong>Your E-commerce Application Team</strong></p>\n        </div>\n        <div style="text-align: center; margin-top: 20px;">\n          <p style="font-size: 12px; color: #888;">This email was sent to ${t.email} because you unfroze a product in your shop on our platform.</p>\n          <p style="font-size: 12px; color: #888;">&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n        </div>\n      </div>\n    `};o.sendMail(i,((e,t)=>{e?console.log(e.message):console.log("Product unfreeze confirmation email sent successfully.")}))}},502:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:t.email,subject:"Product Update Confirmation",text:`Dear ${e.name},\n\nWe are writing to confirm that your product "${n.name}" has been successfully updated in your shop. The changes are now visible to customers.\n\nBest regards,\nYour E-commerce Application Team`,html:`\n      <div style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; font-size:1rem;">\n        <div style="max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 5px;">\n          <h2 style="text-align: center; color: #ffc107;">Product Update Confirmation</h2>\n          <p>Dear ${e.name},</p>\n          <p>We are writing to confirm that your product "<strong>${n.name}</strong>" has been successfully updated in your shop. The changes are now visible to customers.</p>\n          <p>If you have any questions or need further assistance, please do not hesitate to <a href="mailto:azaz123456az4@gmail.com" style="color: #007BFF;">contact us</a>.</p>\n          <p>Best regards,</p>\n          <p><strong>Your E-commerce Application Team</strong></p>\n        </div>\n        <div style="text-align: center; margin-top: 20px;">\n          <p style="font-size: 12px; color: #888;">This email was sent to ${t.email} because you updated a product in your shop on our platform.</p>\n          <p style="font-size: 12px; color: #888;">&copy; ${(new Date).getFullYear()} Your E-commerce Application. All rights reserved.</p>\n        </div>\n      </div>\n    `};o.sendMail(i,((e,t)=>{e?console.log(e.message):console.log("Product update confirmation email sent successfully.")}))}},5799:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=e=>{const t=(0,r.default)(),n={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Please Verify Your Email Address",html:`\n      <div style="font-family: Arial, sans-serif; color: #333; line-height: 1.6; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #e0e0e0; border-radius: 8px;">\n        <main>\n          <h2 style="color: #333; font-size: 24px; text-align: center;">Welcome to Our E-commerce Application, ${e.name}!</h2>\n          <p style="font-size: 16px; text-align: center; color: #666;">Thank you for registering with us. Please confirm your email address by clicking the button below:</p>\n          <p style="text-align: center;">\n            <a href="http://127.0.0.1:3000/api/v1/auth/verify-email/${e.emailVerificationToken}" \n              style="display: inline-block; padding: 12px 24px; font-size: 16px; color: #fff; background-color: #4CAF50; text-decoration: none; border-radius: 5px; margin-top: 20px;">\n              Verify Your Email\n            </a>\n          </p>\n          <p style="font-size: 14px; color: #999; text-align: center; margin-top: 20px;">If you did not create an account, please disregard this email.</p>\n        </main>\n        <footer style="text-align: center; margin-top: 30px;">\n          <hr style="border: 0; border-top: 1px solid #e0e0e0; margin-bottom: 10px;">\n          <p style="font-size: 14px; color: #999;">Visit our website: \n            <a href="http://your-ecommerce-website.com" style="color: #4CAF50; text-decoration: none;">E-commerce Application</a>\n          </p>\n        </footer>\n      </div>\n    `};t.sendMail(n,((e,t)=>{e?console.log(e.message):console.log("Verification email sent")}))}},4676:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your Order has been Cancelled",html:`\n<div style="font-family: 'Helvetica Neue', Arial, sans-serif; color: #333; line-height: 1.6; font-size: 16px; background-color: #f8f0f0; padding: 20px 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="color: #E74C3C; font-size: 28px; margin-bottom: 20px;">Hello ${e.name},</h2>\n    <p style="margin-bottom: 20px;">We are writing to confirm that your order with ID <strong style="color: #E74C3C; background-color: #fde9e8; padding: 2px 5px; border-radius: 3px;">${t._id}</strong> has been successfully cancelled.</p>\n\n    <div style="background-color: #fde9e8; border-radius: 8px; padding: 20px; margin-bottom: 30px;">\n      <h3 style="color: #E74C3C; margin-top: 0;">Cancellation Details:</h3>\n      <table style="width: 100%; border-collapse: separate; border-spacing: 0 10px;">\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Order Status:</td>\n          <td style="padding: 5px 10px;">Cancelled</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Cancellation Date:</td>\n          <td style="padding: 5px 10px;">${(new Date).toLocaleString()}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Payment Method:</td>\n          <td style="padding: 5px 10px;">${t.paymentMethod}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Payment Status:</td>\n          <td style="padding: 5px 10px;">${t.paymentStatus}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Shipping Address:</td>\n          <td style="padding: 5px 10px;">${t.shippingAddress}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Phone Number:</td>\n          <td style="padding: 5px 10px;">${t.phoneNumber}</td>\n        </tr>\n      </table>\n    </div>\n\n    <div style="margin-bottom: 30px;">\n      <h3 style="color: #E74C3C;">Cancelled Order Summary:</h3>\n      <table style="width: 100%; border-collapse: collapse;">\n        <tr style="background-color: #fde9e8;">\n          <th style="padding: 10px; text-align: left; border-bottom: 2px solid #E74C3C;">Item</th>\n          <th style="padding: 10px; text-align: right; border-bottom: 2px solid #E74C3C;">Quantity</th>\n          <th style="padding: 10px; text-align: right; border-bottom: 2px solid #E74C3C;">Price</th>\n        </tr>\n        ${t.items.map((e=>`\n          <tr>\n            <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">${e.product.name}</td>\n            <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">${e.quantity}</td>\n            <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">$${e.priceAfterDiscount.toFixed(2)}</td>\n          </tr>\n        `)).join("")}\n      </table>\n    </div>\n\n    <div style="margin-bottom: 30px;">\n      <h3 style="color: #E74C3C;">Financial Summary:</h3>\n      <table style="width: 100%; border-collapse: collapse;">\n        <tr style="background-color: #fde9e8;">\n          <th style="padding: 10px; text-align: left; border-bottom: 2px solid #E74C3C;">Description</th>\n          <th style="padding: 10px; text-align: right; border-bottom: 2px solid #E74C3C;">Amount</th>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Subtotal</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">$${t.totalPrice.toFixed(2)}</td>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Shipping Cost</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">$${t.shippingCost.toFixed(2)}</td>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Tax Amount</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">$${t.taxAmount.toFixed(2)}</td>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Total Discount</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">-$${t.totalDiscount.toFixed(2)}</td>\n        </tr>\n        <tr style="background-color: #fde9e8; font-weight: bold;">\n          <td style="padding: 10px; color: #E74C3C;">Total Cancelled</td>\n          <td style="padding: 10px; text-align: right; color: #E74C3C;">$${(t.totalPrice+t.shippingCost+t.taxAmount-t.totalDiscount).toFixed(2)}</td>\n        </tr>\n      </table>\n    </div>\n\n    <p>If you have any questions about this cancellation or need further assistance, please do not hesitate to contact our customer support team.</p>\n\n    <div style="background-color: #f5f5f5; border-radius: 4px; padding: 15px; margin-top: 30px;">\n      <p style="margin: 0; font-weight: bold;">Need help?</p>\n      <p style="margin: 10px 0 0;">Email us at <a href="mailto:support@ecommerceapp.com" style="color: #E74C3C; text-decoration: none; border-bottom: 1px solid #E74C3C;">support@ecommerceapp.com</a></p>\n    </div>\n\n    <p style="margin-top: 30px; margin-bottom: 0;">Best regards,</p>\n    <p style="margin-top: 5px;"><strong>E-commerce Application Team</strong></p>\n\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</div>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Cancellation confirmation email sent")}))}},9320:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o=t.items.map((e=>`\n      <tr>\n        <td data-label="Item">${e.product.name}</td>\n        <td data-label="Quantity">${e.quantity}</td>\n        <td data-label="Price">$${e.priceAfterDiscount.toFixed(2)}</td>\n      </tr>\n    `)).join(""),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Order Confirmation",html:`\n      <!DOCTYPE html>\n      <html lang="en">\n      <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Order Confirmation</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 600px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        .header {\n            background-color: #4CAF50;\n            color: white;\n            padding: 20px;\n            text-align: center;\n        }\n        .content {\n            padding: 20px;\n            background-color: #f9f9f9;\n        }\n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-bottom: 20px;\n        }\n        th, td {\n            padding: 10px;\n            border: 1px solid #ddd;\n            text-align: left;\n        }\n        th {\n            background-color: #f2f2f2;\n        }\n        .footer {\n            text-align: center;\n            margin-top: 20px;\n            padding: 10px;\n            background-color: #f2f2f2;\n        }\n        @media only screen and (max-width: 600px) {\n            table, tr, td {\n                display: block;\n            }\n            tr {\n                margin-bottom: 10px;\n            }\n            td {\n                border: none;\n                position: relative;\n                padding-left: 50%;\n            }\n            td:before {\n                content: attr(data-label);\n                position: absolute;\n                left: 6px;\n                width: 45%;\n                padding-right: 10px;\n                white-space: nowrap;\n                font-weight: bold;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class="header">\n        <h1>Order Confirmation</h1>\n    </div>\n    <div class="content">\n        <h2>Hello ${e.name},</h2>\n        <p>Thank you for your order. Here are the details:</p>\n        \n        <table>\n            <tr>\n                <th>Order ID</th>\n                <td data-label="Order ID">${t._id}</td>\n            </tr>\n            <tr>\n                <th>Order Date</th>\n                <td data-label="Order Date">${new Date(t.createdAt).toLocaleDateString()}</td>\n            </tr>\n            <tr>\n                <th>Order Status</th>\n                <td data-label="Order Status">${t.orderStatus}</td>\n            </tr>\n        </table>\n\n        <h3>Order Summary</h3>\n        <table>\n            <thead>\n                <tr>\n                    <th>Item</th>\n                    <th>Quantity</th>\n                    <th>Price</th>\n                </tr>\n            </thead>\n            <tbody>\n                ${t.items.map((e=>`\n                <tr>\n                    <td data-label="Item">${e.product.name}</td>\n                    <td data-label="Quantity">${e.quantity}</td>\n                    <td data-label="Price">$${e.priceAfterDiscount.toFixed(2)}</td>\n                </tr>\n                `)).join("")}\n            </tbody>\n        </table>\n        \n        <h3>Order Totals</h3>\n        <table>\n            <tr>\n                <th>Subtotal</th>\n                <td data-label="Subtotal">$${(t.totalPrice-t.shippingCost-t.taxAmount).toFixed(2)}</td>\n            </tr>\n            <tr>\n                <th>Shipping</th>\n                <td data-label="Shipping">$${t.shippingCost.toFixed(2)}</td>\n            </tr>\n            <tr>\n                <th>Tax</th>\n                <td data-label="Tax">$${t.taxAmount.toFixed(2)}</td>\n            </tr>\n            <tr>\n                <th>Total</th>\n                <td data-label="Total">$${t.totalPrice.toFixed(2)}</td>\n            </tr>\n        </table>\n\n        <h3>Shipping Information</h3>\n        <table>\n            <tr>\n                <th>Address</th>\n                <td data-label="Address">${t.shippingAddress}</td>\n            </tr>\n            <tr>\n                <th>Estimated Delivery</th>\n                <td data-label="Estimated Delivery">${t.estimatedDeliveryDate?new Date(t.estimatedDeliveryDate).toLocaleDateString():"N/A"}</td>\n            </tr>\n        </table>\n\n        ${e.isPrimeUser?"<p>Thank you for being a Prime member!</p>":""}\n        \n        <p>If you have any questions, please contact our support team.</p>\n    </div>\n    <div class="footer">\n        <p>Best regards,<br>E-commerce Application Team</p>\n    </div>\n</body>\n</html>\n      </html>\n    `.replace("${orderItemsHTML}",o)};n.sendMail(i,((e,t)=>{e?console.log(e.message):console.log("Order confirmation email sent")}))}},4485:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your Refund Request has been Created",html:`\n      <div style="font-family: 'Helvetica Neue', Arial, sans-serif; color: #333; line-height: 1.6; font-size: 16px; background-color: #f0f4f8; padding: 20px 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="color: #3498db; font-size: 28px; margin-bottom: 20px; text-align: center;">Refund Request Confirmation</h2>\n    <p>Hello ${e.name},</p>\n    <p>We are writing to confirm that your refund request has been successfully created. Here are the details of your request:</p>\n\n    <div style="background-color: #e8f4fd; border-radius: 8px; padding: 20px; margin: 20px 0;">\n      <h3 style="color: #2980b9; margin-top: 0;">Refund Request Details:</h3>\n      <table style="width: 100%; border-collapse: separate; border-spacing: 0 10px;">\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Request ID:</td>\n          <td style="padding: 5px 10px;">${t._id}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Order ID:</td>\n          <td style="padding: 5px 10px;">${t.order}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Refund Status:</td>\n          <td style="padding: 5px 10px;">${t.refundStatus}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Refund Type:</td>\n          <td style="padding: 5px 10px;">${t.refundType}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Refund Method:</td>\n          <td style="padding: 5px 10px;">${t.refundMethod}</td>\n        </tr>\n      </table>\n    </div>\n\n    <div style="margin-bottom: 30px;">\n      <h3 style="color: #2980b9;">Financial Summary:</h3>\n      <table style="width: 100%; border-collapse: collapse;">\n        <tr style="background-color: #e8f4fd;">\n          <th style="padding: 10px; text-align: left; border-bottom: 2px solid #3498db;">Description</th>\n          <th style="padding: 10px; text-align: right; border-bottom: 2px solid #3498db;">Amount</th>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Refund Amount</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0; font-weight: bold;">$${t.refundAmount.toFixed(2)}</td>\n        </tr>\n      </table>\n    </div>\n\n    <p>We will process your request shortly and keep you updated on its status. Please allow 5-10 business days for the refund to be processed and reflected in your account.</p>\n\n    <p>If you have any questions or need further assistance, please do not hesitate to contact our customer support team.</p>\n\n    <div style="background-color: #f5f7fa; border-radius: 4px; padding: 15px; margin-top: 30px;">\n      <p style="margin: 0; font-weight: bold;">Need help?</p>\n      <p style="margin: 10px 0 0;">Email us at <a href="mailto:support@ecommerceapp.com" style="color: #3498db; text-decoration: none; border-bottom: 1px solid #3498db;">support@ecommerceapp.com</a></p>\n    </div>\n\n    <p style="margin-top: 30px; margin-bottom: 0;">Best regards,</p>\n    <p style="margin-top: 5px;"><strong>E-commerce Application Team</strong></p>\n\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</div>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Refund request creation email sent")}))}},6538:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your Refund Request has been Created",html:`\n    <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Return and Refund Request Confirmation</title>\n</head>\n<body style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; background-color: #f4f4f4; margin: 0; padding: 0;">\n    <div style="max-width: 600px; margin: 20px auto; background-color: #ffffff; border-radius: 8px; overflow: hidden; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);">\n        <div style="background-color: #2c3e50; color: #ffffff; padding: 20px; text-align: center;">\n            <h2 style="margin: 0; font-size: 24px;">Return and Refund Request Confirmation</h2>\n        </div>\n        <div style="padding: 30px;">\n            <p>Dear ${e.name},</p>\n            <p>We have received your return and refund request. Below are the details of your request:</p>\n            \n            <div style="background-color: #f9f9f9; border: 1px solid #e0e0e0; border-radius: 5px; padding: 15px; margin-top: 20px;">\n                <h3 style="margin-top: 0; color: #2c3e50;">Refund Request Details</h3>\n                <table style="width: 100%; border-collapse: collapse;">\n                    <tr>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Request ID:</strong></td>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">${t._id}</td>\n                    </tr>\n                    <tr>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Order ID:</strong></td>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">${t.order}</td>\n                    </tr>\n                    <tr>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Refund Amount:</strong></td>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">$${t.refundAmount.toFixed(2)}</td>\n                    </tr>\n                    <tr>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Refund Method:</strong></td>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">${t.refundMethod}</td>\n                    </tr>\n                    <tr>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Refund Type:</strong></td>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">${t.refundType}</td>\n                    </tr>\n                    <tr>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Refund Status:</strong></td>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">${t.refundStatus}</td>\n                    </tr>\n                    <tr>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Request Date:</strong></td>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">${t.createdAt.toDateString()}</td>\n                    </tr>\n                    ${t.refundProcessedAt?`\n                    <tr>\n                        <td style="padding: 8px;"><strong>Processed Date:</strong></td>\n                        <td style="padding: 8px;">${t.refundProcessedAt.toDateString()}</td>\n                    </tr>\n                    `:""}\n                </table>\n            </div>\n            \n            <div style="background-color: #f9f9f9; border: 1px solid #e0e0e0; border-radius: 5px; padding: 15px; margin-top: 20px;">\n                <h3 style="margin-top: 0; color: #2c3e50;">Returned Item Details</h3>\n                <table style="width: 100%; border-collapse: collapse;">\n                    <tr>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Return Request ID:</strong></td>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">${n._id}</td>\n                    </tr>\n                    <tr>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Product:</strong></td>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">${n.product.name}</td>\n                    </tr>\n                    <tr>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Quantity:</strong></td>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">${n.quantity}</td>\n                    </tr>\n                    <tr>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Return Reason:</strong></td>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">${n.returnReason}</td>\n                    </tr>\n                    <tr>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;"><strong>Return Status:</strong></td>\n                        <td style="padding: 8px; border-bottom: 1px solid #e0e0e0;">${n.returnStatus}</td>\n                    </tr>\n                    <tr>\n                        <td style="padding: 8px;"><strong>Received Items Status:</strong></td>\n                        <td style="padding: 8px;">${n.receivedItemsStatus}</td>\n                    </tr>\n                </table>\n            </div>\n            \n            <p style="margin-top: 20px;"><strong>Next Steps:</strong></p>\n            <ol style="margin-left: 20px; padding-left: 0;">\n                <li>Please package the item(s) securely in their original packaging, if possible.</li>\n                <li>Include a copy of this return request or the order number in the package.</li>\n                <li>Once we receive and inspect your return, we'll process the refund to your original payment method.</li>\n            </ol>\n            \n            <p>Please note that the refund process may take 5-10 business days, depending on your bank or credit card issuer.</p>\n            \n            <p>If you have any questions or need further assistance, please don't hesitate to contact our customer support team:</p>\n            <p style="margin-left: 20px;">\n                Email: <a href="mailto:zz0a12345az@gmail.com" style="color: #2c3e50;">zz0a12345az@gmail.com</a><br>\n                Phone: +20 12345678910\n            </p>\n        </div>\n        <div style="background-color: #34495e; color: #ffffff; padding: 20px; text-align: center; font-size: 14px;">\n            <p>Thank you for your patience and understanding.<br><strong>E-commerce Application Customer Service Team</strong></p>\n            <p style="margin-top: 10px; font-size: 12px;">&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n            <p style="font-size: 12px;">Email sent on: ${(new Date).toLocaleString()}</p>\n        </div>\n    </div>\n</body>\n</html>\n    `};o.sendMail(i,((e,t)=>{e?console.log(e.message):console.log("Refund request creation email sent")}))}},6637:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Reset Your Password",html:`\n      <div style="font-family: Arial, sans-serif; color: #333; line-height: 1.6; max-width: 600px; margin: auto; padding: 20px; border: 1px solid #ddd; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);">\n        <h2 style="color: #4CAF50;">Hello ${e.name},</h2>\n        <p>We received a request to reset your password for your account. Click the button below to reset your password:</p>\n        <p style="text-align: center;">\n          <a href="http://127.0.0.1:3000/api/v1/auth/reset-password/${t}" \n             style="display: inline-block; padding: 15px 30px; font-size: 16px; color: #fff; background-color: #4CAF50; text-decoration: none; border-radius: 5px; margin-top: 20px;">\n            Reset Password\n          </a>\n        </p>\n        <p>If you did not request a password reset, please ignore this email or reply to let us know. This password reset link is only valid for the next 60 minutes.</p>\n        <p style="margin-top: 20px;">Best regards,<br>E-commerce Application Team</p>\n        <hr style="border: none; border-top: 1px solid #ddd; margin: 20px 0;">\n        <p style="font-size: 12px; color: #777; text-align: center;">If you're having trouble clicking the "Reset Password" button, copy and paste the URL below into your web browser: <a href="http://127.0.0.1:3000/api/v1/auth/reset-password/${t}" style="color: #4CAF50;">http://127.0.0.1:3000/api/v1/auth/reset-password/${t}</a></p>\n      </div>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("Reset password email sent")}))}},7176:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your return product request has been created",html:`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Return Request Cancellation Confirmation</title>\n</head>\n<body style="font-family: 'Helvetica Neue', Arial, sans-serif; color: #333; line-height: 1.6; font-size: 16px; background-color: #f0f4f8; padding: 20px 0; margin: 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="color: #16a085; font-size: 28px; margin-bottom: 20px; text-align: center;">Return Request Cancellation Confirmed</h2>\n    <p>Hello ${e.name||"Valued Customer"},</p>\n    <p>We are writing to confirm that your return request has been successfully cancelled as per your request. Here are the details of the cancelled return:</p>\n    <div style="background-color: #e8f6f3; border-radius: 8px; padding: 20px; margin: 20px 0;">\n      <h3 style="color: #1abc9c; margin-top: 0;">Cancelled Return Request Details:</h3>\n      <table style="width: 100%; border-collapse: separate; border-spacing: 0 10px;">\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Request ID:</td>\n          <td style="padding: 5px 10px; word-break: break-all;">${t._id||"N/A"}</td>\n        </tr>\n       \n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Original Return Status:</td>\n          <td style="padding: 5px 10px;">${t.returnStatus||"N/A"}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">New Status:</td>\n          <td style="padding: 5px 10px; font-weight: bold;">Cancelled</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Cancellation Date:</td>\n          <td style="padding: 5px 10px;">${(new Date).toLocaleDateString()}</td>\n        </tr>\n      </table>\n    </div>\n    <div style="margin-bottom: 30px;">\n      <h3 style="color: #1abc9c;">Product Details:</h3>\n      <table style="width: 100%; border-collapse: collapse;">\n        <tr style="background-color: #e8f6f3;">\n          <th style="padding: 10px; text-align: left; border-bottom: 2px solid #16a085;">Description</th>\n          <th style="padding: 10px; text-align: right; border-bottom: 2px solid #16a085;">Details</th>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Product Name</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">${t.product&&t.product.name?t.product.name:"N/A"}</td>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Quantity</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">${t.quantity||"N/A"}</td>\n        </tr>\n      </table>\n    </div>\n    <p>Please note the following:</p>\n    <ul>\n      <li>Your return request has been cancelled and will not be processed further.</li>\n      <li>If you still wish to return the item in the future, you will need to submit a new return request.</li>\n      <li>The original order remains valid and no refund will be issued.</li>\n    </ul>\n    <p>If you did not request this cancellation or if you have any questions, please contact our customer support team immediately.</p>\n    <div style="background-color: #f5f7fa; border-radius: 4px; padding: 15px; margin-top: 30px;">\n      <p style="margin: 0; font-weight: bold;">Need help?</p>\n      <p style="margin: 10px 0 0;">Email us at <a href="mailto:zz0a12345az@gmail.com" style="color: #16a085; text-decoration: none; border-bottom: 1px solid #16a085;">support@ecommerceapp.com</a></p>\n    </div>\n    <p style="margin-top: 30px; margin-bottom: 0;">Best regards,</p>\n    <p style="margin-top: 5px;"><strong>E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</body>\n</html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("return product request  cancellation confirmation email sent")}))}},4880:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your return product request has been created",html:`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Return Request Confirmation</title>\n</head>\n<body style="font-family: 'Helvetica Neue', Arial, sans-serif; color: #333; line-height: 1.6; font-size: 16px; background-color: #f0f4f8; padding: 20px 0; margin: 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="color: #3498db; font-size: 28px; margin-bottom: 20px; text-align: center;">Return Request Confirmation</h2>\n    <p>Hello ${e.name},</p>\n    <p>We are writing to confirm that your return request has been successfully created. Here are the details of your request:</p>\n    <div style="background-color: #e8f4fd; border-radius: 8px; padding: 20px; margin: 20px 0;">\n      <h3 style="color: #2980b9; margin-top: 0;">Return Request Details:</h3>\n      <table style="width: 100%; border-collapse: separate; border-spacing: 0 10px;">\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Request ID:</td>\n          <td style="padding: 5px 10px;">${t._id}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Order ID:</td>\n          <td style="padding: 5px 10px;">${t.order}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Return Status:</td>\n          <td style="padding: 5px 10px;">${t.returnStatus}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Received Items Status:</td>\n          <td style="padding: 5px 10px;">${t.receivedItemsStatus}</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Return Reason:</td>\n          <td style="padding: 5px 10px;">${t.returnReason}</td>\n        </tr>\n      </table>\n    </div>\n    <div style="margin-bottom: 30px;">\n      <h3 style="color: #2980b9;">Product Details:</h3>\n      <table style="width: 100%; border-collapse: collapse;">\n        <tr style="background-color: #e8f4fd;">\n          <th style="padding: 10px; text-align: left; border-bottom: 2px solid #3498db;">Description</th>\n          <th style="padding: 10px; text-align: right; border-bottom: 2px solid #3498db;">Details</th>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Product Name</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">${t.product.name}</td>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Quantity</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">${t.quantity}</td>\n        </tr>\n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Refund Amount</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0; font-weight: bold;">$${t.refundAmount.toFixed(2)}</td>\n        </tr>\n      </table>\n    </div>\n    <p>We will process your return request shortly and keep you updated on its status. Please note the following:</p>\n    <ul>\n      <li>Your return request is currently in <strong>${t.returnStatus}</strong> status.</li>\n      <li>The received items status is set to <strong>${t.receivedItemsStatus}</strong>.</li>\n      <li>Our team will review your request and update you on any changes.</li>\n      <li>If approved, please follow the return instructions that will be provided.</li>\n    </ul>\n    <p>If you have any questions or need further assistance, please do not hesitate to contact our customer support team.</p>\n    <div style="background-color: #f5f7fa; border-radius: 4px; padding: 15px; margin-top: 30px;">\n      <p style="margin: 0; font-weight: bold;">Need help?</p>\n      <p style="margin: 10px 0 0;">Email us at <a href="mailto:support@ecommerceapp.com" style="color: #3498db; text-decoration: none; border-bottom: 1px solid #3498db;">support@ecommerceapp.com</a></p>\n    </div>\n    <p style="margin-top: 30px; margin-bottom: 0;">Best regards,</p>\n    <p style="margin-top: 5px;"><strong>E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</body>\n</html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("return product request confirmation email sent")}))}},3848:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t)=>{const n=(0,r.default)(),o={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:"Your return product request has been created",html:`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Return Request Rejection Notification</title>\n</head>\n<body style="font-family: 'Helvetica Neue', Arial, sans-serif; color: #333; line-height: 1.6; font-size: 16px; background-color: #f0f4f8; padding: 20px 0; margin: 0;">\n  <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">\n    <h2 style="color: #d35400; font-size: 28px; margin-bottom: 20px; text-align: center;">Return Request Rejected</h2>\n    <p>Dear ${e.name||"Valued Customer"},</p>\n    <p>We regret to inform you that your return request has been rejected. We understand this may be disappointing, and we want to provide you with the details of this decision.</p>\n    <div style="background-color: #fdf2e9; border-radius: 8px; padding: 20px; margin: 20px 0;">\n      <h3 style="color: #e67e22; margin-top: 0;">Return Request Details:</h3>\n      <table style="width: 100%; border-collapse: separate; border-spacing: 0 10px;">\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Request ID:</td>\n          <td style="padding: 5px 10px; word-break: break-all;">${t._id||"N/A"}</td>\n        </tr>\n        \n          <td style="padding: 5px 10px; font-weight: bold;">Return Status:</td>\n          <td style="padding: 5px 10px; font-weight: bold;">Rejected</td>\n        </tr>\n        <tr>\n          <td style="padding: 5px 10px; font-weight: bold;">Rejection Date:</td>\n          <td style="padding: 5px 10px;">${(new Date).toLocaleDateString()}</td>\n        </tr>\n      </table>\n    </div>\n    <div style="margin-bottom: 30px;">\n      <h3 style="color: #e67e22;">Product Details:</h3>\n      <table style="width: 100%; border-collapse: collapse;">\n        <tr style="background-color: #fdf2e9;">\n          <th style="padding: 10px; text-align: left; border-bottom: 2px solid #d35400;">Description</th>\n          <th style="padding: 10px; text-align: right; border-bottom: 2px solid #d35400;">Details</th>\n        </tr>\n       \n        <tr>\n          <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">Quantity</td>\n          <td style="padding: 10px; text-align: right; border-bottom: 1px solid #e0e0e0;">${t.quantity||"N/A"}</td>\n        </tr>\n      </table>\n    </div>\n    <div style="background-color: #fdf2e9; border-radius: 8px; padding: 20px; margin: 20px 0;">\n      <h3 style="color: #e67e22; margin-top: 0;">Reason for Rejection:</h3>\n      <p style="margin-bottom: 0;">${t.rejectionReason||"The return request does not meet our return policy requirements. For more details, please refer to our return policy or contact our customer support."}</p>\n    </div>\n    <p>If you believe this decision was made in error or if you need further clarification, please don't hesitate to contact our customer support team. We're here to assist you and address any concerns you may have.</p>\n    <div style="background-color: #f5f7fa; border-radius: 4px; padding: 15px; margin-top: 30px;">\n      <p style="margin: 0; font-weight: bold;">Need assistance?</p>\n      <p style="margin: 10px 0 0;">Contact our customer support team at <a href="mailto:zz0a123456az@gmail.com" style="color: #d35400; text-decoration: none; border-bottom: 1px solid #d35400;">support@ecommerceapp.com</a> or call us at (123) 456789.</p>\n    </div>\n    <p style="margin-top: 30px; margin-bottom: 0;">We appreciate your understanding and value your business.</p>\n    <p style="margin-top: 5px;">Sincerely,</p>\n    <p style="margin-top: 5px;"><strong>E-commerce Application Team</strong></p>\n    <div style="border-top: 1px solid #e0e0e0; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 14px; color: #777;">\n      <p>&copy; ${(new Date).getFullYear()} E-commerce Application. All rights reserved.</p>\n    </div>\n  </div>\n</body>\n</html>\n    `};n.sendMail(o,((e,t)=>{e?console.log(e.message):console.log("return product request  reject  confirmation email sent")}))}},2316:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(6634));t.default=(e,t,n)=>{const o=(0,r.default)(),i={from:"E-commerce Application <azaz123456az4@gmail.com>",to:e.email,subject:`Response to Your Support Ticket [Ticket ID: ${t._id}]`,html:`\n      <div style="font-family: Arial, sans-serif; color: #333; line-height: 1.6;">\n        <div style="padding: 20px; border: 1px solid #ddd; border-radius: 5px; max-width: 600px; margin: auto; background-color: #f9f9f9;">\n          <h2 style="color: #3498DB; text-align: center;">Hello ${e.name},</h2>\n          <p style="font-size: 16px;">Thank you for reaching out to us. We have reviewed your support ticket and are happy to assist you with your inquiry.</p>\n          <div style="padding: 10px; background-color: #fff; border: 1px solid #ddd; border-radius: 5px; margin-top: 10px;">\n            <p style="font-size: 16px;"><strong>Support Ticket Details:</strong></p>\n            <ul style="list-style-type: none; padding: 0;">\n              <li style="padding: 5px 0;"><strong>Ticket ID:</strong> ${t._id}</li>\n              <li style="padding: 5px 0;"><strong>Submitted On:</strong> ${t.createdAt}</li>\n              <li style="padding: 5px 0;"><strong>Subject:</strong> ${t.subject}</li>\n            </ul>\n          </div>\n          <div style="padding: 10px; background-color: #fff; border: 1px solid #ddd; border-radius: 5px; margin-top: 10px;">\n            <p style="font-size: 16px;"><strong>Our Response:</strong></p>\n            <p style="font-size: 16px;">${n}</p>\n          </div>\n          <p style="font-size: 16px;">If you have any further questions or need additional assistance, please feel free to reply to this email or contact our support team directly.</p>\n          <p style="margin-top: 20px; font-size: 16px;">Thank you for your patience and understanding.</p>\n          <p style="margin-top: 20px; font-size: 16px;">Best regards,<br><strong>E-commerce Application Team</strong></p>\n        </div>\n      </div>\n    `};o.sendMail(i,((e,t)=>{e?console.log(e.message):console.log("Support ticket response email sent")}))}},8156:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(1859)),i=o(n(6037)),d=n(1416),s=n(992),a=n(2492),u=n(8839),l=n(5828),c=(0,s.createServer)(r.default);d.v2.config({cloud_name:u.cloudConfig.CLOUD_NAME,api_key:u.cloudConfig.API_KEY,api_secret:u.cloudConfig.API_SECRET}),i.default.connect(l.DB).then((()=>{console.log("Database is connected")})),(0,a.initializeSocket)(c),c.listen(l.PORT,(()=>{console.log(`Server is running on http://localhost:${l.PORT}`)}))},5265:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.startShopsCronJobs=void 0;const i=r(n(2703)),d=r(n(5061)),s=n(3742);t.startShopsCronJobs=()=>{i.default.schedule("0 0 1 * *",(()=>o(void 0,void 0,void 0,(function*(){console.log("Running monthly shop analytics report generation for all shops");try{const e=yield d.default.find({}),t=new Date,n=new Date(t.getFullYear(),t.getMonth()-1,1),o=new Date(n.getFullYear(),n.getMonth(),1),r=new Date(t.getFullYear(),t.getMonth(),0,23,59,59);for(const t of e)try{console.log(`Generating report for shop: ${t.shopName}`),yield(0,s.createShopAnalyticsReport)({params:{shopId:t._id.toString()},query:{startDate:o.toISOString(),endDate:r.toISOString()}},null,(e=>{e&&console.error(`Error generating report for shop ${t.shopName}:`,e)})),console.log(`Finished generating report for shop: ${t.shopName}`)}catch(e){console.error(`Error processing shop ${t.shopName}:`,e)}console.log("Finished generating monthly reports for all shops")}catch(e){console.error("Error in cron job for generating monthly shop reports:",e)}}))),{scheduled:!0,timezone:"UTC"})}},1096:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.startWebsiteCronJobs=void 0;const i=r(n(2703)),d=n(5460);t.startWebsiteCronJobs=()=>{i.default.schedule("0 0 1 * *",(()=>o(void 0,void 0,void 0,(function*(){console.log("Running website analytics report generation");try{const e=new Date,t=new Date(e.getTime()-6e4);console.log("Generating website analytics report"),yield(0,d.createWebsiteAnalyticsReport)({query:{startDate:t.toISOString(),endDate:e.toISOString()}},null,(e=>{e?console.error("Error generating website analytics report:",e):console.log("Successfully generated and sent website analytics report")}))}catch(e){console.error("Error in cron job for generating website analytics report:",e)}}))),{scheduled:!0,timezone:"UTC"})}},1675:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.restrictTo=t.protect=void 0;const i=r(n(2489)),d=r(n(4960)),s=r(n(829)),a=r(n(2819));t.protect=(0,i.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){let t="";if(e.headers.authorization&&e.headers.authorization.startsWith("Bearer")&&(t=e.headers.authorization.split(" ")[1]),!t)return n(new d.default("You are not logged in! Please log in",401));const o=s.default.verify(t,process.env.JWT_SECRET),r=yield a.default.findById(o.id);return r?!1===r.active?n(new d.default("Your account has been activated please contact support for more information.",401)):(e.user=r,void n()):n(new d.default("The user belonging to this token no longer exists",401))})))),t.restrictTo=(...e)=>(t,n,o)=>{if(!t.user||!e.includes(t.user.role))return o(new d.default("You do not have permission to perform this action",403));o()}},8979:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.checkCartAvailability=void 0;const i=r(n(1573)),d=r(n(4960)),s=r(n(2489));t.checkCartAvailability=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const[t,r]=(e=>{if(!e.user.active||!e.user.verified)throw new d.default("User not active or not verified",403);const t=e.user.shippingAddress||e.body.shippingAddress;if(!t)throw new d.default("Please provide a shipping address or add shipping address to your profile ",400);const n=e.user.phoneNumber||e.body.phoneNumber;if(!n)throw new d.default("Please provide a phone number or add phone number to your profile ",400);return[t,n]})(e),s=yield(a=e.user,o(void 0,void 0,void 0,(function*(){const e=yield i.default.findById(a.shoppingCart);if(!e){const e=yield i.default.create({user:a._id});throw a.shoppingCart=e,yield a.save({validateBeforeSave:!1}),new d.default("your shopping cart was not exist we created on and assigned to you please now fill your cart with the items and checkout .",500)}if(0===e.items.length)throw new d.default("Your shopping cart is empty please add items before you checkout.",400);return e})));var a;(e=>{for(const t of e.items){const e=t.product;if(!e||e.stock_quantity<t.quantity)throw new d.default(`The product ${(null==e?void 0:e.name)||"unknown product"} is out of stock or does not have sufficient quantity`,400)}})(s),e.shoppingCart=s,e.shipAddress=t,e.phoneNumber=r,n()}))))},1555:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeUnApplyDiscountCode=t.validateBeforeApplyDiscountCode=void 0;const i=r(n(6049)),d=r(n(1573)),s=r(n(4960)),a=r(n(2489));var u;!function(e){e.INVALID_DISCOUNT_CODE="Invalid discount code",e.EXPIRED_OR_INACTIVE_DISCOUNT_CODE="Discount code is expired or not active",e.OUT_OF_USAGE_LIMIT_DISCOUNT_CODE="Discount code is out of the usage limit",e.NOT_ACTIVE_DISCOUNT_CODE="Discount code is not active",e.EMPTY_SHOPPING_CART="You can apply discount only after adding product to your shopping cart.",e.ONLY_ONE_DISCOUNT_CODE="You can apply only one discount code at a time",e.NO_DISCOUNT_CODE_USED="You have not applied any discount code yet"}(u||(u={})),t.validateBeforeApplyDiscountCode=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=yield(e=>o(void 0,void 0,void 0,(function*(){const t=yield i.default.findOne({code:e.body.code});if(!t)throw new s.default(u.INVALID_DISCOUNT_CODE,400);let n=t.endDate<new Date,o=t.isActive,r=!1;if(t.usageLimit&&(r=t.usageLimit<=t.usageCount),!o)throw new s.default(u.NOT_ACTIVE_DISCOUNT_CODE,400);if(n)throw new s.default(u.EXPIRED_OR_INACTIVE_DISCOUNT_CODE,400);if(r)throw new s.default(u.OUT_OF_USAGE_LIMIT_DISCOUNT_CODE,400);return t})))(e),r=yield(e=>o(void 0,void 0,void 0,(function*(){const t=yield d.default.findById(e.user.shoppingCart);if(!t)throw new s.default("something went wrong",400);if(0===t.total_price)throw new s.default(u.EMPTY_SHOPPING_CART,400);if(void 0!==t.discount_code)throw new s.default(u.ONLY_ONE_DISCOUNT_CODE,400);return t})))(e);e.discountCode=t,e.userShoppingCart=r,n()})))),t.validateBeforeUnApplyDiscountCode=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=yield d.default.findById(e.user.shoppingCart);if(!t)throw new s.default("something went wrong",400);if(void 0===t.discount_code)throw new s.default(u.NO_DISCOUNT_CODE_USED,400);e.userShoppingCart=t,e.discountCode=t.discount_code,n()}))))},2535:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeCreateDiscountCode=void 0;const i=r(n(5061)),d=r(n(2059)),s=r(n(6049)),a=n(7839),u=n(581),l=r(n(2489)),c=r(n(4960));t.validateBeforeCreateDiscountCode=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){yield(e=>o(void 0,void 0,void 0,(function*(){const{code:t,discountType:n,discountValue:o,startDate:r,endDate:i,usageLimit:d}=e.body;if(!(t&&n&&o&&r&&i&&d))throw new c.default("Please provide all required data (code,discountType,discountValue,startDate,endDate,usageLimit)",400);if(n===a.DiscountType.PERCENTAGE&&(o<0||o>100))throw new c.default("Discount value must be between 0 and 100",400);if(n===a.DiscountType.FIXEDAMOUNT&&o<=0)throw new c.default("Discount value must be greater than 0",400);if(r>i)throw new c.default("Start date must be before end date",400);if(d<1)throw new c.default("Usage limit must be at least 1",400);if(yield s.default.findOne({code:t}))throw new c.default("Code already exist please chose anther code and may you add part of your shop name within the code to ensure it unique",400)})))(e);const t=yield(e=>o(void 0,void 0,void 0,(function*(){const t=yield i.default.findById(e.user.myShop);if(!t)throw new c.default("You don't have shop only shop owner can preform this actions",404);return t})))(e);yield((e,t)=>o(void 0,void 0,void 0,(function*(){const{allowedCategories:n,allowedProducts:o}=e.body;if(void 0!==o){const e=yield d.default.find({_id:{$in:o}});if(e.length!==o.length)throw new c.default("Invalid products in allowed products(its seems you provide none  correct data about the products please check again the products ids)",400);for(const n of e)if(n.sourceType!==u.ProductSourceType.Shop||n.shopId.toString()!==t._id.toString())throw new c.default("Invalid products in allowed products(its seems you provide none  correct data about the products please check again the products ids)",400)}if(void 0!==n)for(const e of n)if(!Object.values(u.ProductCategory).includes(e))throw new c.default("Invalid category in allowed categories",400)})))(e,t),e.shop=t,n()}))))},1314:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeCreateDiscountCode=void 0;const i=r(n(2059)),d=r(n(6049)),s=n(7839),a=n(581),u=r(n(2489)),l=r(n(4960));t.validateBeforeCreateDiscountCode=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){yield(e=>o(void 0,void 0,void 0,(function*(){const{code:t,discountType:n,discountValue:o,startDate:r,endDate:i,usageLimit:a}=e.body;if(!(t&&n&&o&&r&&i&&a))throw new l.default("Please provide all required data (code,discountType,discountValue,startDate,endDate,usageLimit)",400);if(n===s.DiscountType.PERCENTAGE&&(o<0||o>100))throw new l.default("Discount value must be between 0 and 100",400);if(n===s.DiscountType.FIXEDAMOUNT&&o<=0)throw new l.default("Discount value must be greater than 0",400);if(r>i)throw new l.default("Start date must be before end date",400);if(a<1)throw new l.default("Usage limit must be at least 1",400);if(yield d.default.findOne({code:t}))throw new l.default("Code already exist please chose anther code and may you add part of your shop name within the code to ensure it unique",400)})))(e),yield(e=>o(void 0,void 0,void 0,(function*(){const{allowedCategories:t,allowedProducts:n}=e.body;if(void 0!==n){const e=yield i.default.find({_id:{$in:n}});if(e.length!==n.length)throw new l.default("Invalid products in allowed products(its seems you provide none  correct data about the products please check again the products ids)",400);for(const t of e)if(t.sourceType!==a.ProductSourceType.Website)throw new l.default("Invalid products in allowed products(its seems you provide none  correct data about the products please check again the products ids)",400)}if(void 0!==t)for(const e of t)if(!Object.values(a.ProductCategory).includes(e))throw new l.default("Invalid category in allowed categories",400)})))(e),n()}))))},5471:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeCreateMessage=void 0;const i=r(n(2819)),d=r(n(5061)),s=n(5362),a=r(n(2489)),u=r(n(4960));var l;!function(e){e.MISSING_INFORMATION="Please provide all required information (recipient, recipientType, subject, content ) .",e.RECIPIENT_NOT_FOUND="Recipient not found with the provided ID"}(l||(l={})),t.validateBeforeCreateMessage=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{recipient:t,recipientType:r,subject:a,content:c}=e.body;(e=>{const{recipient:t,recipientType:n,subject:o,content:r}=e.body;if(!(t&&n&&o&&r))throw new u.default(l.MISSING_INFORMATION,400)})(e);const p=yield((e,t)=>o(void 0,void 0,void 0,(function*(){let n=null;switch(t){case s.RecipientType.USER:n=yield i.default.findById(e);break;case s.RecipientType.SHOP:n=yield d.default.findById(e);break;default:throw new u.default(l.RECIPIENT_NOT_FOUND,400)}if(!n)throw new u.default(l.RECIPIENT_NOT_FOUND,404);return n})))(t,r);e.recipient=p,e.sender=e.user,n()}))))},8044:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeDeliverOrder=t.validateBeforeUpdateShippingStatus=t.validateBeforeCancelOrder=void 0;const i=r(n(5939)),d=r(n(2819)),s=n(6813),a=r(n(2489)),u=r(n(4960));t.validateBeforeCancelOrder=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){console.log("req.params.id",e.params.id);const t=yield i.default.findById(e.params.id);if(!t)return n(new u.default("Order not found",404));if(t.orderStatus!==s.OrderStatus.Processing)return n(new u.default("Only processing orders can be cancelled",400));const o=yield d.default.findById(t.user);e.order=t,e.userOrderOwner=o,n()})))),t.validateBeforeUpdateShippingStatus=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=yield i.default.findById(e.params.id);if(!t)return n(new u.default("Order not found",404));if(t.shippingStatus===s.ShippingStatus.Shipped)return n(new u.default("Order has already been Shipped",400));const o=yield d.default.findById(t.user);if(!o)return n(new u.default("The user that make this order no longer exits.",403));e.order=t,e.userOrderOwner=o,n()})))),t.validateBeforeDeliverOrder=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=yield i.default.findById(e.params.id);if(!t)return n(new u.default("No order found with this id.",404));if(t.orderStatus!==s.OrderStatus.Processing)return n(new u.default("Only processing orders can be delivered",400));const o=yield d.default.findById(t.user);if(!o)return n(new u.default("The user that make this order no longer exits.",403));e.order=t,e.userOrderOwner=o,n()}))))},798:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeShopOrdersOperations=void 0;const i=r(n(5061)),d=r(n(2489)),s=r(n(4960));t.validateBeforeShopOrdersOperations=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=e.user.myShop,o=yield i.default.findById(t);if(!o)return n(new s.default("You don't have shop yet and you can't access this resource.",400));e.shopId=o._id,e.shop=o,n()}))))},9440:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeRenewPrimeSubscription=t.validateBeforeCancelPrimeSubscription=t.validateBeforeCreatePrimeSubscription=void 0;const i=r(n(3388)),d=r(n(2819)),s=n(976),a=r(n(4960)),u=r(n(2489)),l=e=>o(void 0,void 0,void 0,(function*(){const t=yield d.default.findById(e);if(!t)throw new a.default("No user found with this id",404);return t}));t.validateBeforeCreatePrimeSubscription=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=yield l(e.body.userId);if(t.isPrimeUser)return n(new a.default("User already prime member",400));const r=yield(e=>o(void 0,void 0,void 0,(function*(){if(e.isPrimeUser&&e.primeSubscriptionStatus===s.PrimeSubscriptionStatus.ACTIVE)throw new a.default("User already prime member and its state is active",400);if(e.lastPrimeSubscriptionDocument){const t=yield i.default.findById(e.lastPrimeSubscriptionDocument);if(t)return t}})))(t);r&&(e.prevPrimeSubscription=r),e.userToSubscribe=t,n()})))),t.validateBeforeCancelPrimeSubscription=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=yield l(e.body.userId),r=yield(e=>o(void 0,void 0,void 0,(function*(){if(!e.isPrimeUser||e.primeSubscriptionStatus!==s.PrimeSubscriptionStatus.ACTIVE)throw new a.default("User is not an active prime member",400);if(!e.lastPrimeSubscriptionDocument)throw new a.default("User does not have a last prime subscription document",404);const t=yield i.default.findById(e.lastPrimeSubscriptionDocument);if(!t)throw new a.default("No prime membership found matching the last subscription document ID",404);return t})))(t);if(r){if(r.status===s.PrimeSubscriptionStatus.CANCELLED)return n(new a.default("Member ship is already cancelled.",400));e.prevPrimeSubscription=r}if(void 0===e.prevPrimeSubscription)return n(new a.default("something went wrong while tray to get user last subscription information",500));e.userToSubscribe=t,n()})))),t.validateBeforeRenewPrimeSubscription=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){}))))},5541:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeCancelMySubscription=void 0;const i=r(n(3388)),d=n(976),s=r(n(4960)),a=r(n(2489));t.validateBeforeCancelMySubscription=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{user:t}=e;if(!t.isPrimeUser)return n(new s.default("Your are not prime member.",400));if(!e.body.cancellationReason)return n(new s.default("Please provide a cancellation reason.",400));const o=yield i.default.findOne({_id:t.lastPrimeSubscriptionDocument,user:t});return o?o.status===d.PrimeSubscriptionStatus.CANCELLED?n(new s.default("Your subscription is already cancelled.",400)):void(e.latestSubscription=o):n(new s.default("Your information about your latest subscription could  not be found.",404))}))))},1033:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeProcessReturnRequests=t.validateBeforeReturnRequest=void 0;const i=r(n(5496)),d=r(n(2819)),s=r(n(5939)),a=n(4876),u=n(6813),l=r(n(2489)),c=r(n(4960));t.validateBeforeReturnRequest=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{orderId:t,productId:r,quantity:d,returnReason:l}=e.body;(e=>{const{orderId:t,productId:n,quantity:o,returnReason:r}=e;if(!(t&&n&&o&&r))throw new c.default("Order ID, Product ID, quantity, and return reason are required",400);if(o<1)throw new c.default("You can't return less than 1 item",400)})(e.body);const p=yield((e,t)=>o(void 0,void 0,void 0,(function*(){const n=yield s.default.findOne({_id:e,user:t});if(!n)throw new c.default("No order found with this ID",404);if(n.orderStatus!==u.OrderStatus.Delivered)throw new c.default("You can't return items from an un-delivered order.",400);return n})))(t,e.user._id),f=((e,t,n)=>{const o=e.items.find((e=>e.product._id.toString()===t.toString()));if(!o)throw new c.default("This product not found on the order.",404);if(n>o.quantity)throw new c.default("You can't return more than you purchased",400);return o})(p,r,d);yield((e,t)=>o(void 0,void 0,void 0,(function*(){const n=yield i.default.findOne({order:e,"product._id":t});if(n)switch(n.returnStatus){case a.ReturnStatus.Pending:throw new c.default("You already have a pending return request for this product.",400);case a.ReturnStatus.Approved:throw new c.default("This product has already been returned.",400);case a.ReturnStatus.Rejected:throw new c.default("Your return request for this product was rejected. Please contact support.",400)}})))(t,r),(e=>{const t=new Date;if(t.setDate(t.getDate()-30),e<t)throw new c.default("You can only return products purchased within the last 30 days",400)})(p.createdAt),e.returnedProduct=f,n()})))),t.validateBeforeProcessReturnRequests=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{id:t}=e.params,o=yield i.default.findById(t);if(!o)return n(new c.default("No return request with this ID",404));if(o.returnStatus!==a.ReturnStatus.Pending)return n(new c.default("You can't approve this request only pending return requests can be approved.",400));const r=yield d.default.findById(o.user);if(!r)return n(new c.default("User who created this return request no longer exits.",404));const u=yield s.default.findById(o.order);if(!u)return n(new c.default("Order no longer exists.",404));e.order=u,e.userToReturn=r,e.returnRequest=o,n()}))))},235:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateRefundRequest=void 0;const i=r(n(5939)),d=r(n(2819)),s=r(n(5976)),a=n(1132),u=r(n(2489)),l=r(n(4960));t.validateRefundRequest=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=yield s.default.findById(e.params.id);if(!t)return n(new l.default("No refund request found with this id",404));if(t.refundStatus!==a.RefundStatus.Pending)return n(new l.default(`This refund request is already processed and its state is ${t.refundStatus}`,400));const o=yield d.default.findById(t.user),r=yield i.default.findById(t.order);return o?r?(e.order=r,e.userToRefund=o,e.refundRequest=t,void n()):n(new l.default("something went wrong the order related to this refund operation no longer exist ",404)):n(new l.default("something went wrong the user account related to this refund operation no longer exist ",404))}))))},9046:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeResolveReport=t.validateBeforeCreateReport=void 0;const i=r(n(5061)),d=r(n(656)),s=r(n(2489)),a=r(n(4960));t.validateBeforeCreateReport=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){!function(e,t){const{reportedShop:n,reason:o,description:r}=e.body;n&&o&&r||t(new a.default("Please provide all required information(reportedShop,reportedBy,reason,description)",400))}(e,n);const t=yield function(e){return o(this,void 0,void 0,(function*(){const t=yield i.default.findById(e);if(!t)throw new a.default("Shop does not exist",404);return t}))}(e.body.reportedShop);e.shop=t,e.userToReport=e.user,n()})))),t.validateBeforeResolveReport=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=yield d.default.findById(e.params.id);return t?t.resolved?n(new a.default("Report already resolved",400)):(e.report=t,void n()):n(new a.default("No report found with that ID",404))}))))},510:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateDataBeforeCreateReview=void 0;const i=r(n(2059)),d=r(n(1177)),s=r(n(2489)),a=r(n(4960));t.validateDataBeforeCreateReview=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{productId:t,rating:o,comment:r}=e.body;return t&&o?(yield i.default.findById(t))?e.user.purchaseHistory.includes(t)?(yield d.default.findOne({user:e.user._id,product:t}))?n(new a.default("You already rated this product before in the context to not allow spam ratings you can updated your old rating instead of creating new rate .",400)):void n():n(new a.default("You have to purchase the product to be able to rate it.",400)):n(new a.default("No product found with this id provide valid id and tray again",404)):n(new a.default("Please provide all required data (product-id , rating)",400))}))))},523:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeCreateDeleteShopRequest=t.validateBeforeApproveDeleteShopRequest=void 0;const i=r(n(619)),d=r(n(5061)),s=r(n(2819)),a=r(n(4960)),u=r(n(2489));t.validateBeforeApproveDeleteShopRequest=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{id:t}=e.params,o=yield i.default.findById(t);return o?"pending"!==o.requestStatus?n(new a.default("Delete shop request is already processed",400)):(e.shopOwner=o.user,e.shop=o.shop,e.deleteShopRequest=o,void n()):n(new a.default("No delete shop request found with this id",404))})))),t.validateBeforeCreateDeleteShopRequest=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopId:t,reason:o,userId:r}=e.body;if(!t||!o||!r)return n(new a.default("Please provide shop id ,user id and  reason for deleting shop",400));const u=yield d.default.findById(t);if(!u)return n(new a.default("No shop found with this id",404));if(yield i.default.findOne({shop:t,requestStatus:"pending"}))return n(new a.default("Delete shop request for this shop already created please wait until your request processed.",400));const l=yield s.default.findById(u.owner);return l?(null==l?void 0:l._id).toString()!==r?n(new a.default("Provided user id is not the owner of the shop you want to delete, please provide the correct user id",403)):void n():n(new a.default("the shop owner is no longer exist",404))}))))},6407:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeUnFreezeProduct=t.validateBeforeFreezeProduct=t.validateBeforeDeleteProduct=t.validateBeforeUpdateProduct=t.validateBeforeAddNewProduct=void 0;const i=r(n(5061)),d=r(n(2059)),s=r(n(2489)),a=r(n(4960));t.validateBeforeAddNewProduct=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=yield i.default.findById(e.user.myShop);if(!t)return n(new a.default("You don't have shop yet open shop to be able to start add products.",404));if(!1===t.isActive)return n(new a.default("Your shop is not active the un-actives shops can't add products.",404));const{name:o,description:r,category:d,brand:s,color:u,stock_quantity:l,price:c,discount:p,material:f,manufacturer:h,images:m}=e.body;if(!(o&&r&&d&&s&&l&&c&&f))return n(new a.default("Missing required fields. name ,description,category,brand-name,stock_quantity,price are required please provide this data",400));const y={sourceType:"shop",shopId:e.user.myShop,name:o,description:r,category:d,brand:s,color:u,stock_quantity:l,price:c,discount:p,material:f,manufacturer:h,images:m};e.productInformation=y,e.shop=t,n()})))),t.validateBeforeUpdateProduct=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(e.body.sourceType||e.body.shopId||e.body.availability_status||e.body.return_policy||e.body.totalReviews||e.body.averageRating)return n(new a.default("You can't update the product sourceType, shopId, availability_status, return policy, totalReviews, averageRating fields.",400));const t=yield i.default.findById(e.user.myShop);if(!t)return n(new a.default("You don't have shop yet open shop to be able to update products.",404));if(!1===t.isActive)return n(new a.default("Your shop is not active the un-actives shops can't update products.",404));const o=yield d.default.findById(e.params.productId);return o?o.shopId?o.shopId.toString()!==e.user.myShop.toString()?n(new a.default("You are not authorized to update this product.",403)):(e.product=o,e.shop=t,void n()):n(new a.default("Product not related to the shop.",404)):n(new a.default("Product not found with the given id.",404))})))),t.validateBeforeDeleteProduct=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!e.params.productId)return n(new a.default("Product id is required.",400));const t=yield i.default.findById(e.user.myShop);if(!t)return n(new a.default("You don't have shop yet open shop to be able to delete products.",404));if(!1===t.isActive)return n(new a.default("Your shop is not active the un-actives shops can't delete products.",404));const o=yield d.default.findById(e.params.productId);return o?o.shopId?o.shopId.toString()!==e.user.myShop.toString()?n(new a.default("You are not authorized to delete this product.",403)):(e.product=o,e.shop=t,void n()):n(new a.default("Product not related to the shop.",404)):n(new a.default("Product not found with the given id.",404))})))),t.validateBeforeFreezeProduct=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!e.params.productId)return n(new a.default("Product id is required.",400));const t=yield i.default.findById(e.user.myShop);if(!t)return n(new a.default("You don't have shop yet open shop to be able to freeze products.",404));if(!1===t.isActive)return n(new a.default("Your shop is not active the un-actives shops can't freeze products.",404));const o=yield d.default.findById(e.params.productId);return o?o.shopId?o.shopId.toString()!==e.user.myShop.toString()?n(new a.default("You are not authorized to freeze this product.",403)):!0===o.freezed?n(new a.default("This product is already frozen.",400)):(e.product=o,e.shop=t,void n()):n(new a.default("Product not related to the shop.",404)):n(new a.default("Product not found with the given id.",404))})))),t.validateBeforeUnFreezeProduct=(0,s.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!e.params.productId)return n(new a.default("Product id is required.",400));const t=yield i.default.findById(e.user.myShop);if(!t)return n(new a.default("You don't have shop yet open shop to be able to unfreeze products.",404));if(!1===t.isActive)return n(new a.default("Your shop is not active the un-actives shops can't unfreeze products.",404));const o=yield d.default.findById(e.params.productId);return o?o.shopId?o.shopId.toString()!==e.user.myShop.toString()?n(new a.default("You are not authorized to unfreeze this product.",403)):!1===o.freezed?n(new a.default("This product is already unfrozen.",400)):(e.product=o,e.shop=t,void n()):n(new a.default("Product not related to the shop.",404)):n(new a.default("Product not found with the given id.",404))}))))},7646:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateShopRequestBeforeCancel=t.validateShopRequestBeforeReject=t.validateShopRequestBeforeApprove=t.validateRequestBeforeShopRequestCreation=void 0;const i=r(n(6884)),d=r(n(5061)),s=r(n(2819)),a=r(n(2489)),u=r(n(4960));t.validateRequestBeforeShopRequestCreation=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopDescription:t}=e.body,o=e.user;return t?o.verified?(yield i.default.findOne({user:o._id}))?n(new u.default("You have already requested to create a shop pleas wait until your request been processed , we will contact you soon as possible.",400)):(yield d.default.findOne({owner:o._id}))?n(new u.default("you already have a shop , you can't create a new shop. if you want to create a new shop please delete your current shop or create a new account.",400)):void n():n(new u.default("You haven't verified your email. Please verify your email to proceed.",400)):n(new u.default("Please provide shop name and description",400))})))),t.validateShopRequestBeforeApprove=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=yield i.default.findOne({_id:e.params.id});if(!t)return n(new u.default("No shop request found with this ID",404));if("cancelled"===t.requestStatus)return n(new u.default("This shop request is canceled and not be valid to be approved",400));if("approved"===t.requestStatus)return n(new u.default("This shop request is already approved ",400));if("rejected"===t.requestStatus)return n(new u.default("This shop request is already rejected and not valid to be approved. ",400));const o=yield s.default.findOne({_id:t.user});if(!o)return n(new u.default("the user who created this request is no more exist .",404));e.userToOpenShop=o,e.shopRequest=t,n()})))),t.validateShopRequestBeforeReject=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{rejectionReason:t}=e.body;if(!t)return n(new u.default("Please provide a rejection reason",400));const o=yield i.default.findById(e.params.id);if(!o)return n(new u.default("Shop request not found",404));const r=yield s.default.findById(o.user);return r?"rejected"===o.requestStatus?n(new u.default("Shop request is already rejected",400)):(e.shopRequest=o,e.userToOpenShop=r,void n()):n(new u.default("The user who created this request is no more exist",404))})))),t.validateShopRequestBeforeCancel=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{id:t}=e.params,o=yield i.default.findOne({_id:t,user:e.user._id});return o?"cancelled"===o.requestStatus?n(new u.default("Shop request is already cancelled",400)):"approved"===o.requestStatus||"rejected"===o.requestStatus?n(new u.default("Cannot cancel a shop request that is already approved or rejected",400)):(e.shopRequest=o,void n()):n(new u.default("No shop request found with this id.",404))}))))},918:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeUpdateBanner=t.validateBeforeUpdateShopInfo=t.validateBeforeConfirmUpdateShopEmailAddress=t.validateBeforeUpdateShopEmailAddress=void 0;const i=r(n(6982)),d=r(n(7906)),s=r(n(2819)),a=r(n(5061)),u=r(n(2489)),l=r(n(4960)),c="You can't update the shop's email using this route. Please use the route /my-shop/update-email.",p="You can't update the shop's categories using this route.",f="You can't change the shop's owner.",h=e=>o(void 0,void 0,void 0,(function*(){const t=yield a.default.findOne({owner:e});if(!t)throw new l.default("You don't have shop . you can apply for shop request to open your own shop",404);if(!t.isActive)throw new l.default("Your shop is un-activated you can't update the shop information",400);return t}));t.validateBeforeUpdateShopEmailAddress=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{email:t}=e.body,r=e.user._id.toString();if(!(e=>!!e.trim()&&d.default.isEmail(e.trim()))(t))return n(new l.default("Please provide a valid email",400));const i=yield h(r),u=yield((e,t,n)=>o(void 0,void 0,void 0,(function*(){const[o,r]=yield Promise.all([s.default.findOne({email:e}),a.default.findOne({email:e})]),i=o&&o._id.toString()!==t,d=r&&r._id.toString()!==n;return!(!i&&!d)})))(t,r,i._id.toString());return u?n(new l.default("This email is already in use.",400)):t.trim()===i.email||t.trim()===e.user.email?n(new l.default("New email must be different from the current shop and user email.",400)):(e.shop=i,void n())})))),t.validateBeforeConfirmUpdateShopEmailAddress=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{token:t}=e.params,o=i.default.createHash("sha256").update(t).digest("hex"),r=yield a.default.findOne({changeEmailVerificationToken:o,changeEmailVerificationTokenExpiresAt:{$gt:new Date}});if(!r)return n(new l.default("Invalid token or expired token",400));const d=yield s.default.findById(r.owner);if(!d)return n(new l.default("The user belonging to this token no longer exists",401));e.shop=r,e.user=d,n()})))),t.validateBeforeUpdateShopInfo=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=e.user._id.toString(),o=yield h(t);return e.body.email?n(new l.default(c,400)):e.body.banner?n(new l.default("You can't update the shop's banner using this route. Please use the route /my-shop/banner.",400)):e.body.categories?n(new l.default(p,400)):e.body.owner?n(new l.default(f,400)):(e.shop=o,void n())})))),t.validateBeforeUpdateBanner=(0,u.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{shopDescription:t,shopName:o,shopPhoneNumber:r,photo:i}=e.body;if(t||o||r||i)return n(new l.default("You can't update shop description, shop name, shop phone number or photo using this route. this only for updating the shop banner",400));if(e.body.email)return n(new l.default(c,400));if(e.body.categories)return n(new l.default(p,400));if(e.body.owner)return n(new l.default(f,400));const d=e.user._id.toString(),s=yield h(d);e.shop=s,n()}))))},9736:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeProcessShopSupportTicket=t.validateBeforeCreateShopSupportTicket=t.validateBeforeOpenShopSupportTicket=void 0;const i=r(n(7378)),d=r(n(5061)),s=r(n(2819)),a=r(n(2489)),u=r(n(4960));t.validateBeforeOpenShopSupportTicket=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{subject:t,description:o,category:r}=e.body;if(!t||!o||!r)return n(new u.default("Subject, Description and Category are required",400));const i=yield d.default.findOne({_id:e.user.myShop,owner:e.user._id});if(!i)return n(new u.default("You don't have permission to create support ticket,only shop-owner allowed to use this route you can use user support tickets route instead.",403));e.shop=i,n()})))),t.validateBeforeCreateShopSupportTicket=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{subject:t,description:o,category:r,userId:i,shopId:a}=e.body;if(!(t&&o&&r&&i&&a))return n(new u.default("Subject, Description , Category , UserId , ShopId are required",400));const l=yield d.default.findOne({_id:a,owner:i});if(!l)return n(new u.default("No shop exits with this id and related to this user please check the data and try again.",403));const c=yield s.default.findById(i);return c?c.myShop?c.myShop.toString()!==l._id.toString()?n(new u.default("User is not the owner of the shop, please check the data and try again.",403)):(e.shop=l,e.userToCreateTicket=c,void n()):n(new u.default("User doesn't have a shop, please check the data and try again.",403)):n(new u.default("No user exits with this id",403))})))),t.validateBeforeProcessShopSupportTicket=(0,a.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{ticketId:t}=e.params,{ticketResponse:o}=e.body;if(!o)return n(new u.default("Ticket response is required",400));const r=yield i.default.findById(t);if(!r)return n(new u.default("No support ticket found  with this id.",404));const a=yield d.default.findById(r.shop);if(!a)return n(new u.default("The shop that support ticket related to is no more exist.",404));const l=yield s.default.findById(a.owner);if(!l)return n(new u.default("The shop owner that support ticket related to is no more exist.",404));e.shop=a,e.ticket=r,e.shopOwner=l,n()}))))},5815:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeDecrementItem=t.validateBeforeRemoveItem=t.checkItemValidity=void 0;const i=r(n(1573)),d=r(n(2059)),s=r(n(7543)),a=n(8216),u=r(n(4960)),l=r(n(2489)),c=e=>o(void 0,void 0,void 0,(function*(){const t=yield i.default.findById(e.user.shoppingCart);if(!t)throw yield(0,a.createAndAssignShoppingCart)(e.user),new u.default("something went wrong with your shopping cart please tray again",500);return t}));t.checkItemValidity=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{productId:t,quantity:r}=e.body,i=yield(e=>o(void 0,void 0,void 0,(function*(){const{productId:t,quantity:n}=e.body;if(!t||!n)throw new u.default("productId and quantity are required",400);const o=yield d.default.findById(t);if(!o)throw new u.default("No product fount with given id .",404);if(o.stock_quantity<n)throw new u.default("Product stock quantity  less than your required quantity",400);return o})))(e),a=yield c(e),l=yield((e,t)=>o(void 0,void 0,void 0,(function*(){const{productId:n,quantity:o}=e.body,r=yield s.default.findOne({cart:e.user.shoppingCart,product:n});if(r&&r.quantity+o>t.stock_quantity)throw new u.default(" stock quantity  less than your required quantity",400);return r})))(e,i);l&&(e.userShoppingCartItem=l),e.product=i,e.userShopCart=a,n()})))),t.validateBeforeRemoveItem=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=yield c(e),o=yield s.default.findOne({cart:e.user.shoppingCart,product:e.params.productId});if(!o)return n(new u.default("Product not found in the shopping cart",404));e.userShopCart=t,e.userShoppingCartItem=o,n()})))),t.validateBeforeDecrementItem=(0,l.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{productId:t,quantity:o}=e.body;if(!t||!o)return n(new u.default("Product id and quantity are required",400));const r=yield s.default.findOne({cart:e.user.shoppingCart,product:t});return r?r.quantity<o?n(new u.default("Quantity to decrement must be less than or equal to current quantity",400)):(e.userShoppingCartItem=r,void n()):n(new u.default("Product not found in the shopping cart ",404))}))))},73:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBeforeUpdateUserInfo=t.validateBeforeUpdateUserPassword=void 0;const i=r(n(4960)),d=r(n(2489));t.validateBeforeUpdateUserPassword=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const{currentPassword:t,newPassword:o,passwordConfirmation:r}=e.body;return t&&o&&r?o!==r?n(new i.default("Password and password confirmation do not match",400)):void n():n(new i.default("Please provide all required data currentPassword, password, passwordConfirmation",400))})))),t.validateBeforeUpdateUserInfo=(0,d.default)(((e,t,n)=>o(void 0,void 0,void 0,(function*(){const t=["password","passwordConfirmation","role","verified","active","passwordResetToken","passwordResetExpires","emailToken","giftCard","myShop"],o=Object.keys(e.body).filter((e=>t.includes(e)));if(o.length>0)return n(new i.default(`You can't update these fields: ${o.join(", ")}`,400));n()}))))},3240:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=new o.Schema({shopId:{type:o.Schema.Types.ObjectId,ref:"Shop",required:!0},shopName:{type:String,required:!0},shopEmail:{type:String,required:!0},month:{type:String,required:!0},year:{type:Number,required:!0},financialInformation:{totalRevenue:{type:Number,required:!0},totalRefund:{type:Number,required:!0},averageOrderValue:{type:Number,required:!0},totalProfit:{type:Number,required:!0}},orders:{totalOrders:{type:Number,required:!0},totalShippedOrders:{type:Number,required:!0},totalDeliveredOrders:{type:Number,required:!0},totalCancelledOrders:{type:Number,required:!0},totalPendingOrders:{type:Number,required:!0}},returnInformation:{totalReturnItems:{type:Number,required:!0},totalAcceptedReturnItems:{type:Number,required:!0},totalRejectedReturnItems:{type:Number,required:!0}},refundInformation:{totalRefundRequests:{type:Number,required:!0},totalAcceptedRefundRequests:{type:Number,required:!0},totalRejectedRefundRequests:{type:Number,required:!0}},productInformation:{totalProducts:{type:Number,required:!0},totalActiveProducts:{type:Number,required:!0},totalInactiveProducts:{type:Number,required:!0},totalOutOfStockProducts:{type:Number,required:!0},totalInStockProducts:{type:Number,required:!0},totalFreezedProducts:{type:Number,required:!0},totalUnFreezedProducts:{type:Number,required:!0},newProducts:{type:Number,required:!0}}},{timestamps:!0}),i=(0,o.model)("ShopAnalyticsReportModel",r);t.default=i},1202:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=new o.Schema({month:{type:String,required:!0},year:{type:Number,required:!0},financialSummary:{totalSales:{type:Number,required:!0},totalShopSales:{type:Number,required:!0},totalWebsiteSales:{type:Number,required:!0},totalProcessedRefunds:{type:Number,required:!0},totalWebsiteProfit:{type:Number,required:!0},averageOrderValue:{type:Number,required:!0}},shopAnalytics:{totalShops:{type:Number,required:!0},activeShops:{type:Number,required:!0},inactiveShops:{type:Number,required:!0},shopsWithProducts:{type:Number,required:!0},newJoiningShops:{type:Number,required:!0},shopsWithOrders:{type:Number,required:!0},shopsSupportTickets:{type:Number,required:!0},newShopsRequests:{type:Number,required:!0},newDeleteShopsRequests:{type:Number,required:!0}},orderAnalytics:{totalOrders:{type:Number,required:!0},totalShopOrders:{type:Number,required:!0},totalWebsiteOrders:{type:Number,required:!0},totalPendingOrders:{type:Number,required:!0},totalCancelledOrders:{type:Number,required:!0},totalDeliveredOrders:{type:Number,required:!0},totalReturnItems:{type:Number,required:!0}},productAnalytics:{totalProducts:{type:Number,required:!0},totalShopProducts:{type:Number,required:!0},totalWebsiteProducts:{type:Number,required:!0},newProducts:{type:Number,required:!0},totalOutOfStockProducts:{type:Number,required:!0},totalInStockProducts:{type:Number,required:!0}},userAnalytics:{totalUsers:{type:Number,required:!0},totalShopOwners:{type:Number,required:!0},newUsers:{type:Number,required:!0},usersWithOrders:{type:Number,required:!0},usersWithNoOrders:{type:Number,required:!0}},refundAnalytics:{totalRefundRequests:{type:Number,required:!0},totalProcessedRefundRequests:{type:Number,required:!0},newRefundRequests:{type:Number,required:!0},totalRefundRequestsForCancelledOrders:{type:Number,required:!0},totalRefundRequestsForReturnItems:{type:Number,required:!0},rejectedRefundRequests:{type:Number,required:!0}},returnItemsAnalytics:{totalReturnItemsRequests:{type:Number,required:!0},totalProcessedReturnItemsRequests:{type:Number,required:!0},newReturnItemsRequests:{type:Number,required:!0},totalRejectedReturnItemsRequests:{type:Number,required:!0},totalCancelledReturnItemsRequests:{type:Number,required:!0}},supportTicketAnalytics:{totalUsersSupportTickets:{type:Number,required:!0},totalProcessedSupportTickets:{type:Number,required:!0},newUserSupportTickets:{type:Number,required:!0},totalShopSupportTickets:{type:Number,required:!0},totalProcessedShopSupportTickets:{type:Number,required:!0},newShopSupportTickets:{type:Number,required:!0}},primeSubscriptionAnalytics:{totalPrimeSubscriptions:{type:Number,required:!0},totalActivePrimeSubscriptions:{type:Number,required:!0},totalInactivePrimeSubscriptions:{type:Number,required:!0},newPrimeSubscriptions:{type:Number,required:!0}}},{timestamps:!0}),i=(0,o.model)("WebsiteAnalyticsReport",r);t.default=i},7543:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.cartItemSchema=void 0;const r=n(6037);t.cartItemSchema=new r.Schema({cart:{type:r.Schema.Types.ObjectId,ref:"ShoppingCart",required:!0},product:{type:r.Schema.Types.ObjectId,ref:"Product",required:!0},quantity:{type:Number,required:!0,min:[1,"Quantity cannot be less than 1."]},price:{type:Number,required:!0,default:0},discount:{type:Number,default:0},discountCodes:{type:[r.Schema.Types.ObjectId],ref:"DiscountCode",default:[]},priceAfterDiscount:{type:Number,required:!0,default:0}},{timestamps:!0}),t.cartItemSchema.methods.calculateTotalPrice=function(){return o(this,void 0,void 0,(function*(){const e=yield this.model("Product").findById(this.product);this.price=e.price*this.quantity,this.discount=e.discount*this.quantity,this.priceAfterDiscount=this.price-this.discount}))},t.cartItemSchema.pre("save",(function(e){return o(this,void 0,void 0,(function*(){yield this.calculateTotalPrice(),e()}))})),t.cartItemSchema.pre(/^find/,(function(e){this.populate({path:"product"}),e()}));const i=(0,r.model)("CartItem",t.cartItemSchema);t.default=i},7839:(e,t)=>{var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.DiscountCodeSource=t.DiscountType=void 0,function(e){e.PERCENTAGE="percentage",e.FIXEDAMOUNT="fixed_amount"}(n||(t.DiscountType=n={})),function(e){e.SHOP="shop",e.WEBSITE="website"}(o||(t.DiscountCodeSource=o={}))},6049:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(7839),i=n(581),d=new o.Schema({code:{type:String,required:!0},discountType:{type:String,enum:Object.values(r.DiscountType),required:!0},discountCodeSource:{type:String,enum:Object.values(r.DiscountCodeSource),required:!0},discountValue:{type:Number,required:!0},shop:{type:o.Schema.Types.ObjectId,ref:"Shop"},startDate:{type:Date,required:!0},endDate:{type:Date,required:!0},minimumPurchaseAmount:{type:Number},usageLimit:{type:Number},usageCount:{type:Number,required:!0,default:0},allowedProducts:[{type:o.Schema.Types.ObjectId,ref:"Product"}],allowedCategories:[{type:String,enum:Object.values(i.ProductCategory)}],isActive:{type:Boolean,required:!0,default:!0}},{timestamps:!0,toObject:{virtuals:!0},toJSON:{virtuals:!0}});d.index({code:1}),d.virtual("isExpired").get((function(){return this.endDate<new Date})),d.methods.isValidForPurchase=function(e){return this.isActive&&!this.isExpired&&(!this.minimumPurchaseAmount||e>=this.minimumPurchaseAmount)&&(!this.usageLimit||this.usageCount<this.usageLimit)};const s=(0,o.model)("DiscountCode",d);t.default=s},5362:(e,t)=>{var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.MessagePriority=t.RecipientType=void 0,function(e){e.SHOP="shop",e.USER="user"}(n||(t.RecipientType=n={})),function(e){e.LOW="Low",e.MEDIUM="Medium",e.HIGH="High"}(o||(t.MessagePriority=o={}))},2410:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(5362),i=new o.Schema({sender:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},recipient:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},recipientType:{type:String,enum:Object.values(r.RecipientType),required:!0},subject:{type:String,required:!0},content:{type:String,required:!0},metaData:{category:{type:String,required:!1},priority:{type:String,enum:[r.MessagePriority.LOW,r.MessagePriority.MEDIUM,r.MessagePriority.HIGH],required:!1},tags:{type:[String],required:!1},actionRequired:{type:Boolean,required:!1}}},{timestamps:!0}),d=(0,o.model)("Message",i);t.default=d},6709:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationType=void 0,function(e){e.Order="order",e.Update="update",e.Alert="alert"}(n||(t.NotificationType=n={}))},3247:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(6709),i=new o.Schema({user:{type:o.Schema.Types.ObjectId,ref:"User",required:!0,index:!0},message:{type:String,required:!0},type:{type:String,enum:Object.values(r.NotificationType),required:!0},read:{type:Boolean,default:!1},readAt:{type:Date}},{timestamps:!0}),d=(0,o.model)("Notification",i);t.default=d},6813:(e,t)=>{var n,o,r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.OrderStatus=t.ShippingStatus=t.PaymentMethod=t.PaymentStatus=void 0,function(e){e.PaymentOnDelivery="payment_on_delivery",e.Paid="paid"}(n||(t.PaymentStatus=n={})),function(e){e.Cash="cash",e.CreditCard="credit_card"}(o||(t.PaymentMethod=o={})),function(e){e.Pending="pending",e.Shipped="shipped",e.Delivered="delivered"}(r||(t.ShippingStatus=r={})),function(e){e.PENDING="pending",e.Processing="processing",e.Delivered="delivered",e.Cancelled="cancelled"}(i||(t.OrderStatus=i={}))},5939:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OrderSchema=t.ItemSchema=void 0;const o=n(6037),r=n(6813);t.ItemSchema=new o.Schema({product:{type:o.Schema.Types.ObjectId,ref:"Product",required:!0},quantity:{type:Number,required:!0},price:{type:Number,required:!0},discount:{type:Number,required:!0},priceAfterDiscount:{type:Number,required:!0}}),t.OrderSchema=new o.Schema({user:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},paymentSessionId:{type:String},items:[t.ItemSchema],itemsQuantity:{type:Number,required:!0},totalPrice:{type:Number,required:!0},totalDiscount:{type:Number,required:!0,default:0},shippingCost:{type:Number,required:!0,default:0},phoneNumber:{type:String},paymentStatus:{type:String,required:!0,enum:Object.values(r.PaymentStatus)},paymentMethod:{type:String,required:!0,enum:Object.values(r.PaymentMethod)},discountCodeAmount:{type:Number},isDiscountCodeApplied:{type:Boolean},shippingStatus:{type:String,required:!0,enum:Object.values(r.ShippingStatus),default:r.ShippingStatus.Pending},shippingAddress:{type:String,required:!0},orderStatus:{type:String,required:!0,enum:Object.values(r.OrderStatus),default:r.OrderStatus.Processing},paidAmountWithUserGiftCard:{type:Number,required:!0,default:0},discountCodes:{type:[o.Schema.Types.ObjectId],ref:"DiscountCode",default:[]},taxAmount:{type:Number,required:!0,default:0},archived:{type:Boolean,default:!1},estimatedDeliveryDate:{type:Date}},{timestamps:!0}),t.OrderSchema.index({user:1}),t.OrderSchema.index({orderStatus:1}),t.OrderSchema.index({paymentStatus:1}),t.OrderSchema.index({shippingStatus:1}),t.OrderSchema.pre(/^find/,(function(e){this.populate({path:"items",populate:{path:"product"}}),e()}));const i=(0,o.model)("Order",t.OrderSchema);t.default=i},8737:(e,t)=>{var n,o,r,i,d;Object.defineProperty(t,"__esModule",{value:!0}),t.VendorType=t.OrderStatus=t.ShippingStatus=t.PaymentMethod=t.PaymentStatus=void 0,function(e){e.PAYMENT_ON_DELIVERY="payment_on_delivery",e.PAID="paid",e.PARTIALLY_PAID="partially_paid"}(n||(t.PaymentStatus=n={})),function(e){e.CASH="cash",e.CREDIT_CARD="credit_card",e.PLATFORM_WALLET="platform_wallet"}(o||(t.PaymentMethod=o={})),function(e){e.PENDING="pending",e.PROCESSING="processing",e.SHIPPED="shipped",e.DELIVERED="delivered"}(r||(t.ShippingStatus=r={})),function(e){e.PROCESSING="processing",e.DELIVERED="delivered",e.CANCELLED="cancelled",e.REFUNDED="refunded"}(i||(t.OrderStatus=i={})),function(e){e.WEBSITE="website",e.SHOP="shop"}(d||(t.VendorType=d={}))},5027:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(7543),i=n(8737),d=new o.Schema({mainOrder:{type:o.Schema.Types.ObjectId,required:!0,ref:"Order"},user:{type:o.Schema.Types.ObjectId,required:!0,ref:"User"},vendorType:{type:String,enum:Object.values(i.VendorType),required:!0},shop:{type:o.Schema.Types.ObjectId,ref:"Shop"},items:[r.cartItemSchema],itemsQuantity:{type:Number,required:!0},subtotalPrice:{type:Number,required:!0},totalDiscount:{type:Number,required:!0},platformFee:{type:Number},netPrice:{type:Number,required:!0},paymentStatus:{type:String,enum:Object.values(i.PaymentStatus),required:!0},paymentMethod:{type:String,enum:Object.values(i.PaymentMethod),required:!0},shippingStatus:{type:String,enum:Object.values(i.ShippingStatus),required:!0},shippingAddress:{type:String,required:!0},orderStatus:{type:String,enum:Object.values(i.OrderStatus),required:!0},discountCodes:[{type:String}],archived:{type:Boolean,required:!0,default:!1}},{timestamps:!0});d.index({user:1,shop:1}),d.index({masterOrder:1}),d.index({orderStatus:1}),d.index({paymentStatus:1}),d.index({shippingStatus:1}),d.pre(/^find/,(function(e){this.populate({path:"items.product",select:"name price"}),this.populate({path:"shop"}),e()}));const s=(0,o.model)("SubOrders",d);t.default=s},976:(e,t)=>{var n,o,r;Object.defineProperty(t,"__esModule",{value:!0}),t.PrimeSubscriptionPaymentMethod=t.PrimeSubscriptionPlan=t.PrimeSubscriptionStatus=void 0,function(e){e.ACTIVE="active",e.CANCELLED="cancelled",e.EXPIRED="expired",e.PENDING="pending"}(n||(t.PrimeSubscriptionStatus=n={})),function(e){e.MONTHLY="monthly",e.YEARLY="yearly"}(o||(t.PrimeSubscriptionPlan=o={})),function(e){e.STRIPE="stripe",e.PAYED_BY_ADMIN="payed_by_admin"}(r||(t.PrimeSubscriptionPaymentMethod=r={}))},3388:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(6037),d=n(976),s=r(n(6053)),a=r(n(5857)),u=new i.Schema({user:{type:i.Schema.Types.ObjectId,ref:"User",required:!0},status:{type:String,enum:Object.values(d.PrimeSubscriptionStatus),default:d.PrimeSubscriptionStatus.ACTIVE},plan:{type:String,enum:Object.values(d.PrimeSubscriptionPlan),required:!0},startDate:{type:Date,required:!0},endDate:{type:Date,required:!0},originalSubscriptionAmount:{type:Number,required:!0},discountedSubscriptionAmount:{type:Number,required:!0},subscriptionAmount:{type:Number,required:!0},autoRenew:{type:Boolean,default:!1},paymentMethod:{type:String,enum:Object.values(d.PrimeSubscriptionPaymentMethod),required:!0},lastBillingDate:{type:Date},nextBillingDate:{type:Date,required:!0},cancellationDate:{type:Date},cancellationReason:{type:String}},{timestamps:!0});u.index({user:1,status:1}),u.pre(/^find/,(function(e){this.populate({path:"user",select:"name email phoneNumber"}),e()})),u.pre("validate",(function(e){this.endDate<=this.startDate&&this.invalidate("endDate","End date must be after the start date."),e()})),u.statics.updateExpiredStatus=function(e){return o(this,void 0,void 0,(function*(){yield this.findByIdAndUpdate(e,{status:d.PrimeSubscriptionStatus.EXPIRED})}))},u.post("save",(function(e){return o(this,void 0,void 0,(function*(){try{if(e&&e.endDate){const t=new Date,n=new Date(t.setDate(t.getDate()+5));e.endDate<=n&&e.status!==d.PrimeSubscriptionStatus.EXPIRED&&(0,s.default)(e.user,e),e.endDate<t&&e.status!==d.PrimeSubscriptionStatus.EXPIRED&&(yield this.constructor.updateExpiredStatus(e._id),(0,a.default)(e.user,e))}}catch(e){console.error("Error in post-save middleware:",e)}}))}));const l=(0,i.model)("PrimeSubscription",u);t.default=l},2993:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=new o.Schema({user:{name:{type:String,required:!0},email:{type:String,required:!0,unique:!1},phoneNumber:{type:String,required:!0},role:{type:String,required:!0}},shopDescription:{type:String,required:!0},requestStatus:{type:String,required:!0},processedBy:{name:{type:String,required:!0},email:{type:String,required:!0,unique:!1},phoneNumber:{type:String,required:!0},role:{type:String,required:!0}},processedDate:{type:Date},requestCreatedDate:{type:Date},requestLastUpdatedDate:{type:Date}},{timestamps:!0}),i=(0,o.model)("ProcessedCreateShopRequests",r);t.default=i},6805:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=new o.Schema({user:{name:{type:String,required:!0},email:{type:String,required:!0},phoneNumber:{type:String,required:!0}},shop:{shopName:{type:String,required:!0},email:{type:String,required:!0},phone:{type:String,required:!0}},processedBy:{name:{type:String,required:!0},email:{type:String,required:!0}},reason:{type:String,required:!0},processedAt:{type:Date,default:Date.now,required:!0},requestStatus:{type:String,required:!0}},{timestamps:!0}),i=(0,o.model)("ProcessedDeleteShopRequest",r);t.default=i},7305:(e,t)=>{var n,o,r;Object.defineProperty(t,"__esModule",{value:!0}),t.RefundStatus=t.RefundType=t.RefundMethod=void 0,function(e){e.Stripe="stripe",e.GiftCard="giftCard"}(n||(t.RefundMethod=n={})),function(e){e.Return="return",e.Cancellation="cancellation"}(o||(t.RefundType=o={})),function(e){e.Pending="pending",e.Processing="processing",e.Confirmed="confirmed",e.Rejected="rejected"}(r||(t.RefundStatus=r={}))},8603:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(7305),i=n(5939),d=n(2059),s=new o.Schema({user:{_id:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},email:{type:String,required:!0},name:{type:String,required:!0},phoneNumber:{type:String,required:!0}},order:i.OrderSchema,returnedProduct:[d.productSchema],processedBy:{_id:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},email:{type:String,required:!0},name:{type:String,required:!0},phoneNumber:{type:String,required:!0},role:{type:String,required:!0}},refundAmount:{type:Number,required:!0},refundMethod:{type:String,enum:Object.values(r.RefundMethod),required:!0},refundType:{type:String,enum:Object.values(r.RefundType),required:!0},refundStatus:{type:String,enum:Object.values(r.RefundStatus),required:!0},refundProcessedAt:{type:Date,required:!0},refundCreatedAt:{type:Date,required:!0},refundLastUpdate:{type:Date,required:!0}},{timestamps:!0}),a=(0,o.model)("ProcessedRefundRequests",s);t.default=a},2187:(e,t)=>{var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.ReceivedItemsStatus=t.ReturnStatus=void 0,function(e){e.Pending="Pending",e.Approved="Approved",e.Rejected="Rejected",e.Cancelled="Cancelled"}(n||(t.ReturnStatus=n={})),function(e){e.Received="Received",e.NotReceived="Not Received"}(o||(t.ReceivedItemsStatus=o={}))},1385:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(2187),i=n(5939),d=n(2059),s=new o.Schema({requestId:{type:o.Schema.Types.ObjectId,ref:"ReturnRequest",required:!0},user:{_id:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},email:{type:String,required:!0},name:{type:String,required:!0},phoneNumber:{type:String,required:!0}},order:i.OrderSchema,product:d.productSchema,processedBy:{_id:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},email:{type:String,required:!0},name:{type:String,required:!0},phoneNumber:{type:String,required:!0},role:{type:String,required:!0}},quantity:{type:Number,required:!0},returnReason:{type:String,required:!0},returnStatus:{type:String,enum:Object.values(r.ReturnStatus),required:!0},receivedItemsStatus:{type:String,enum:Object.values(r.ReceivedItemsStatus),required:!0},refundAmount:{type:Number,required:!0},comments:{type:String},processedDate:{type:Date},requestCreatedAt:{type:Date,required:!0},requestLastUpdate:{type:Date,required:!0}},{timestamps:!0}),a=(0,o.model)("ProcessedReturnProductRequest",s);t.default=a},6285:(e,t)=>{var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.TicketCategory=t.TicketStatus=void 0,function(e){e.Open="open",e.OnProgress="on-progress",e.Closed="closed"}(n||(t.TicketStatus=n={})),function(e){e.WebsiteIssue="website issue",e.AccountIssue="account issue",e.GeneralInquiry="general inquiry"}(o||(t.TicketCategory=o={}))},5127:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(6285),i=new o.Schema({user:{userId:o.Schema.Types.ObjectId,name:String,email:String,phoneNumber:String,role:String},subject:{type:String,required:!0},description:{type:String,required:!0},status:{type:String,enum:Object.values(r.TicketStatus),default:r.TicketStatus.Open},category:{type:String,enum:Object.values(r.TicketCategory),required:!0},processedBy:{user:{type:o.Schema.Types.ObjectId,ref:"User"},name:String,email:String,phoneNumber:String,role:String},ticketCreatedDate:{type:Date,default:Date.now},ticketLastUpdatedDate:{type:Date,default:Date.now},ticketProcessedDate:Date},{timestamps:!0}),d=(0,o.model)("ProcessedSupportTicket",i);t.default=d},581:(e,t)=>{var n,o,r;Object.defineProperty(t,"__esModule",{value:!0}),t.ProductCategory=t.AvailabilityStatus=t.ProductSourceType=void 0,function(e){e.Website="website",e.Shop="shop"}(n||(t.ProductSourceType=n={})),function(e){e.Available="available",e.Unavailable="unavailable"}(o||(t.AvailabilityStatus=o={})),function(e){e.Electronics="electronics",e.Fashion="fashion",e.Home="home",e.Health="health",e.Beauty="beauty",e.Sports="sports",e.Toys="toys",e.Books="books",e.Food="food",e.Miscellaneous="miscellaneous",e.Clothing="clothing",e.Accessories="accessories",e.Kitchen="kitchen",e.Outdoor="outdoor",e.Crafts="crafts",e.Office="office",e.Tools="tools",e.Automotive="automotive",e.Baby="baby",e.Jewelry="jewelry",e.Pets="pets",e.Games="games",e.Furniture="furniture",e.Appliances="appliances",e.Music="music",e.Movies="movies",e.Software="software",e.Hardware="hardware",e.Services="services",e.Digital="digital",e.Other="other"}(r||(t.ProductCategory=r={}))},2059:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t},d=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.productSchema=void 0;const a=i(n(6037)),u=n(581),l=s(n(6620)),c=s(n(5720));t.productSchema=new a.Schema({sourceType:{type:String,enum:Object.values(u.ProductSourceType),required:!0,default:u.ProductSourceType.Website},shopId:{type:a.Schema.Types.ObjectId,ref:"Shop"},name:{type:String,required:[!0,"product should have a name"]},description:{type:String,required:[!0,"provide description for the product is required."]},category:{type:String,enum:Object.values(u.ProductCategory),required:!0},brand:{type:String,required:[!0,"Please provide the brand name"]},price:{type:Number,required:[!0,"please provide price for your product"]},discount:{type:Number,default:0},discountCodes:{type:[String],default:[]},stock_quantity:{type:Number,required:[!0,"please provide the exact number of available stock quantity for your product"]},images:{type:[String],required:[!0,"please provide images for your product"]},videos:{type:[String]},color:{type:String},material:{type:String,required:!0},averageRating:{type:Number,required:!0,default:4.5},totalReviews:{type:Number,required:!0,default:0},shipping_cost:{type:Number},shipping_methods:{type:[String],default:["standard"]},availability_status:{type:String,required:!0,enum:Object.values(u.AvailabilityStatus),default:u.AvailabilityStatus.Available},manufacturer:{type:String},supplier:{type:String},freezed:{type:Boolean,default:!1},return_policy:{type:String,required:!0,default:"30-days return policy"}},{timestamps:!0}),t.productSchema.index({category:1}),t.productSchema.index({brand:1}),t.productSchema.index({price:1}),t.productSchema.index({availability_status:1}),t.productSchema.pre("save",(function(e){this.stock_quantity<=0&&(this.availability_status=u.AvailabilityStatus.Unavailable),e()})),t.productSchema.post("save",(function(e){return d(this,void 0,void 0,(function*(){if(e.stock_quantity<=0)if(e.sourceType===u.ProductSourceType.Shop)try{const t=yield a.default.model("Shop").findById(e.shopId).exec();t?yield(0,l.default)(e,t):console.error(`Shop with ID ${e.shopId} not found`)}catch(e){console.error("Error sending product out of stock email",e)}else if(e.sourceType===u.ProductSourceType.Website)try{yield(0,c.default)(e)}catch(e){console.error("Error sending product out of stock email to admin",e)}}))}));const p=a.default.model("Product",t.productSchema);t.default=p},4876:(e,t)=>{var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.ReceivedItemsStatus=t.ReturnStatus=void 0,function(e){e.Pending="Pending",e.Approved="Approved",e.Rejected="Rejected",e.Cancelled="Cancelled"}(n||(t.ReturnStatus=n={})),function(e){e.Received="Received",e.NotReceived="Not Received"}(o||(t.ReceivedItemsStatus=o={}))},5496:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(4876),i=n(2059),d=new o.Schema({user:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},order:{type:o.Schema.Types.ObjectId,ref:"Order",required:!0},processedBy:{type:o.Schema.Types.ObjectId,ref:"User"},rejectionReason:{type:String},product:i.productSchema,quantity:{type:Number,required:!0},returnReason:{type:String,required:!0},returnStatus:{type:String,enum:Object.values(r.ReturnStatus),default:r.ReturnStatus.Pending},receivedItemsStatus:{type:String,enum:Object.values(r.ReceivedItemsStatus),default:r.ReceivedItemsStatus.NotReceived},refundAmount:{type:Number,required:!0},comments:{type:String},processedDate:{type:Date}},{timestamps:!0});d.index({user:1,order:1}),d.index({product:1}),d.index({returnStatus:1}),d.pre(/^find/,(function(){this.populate({path:"user",select:"name email"}),this.populate({path:"order"}),this.populate({path:"product",select:"name price discount stock_quantity images"})}));const s=(0,o.model)("ReturnProductsRequests",d);t.default=s},1132:(e,t)=>{var n,o,r;Object.defineProperty(t,"__esModule",{value:!0}),t.RefundStatus=t.RefundType=t.RefundMethod=void 0,function(e){e.Stripe="stripe",e.GiftCard="giftCard"}(n||(t.RefundMethod=n={})),function(e){e.Return="return",e.Cancellation="cancellation"}(o||(t.RefundType=o={})),function(e){e.Pending="pending",e.Processing="processing",e.Confirmed="confirmed",e.Rejected="rejected"}(r||(t.RefundStatus=r={}))},5976:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(1132),i=new o.Schema({user:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},order:{type:o.Schema.Types.ObjectId,ref:"Order",required:!0},processedBy:{type:o.Schema.Types.ObjectId,ref:"User"},rejectReason:{type:String},refundAmount:{type:Number,required:!0},refundMethod:{type:String,enum:Object.values(r.RefundMethod),required:!0},refundType:{type:String,enum:Object.values(r.RefundType),required:!0},refundStatus:{type:String,enum:Object.values(r.RefundStatus),default:r.RefundStatus.Pending},refundProcessedAt:{type:Date},isRelatedToShop:{type:Boolean,default:!1},shop:{type:o.Schema.Types.ObjectId,ref:"Shop"}},{timestamps:!0});i.pre(/^find/,(function(e){this.populate("shop"),e()}));const d=(0,o.model)("RefundRequest",i);t.default=d},1092:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ReportStatus=void 0,function(e){e.PENDING="pending",e.REVIEWED="reviewed",e.RESOLVED="resolved"}(n||(t.ReportStatus=n={}))},656:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(1092),i=new o.Schema({reportedShop:{type:o.Schema.Types.ObjectId,ref:"Shop",required:!0},reportedBy:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},resolvedBy:{type:o.Schema.Types.ObjectId,ref:"User"},reason:{type:String,required:!0},description:{type:String,required:!0},resolved:{type:Boolean,default:!1},resolvedAt:{type:Date},resolvedByComments:{type:String},status:{type:String,enum:Object.values(r.ReportStatus),default:r.ReportStatus.PENDING}},{timestamps:!0});i.index({reportedShop:1,status:1}),i.index({reportedBy:1,status:1}),i.index({processedBy:1,status:1}),i.pre(/^find/,(function(e){this.populate("reportedShop"),this.populate("reportedBy"),this.populate("resolvedBy"),e()}));const d=(0,o.model)("ReportShop",i);t.default=d},1177:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(6037),d=r(n(2059)),s=new i.Schema({user:{type:i.Schema.Types.ObjectId,ref:"User",required:!0},product:{type:i.Schema.Types.ObjectId,ref:"Product",required:!0},rating:{type:Number,required:!0},comment:{type:String,required:!0}},{timestamps:!0});s.statics.calcAverageRatings=function(e){return o(this,void 0,void 0,(function*(){const t=yield this.aggregate([{$match:{product:e}},{$group:{_id:"$product",nRating:{$sum:1},avgRating:{$avg:"$rating"}}}]);t.length>0?yield d.default.findByIdAndUpdate(e,{totalReviews:t[0].nRating,averageRating:t[0].avgRating}):yield d.default.findByIdAndUpdate(e,{totalReviews:0,averageRating:0})}))},s.post("save",(function(){this.constructor.calcAverageRatings(this.product)})),s.pre(/^findOneAnd/,(function(e){return o(this,void 0,void 0,(function*(){this.r=yield this.findOne(),e()}))})),s.post(/^findOneAnd/,(function(){return o(this,void 0,void 0,(function*(){this.r&&(yield this.r.constructor.calcAverageRatings(this.r.product))}))}));const a=(0,i.model)("Review",s);t.default=a},8473:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.RequestStatus=void 0,function(e){e.Pending="pending",e.Rejected="rejected",e.Cancelled="cancelled",e.Approved="approved"}(n||(t.RequestStatus=n={}))},619:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(8473),i=new o.Schema({user:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},shop:{type:o.Schema.Types.ObjectId,ref:"Shop",required:!0},processedBy:{type:o.Schema.Types.ObjectId,ref:"User"},processedAt:{type:Date},reason:{type:String,required:!0},requestStatus:{type:String,enum:Object.values(r.RequestStatus),default:r.RequestStatus.Pending}},{timestamps:!0});i.pre(/^find/,(function(e){this.populate({path:"user"}),this.populate({path:"shop"}),e()}));const d=(0,o.model)("DeleteShopRequest",i);t.default=d},5061:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(6037),i=o(n(7906)),d=o(n(6982)),s=new r.Schema({owner:{type:r.Schema.Types.ObjectId,ref:"User",required:!0},email:{type:String,required:!0,unique:!0,lowercase:!0,validate:[i.default.isEmail,"Please provide a valid email address"]},balance:{type:Number,default:0},phone:{type:String,required:!0,validate:[i.default.isMobilePhone,"Please provide a valid phone number"]},shopName:{type:String,unique:!0,required:!0},shopDescription:{type:String},productCount:{type:Number,default:0},products:[{type:r.Schema.Types.ObjectId,ref:"Product"}],isActive:{type:Boolean,default:!0},categories:[String],photo:{type:String},photoPublicId:{type:String,select:!1},banner:{type:String},bannerId:{type:String,select:!1},tempChangedEmail:{type:String,lowercase:!0,validate:[i.default.isEmail,"Please provide a valid email address"]},changeEmailVerificationToken:{type:String,select:!1},changeEmailVerificationTokenExpiresAt:{type:Date,select:!1}},{timestamps:!0});s.methods.createChangeEmailVerificationToken=function(){const e=d.default.randomBytes(32).toString("hex");return this.changeEmailVerificationToken=d.default.createHash("sha256").update(e).digest("hex"),this.changeEmailVerificationTokenExpiresAt=new Date(Date.now()+6e5),console.log("Generated Change Email Verification Token:",e),console.log("Hashed Change Email Verification Token:",this.changeEmailVerificationToken),e},s.pre(/^find/,(function(e){this.populate({path:"owner",select:"name email phoneNumber active verified"}),this.populate({path:"products"}),e()}));const a=(0,r.model)("Shop",s);t.default=a},7652:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.RequestStatus=void 0,function(e){e.Approved="approved",e.Pending="pending",e.Rejected="rejected",e.Cancelled="cancelled"}(n||(t.RequestStatus=n={}))},6884:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(7652),i=new o.Schema({user:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},shopDescription:{type:String,required:!0},requestStatus:{type:String,enum:Object.values(r.RequestStatus),default:r.RequestStatus.Pending},processedBy:{type:o.Schema.Types.ObjectId,ref:"User"},processedAt:{type:Date}},{timestamps:!0});i.pre(/^find/,(function(e){this.populate({path:"user",select:"name email phoneNumber active verified"}),e()}));const d=(0,o.model)("ShopRequest",i);t.default=d},2275:(e,t)=>{var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentMethod=t.PaymentStatus=void 0,function(e){e.Pending="pending",e.Paid="paid"}(n||(t.PaymentStatus=n={})),function(e){e.Cash="cash",e.CreditCard="credit_card"}(o||(t.PaymentMethod=o={}))},1573:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(2275),i=new o.Schema({user:{type:o.Schema.Types.ObjectId,ref:"User",unique:!0,required:!0},items:[{type:o.Schema.Types.ObjectId,ref:"CartItem",default:[]}],total_quantity:{type:Number,required:!0,default:0},discount_code:{type:o.Schema.Types.ObjectId,ref:"DiscountCode"},discount_code_applied:{type:Boolean,default:!1},discount_code_amount:{type:Number},total_discount:{type:Number,required:!0,default:0},total_price:{type:Number,required:!0,default:0},total_shipping_cost:{type:Number,required:!0,default:0},payment_status:{type:String,enum:Object.values(r.PaymentStatus),required:!0,default:r.PaymentStatus.Pending},payment_method:{type:String,enum:Object.values(r.PaymentMethod),default:r.PaymentMethod.Cash}},{timestamps:!0});i.methods.calculateTotals=function(){this.total_quantity=this.items.reduce(((e,t)=>e+t.quantity),0),this.total_discount=this.items.reduce(((e,t)=>e+t.discount),0),this.total_price=this.items.reduce(((e,t)=>e+t.priceAfterDiscount),0),this.total_shipping_cost=30},i.pre(/^find/,(function(e){this.populate({path:"items"}),this.populate({path:"discount_code"}),e()})),i.index({user:1}),i.index({payment_status:1}),i.index({payment_method:1});const d=(0,o.model)("ShoppingCart",i);t.default=d},4990:(e,t)=>{var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.SupportTicketCategory=t.SupportTicketStatus=void 0,function(e){e.Open="open",e.OnProgress="on-progress",e.Closed="closed"}(n||(t.SupportTicketStatus=n={})),function(e){e.ShopIssue="shop issue",e.ProductIssue="product issue",e.OrderIssue="order issue",e.ShippingIssue="shipping issue",e.ReturnIssue="return issue",e.RefundIssue="refund issue",e.PaymentIssue="payment issue",e.AccountIssue="account issue",e.FinancialIssue="financial issue",e.GeneralInquiry="general inquiry",e.Other="other"}(o||(t.SupportTicketCategory=o={}))},7378:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(4990),i=new o.Schema({shop:{type:o.Schema.Types.ObjectId,ref:"Shop",required:!0},user:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},subject:{type:String,required:!0},description:{type:String,required:!0},status:{type:String,enum:Object.values(r.SupportTicketStatus),default:r.SupportTicketStatus.Open},category:{type:String,enum:Object.values(r.SupportTicketCategory),required:!0},img:{type:String},imgPublicId:{type:String},processedBy:{user:{type:o.Schema.Types.ObjectId,ref:"User"},name:{type:String},email:{type:String},phoneNumber:{type:String},role:{type:String}},ticketCreatedDate:{type:Date},ticketUpdatedDate:{type:Date},ticketProcessedDate:{type:Date},ticketResponse:{type:String}},{timestamps:!0}),d=(0,o.model)("ShopSupportTicket",i);t.default=d},7003:(e,t)=>{var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.TicketCategory=t.TicketStatus=void 0,function(e){e.Open="open",e.OnProgress="on-progress",e.Closed="closed"}(n||(t.TicketStatus=n={})),function(e){e.WebsiteIssue="website issue",e.AccountIssue="account issue",e.GeneralInquiry="general inquiry"}(o||(t.TicketCategory=o={}))},6909:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=n(7003),i=new o.Schema({user:{type:o.Schema.Types.ObjectId,ref:"User",required:!0},subject:{type:String,required:!0},description:{type:String,required:!0},status:{type:String,enum:Object.values(r.TicketStatus),default:r.TicketStatus.Open},category:{type:String,enum:Object.values(r.TicketCategory),required:!0},processedBy:{user:{type:o.Schema.Types.ObjectId,ref:"User"},name:String,email:String,phoneNumber:String,role:String},ticketProcessedDate:Date,ticketResponse:String},{timestamps:!0}),d=(0,o.model)("SupportTicket",i);t.default=d},2237:(e,t)=>{var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultPhotoUrl=t.UserRole=void 0,function(e){e.USER="user",e.ADMIN="admin",e.TRADER="trader"}(n||(t.UserRole=n={})),function(e){e.PHOTO_URL="https://res.cloudinary.com/deqgzvkxp/image/upload/v1718812055/defaultProileImg_j1ilwv.png"}(o||(t.DefaultPhotoUrl=o={}))},2819:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.userSchema=void 0;const i=n(6037),d=r(n(7906)),s=r(n(4729)),a=n(2237),u=r(n(6982)),l=n(976);t.userSchema=new i.Schema({googleId:{type:String,unique:!0,sparse:!0},name:{type:String,required:[!0,"name is required"]},email:{type:String,required:!0,unique:!0,lowercase:!0,trim:!0,validate:[d.default.isEmail,"Invalid email"]},isNotificationMuted:{type:Boolean,default:!1},address:{type:String},isPrimeUser:{type:Boolean,default:!1},primeSubscriptionStatus:{type:String,enum:Object.values(l.PrimeSubscriptionStatus)},lastPrimeSubscriptionDocument:{type:i.Schema.Types.ObjectId,ref:"PrimeSubscription"},shippingAddress:{type:String},phoneNumber:{type:String,validate:{validator:function(){return d.default.isMobilePhone(this.phoneNumber)},message:"Invalid phone number"}},shoppingCart:{type:i.Schema.Types.ObjectId,ref:"ShoppingCart"},giftCard:{type:Number,default:0},photo:{type:String,default:a.DefaultPhotoUrl.PHOTO_URL},photoPublicId:{type:String},password:{type:String,required:!0,select:!1,minlength:8},passwordConfirmation:{type:String,required:!0,validate:{validator:function(){return this.password===this.passwordConfirmation},message:"Password and password confirmation do not match"}},role:{type:String,enum:Object.values(a.UserRole),default:a.UserRole.USER},purchaseHistory:[{type:i.Schema.Types.ObjectId,ref:"Product"}],passwordResetToken:String,passwordResetExpires:Date,active:{type:Boolean,default:!0},emailVerificationToken:{type:String},loyaltyPoints:{type:Number,default:0},verified:{type:Boolean,default:!1},myShop:{type:i.Schema.Types.ObjectId,ref:"Shop"}},{timestamps:!0}),t.userSchema.index({email:1}),t.userSchema.pre("save",(function(e){if(!this.isModified("password"))return e();this.password=s.default.hashSync(this.password,12),this.passwordConfirmation=void 0,e()})),t.userSchema.methods.comparePassword=function(e,t){return o(this,void 0,void 0,(function*(){return s.default.compare(e,t)}))},t.userSchema.methods.createEmailVerificationToken=function(){const e=u.default.randomBytes(32).toString("hex");return this.emailVerificationToken=e,this.emailVerificationExpires=Date.now()+36e5,e},t.userSchema.methods.createPasswordResetToken=function(){const e=u.default.randomBytes(32).toString("hex");return this.passwordResetToken=u.default.createHash("sha256").update(e).digest("hex"),this.passwordResetExpires=Date.now()+36e5,console.log("Generated Reset Token:",e),console.log("Hashed Reset Token:",this.passwordResetToken),e};const c=(0,i.model)("User",t.userSchema);t.default=c},3915:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(6037),r=new o.Schema({user:{type:o.Schema.Types.ObjectId,ref:"User"},product:{type:o.Schema.Types.ObjectId,ref:"Product"}},{timestamps:!0}),i=(0,o.model)("Wishlist",r);t.default=i},7628:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(1153),d=(0,o.Router)();d.use(r.protect),d.route("/:shopId").get(i.getShopAnalytics),t.default=d},1055:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(3742),d=(0,o.Router)();d.use(r.protect),d.route("/").get((0,r.restrictTo)("admin"),i.getAllReports),d.route("/my-shop/all").get(i.getAllShopAnalyticsReports),d.route("/my-shop/:id").get(i.getShopAnalyticsReport),d.use((0,r.restrictTo)("admin")),d.route("/:id").get(i.getReport).delete(i.deleteReport),t.default=d},289:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(2846),d=(0,o.Router)();d.use(r.protect,(0,r.restrictTo)("admin")),d.route("/").get(i.getWebsiteAnalytics),t.default=d},7017:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(5460),d=(0,o.Router)();d.use(r.protect,(0,r.restrictTo)("admin")),d.route("/").get(i.getAllWebsiteAnalyticsReports),d.route("/:id").get(i.getWebsiteAnalyticsReport).delete(i.deleteWebsiteAnalyticsReport),t.default=d},4600:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(2319),i=n(1675),d=(0,o.Router)();d.route("/signup").post(r.signUpWithEmail),d.route("/login").post(r.loginWithEmail),d.route("/logout").post(i.protect,r.logout),d.route("/forgot-password").post(r.forgotPassword),d.route("/verify-email/:token").get(r.verifyEmail),d.route("/reset-password/:token").patch(r.resetPassword),t.default=d},1664:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1015),i=n(1675),d=n(8979),s=(0,o.Router)();s.use(i.protect),s.route("/cash").post(d.checkCartAvailability,r.checkoutWithCash),s.route("/stripe").post(d.checkCartAvailability,r.checkoutWithStripe),t.default=s},5768:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(9447),d=n(1555),s=(0,o.Router)();s.use(r.protect),s.route("/apply").post(d.validateBeforeApplyDiscountCode,i.applyDiscountCode),s.route("/unApply").patch(d.validateBeforeUnApplyDiscountCode,i.unApplyDiscountCode),s.route("/details").get(i.getDiscountCodeInformation),s.route("/check-validity").get(i.checkDiscountCodeValidate),t.default=s},252:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(7891),d=n(2535),s=(0,o.Router)();s.use(r.protect),s.route("/").get(i.getDiscountCodes).post(d.validateBeforeCreateDiscountCode,i.createDiscountCode),s.patch("/:id/activate",i.activateDiscountCode),s.patch("/:id/unActive",i.disActivateDiscountCode),s.patch("/:id/updateEndDate",i.updateDiscountCodeEndDate),s.route("/:id").get(i.getDiscountCode).patch(i.updateDiscountCode).delete(i.deleteDiscountCode),t.default=s},5703:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(8045),d=n(1314),s=(0,o.Router)();s.use(r.protect),s.route("/").get(i.getDiscountCodes).post(d.validateBeforeCreateDiscountCode,i.createDiscountCode),s.patch("/:id/activate",i.activateDiscountCode),s.patch("/:id/unActive",i.disActivateDiscountCode),s.patch("/:id/updateEndDate",i.updateDiscountCodeEndDate),s.route("/:id").get(i.getDiscountCode).patch(i.updateDiscountCode).delete(i.deleteDiscountCode),t.default=s},8589:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(6136),d=n(5471),s=(0,o.Router)();s.use(r.protect,(0,r.restrictTo)("admin")),s.route("/").get(i.getMessages).post(d.validateBeforeCreateMessage,i.createMessage),s.route("/:id").get(i.getMessage).patch(i.updateMessage).delete(i.deleteMessage),t.default=s},9467:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1170),i=n(1675),d=(0,o.Router)();d.use(i.protect),d.route("/").get(r.getUserNotifications).post((0,i.restrictTo)("admin"),r.createNotification).patch(r.markAllNotificationsAsRead).delete(r.deleteAllUserNotifications),d.route("/group").patch(r.markGroupAsRead).delete(r.deleteGroupOfNotification),d.patch("/mute",r.muteNotifications),d.patch("/unmute",r.unmuteNotifications),d.route("/:id").get(r.getUserNotification).patch(r.markNotificationAsRead).delete(r.deleteUserNotification),t.default=d},1661:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(6604),i=n(8044),d=n(1675),s=(0,o.Router)();s.use(d.protect),s.use((0,d.restrictTo)("admin")),s.route("/all").get(r.getOrders),s.route("/:id").get(r.getOrder),s.route("/:id/delivered").patch(i.validateBeforeDeliverOrder,r.delverOrder),s.route("/:id/shipped").patch(i.validateBeforeUpdateShippingStatus,r.updateOrderStatusToShipped),s.route("/:id/cancel").patch(i.validateBeforeCancelOrder,r.cancelOrder),t.default=s},6330:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(3478),i=n(1675),d=n(8044),s=(0,o.Router)();s.use(i.protect),s.route("/").get(r.getOrders),s.route("/archived").get(r.getArchivedOrders),s.route("/:id").get(r.getOrder),s.route("/:id/cancel").patch(d.validateBeforeCancelOrder,r.cancelOrder),s.route("/:id/archive").patch(r.archiveOrder),s.route("/:id/unarchive").patch(r.unarchiveOrder),t.default=s},3384:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(8185),d=n(798),s=(0,o.Router)();s.use(r.protect),s.route("/my-shop/all").get(d.validateBeforeShopOrdersOperations,i.getSubOrders),s.route("/my-shop/:orderId").get(d.validateBeforeShopOrdersOperations,i.getSubOrder).delete(d.validateBeforeShopOrdersOperations,i.deleteSubOrder),s.use((0,r.restrictTo)("admin")),s.route("/").get(i.getAllOrders),s.route("/:id").get(i.getOrder).delete(i.deleteOrder),t.default=s},8638:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(8895),d=n(9440),s=(0,o.Router)();s.use(r.protect,(0,r.restrictTo)("admin")),s.route("/").get(i.getAllPrimeSubscriptions).post(d.validateBeforeCreatePrimeSubscription,i.createPrimeSubscription),s.route("/cancel").patch(d.validateBeforeCancelPrimeSubscription,i.cancelPrimeSubscription),s.route("/:id").get(i.getPrimeSubscriptionById).patch(i.updatePrimeSubscription).delete(i.deletePrimeSubscription),t.default=s},8883:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(5541),d=n(9788),s=(0,o.Router)();s.use(r.protect),s.route("/").get(d.getAllPreviousSubscriptions),s.post("/create-prime-subscription",d.createUserPrimeSubscription),s.post("/confirm-prime-subscription",d.confirmPrimeSubscription),s.route("/cancel").patch(i.validateBeforeCancelMySubscription,d.cancelMySubscription),s.route("/renew").post(d.renewMySubscription),s.route("/my-latest").get(d.getMyLatestPrimeSubscription),t.default=s},4427:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(2335),i=n(1675),d=(0,o.Router)();d.use(i.protect),d.use((0,i.restrictTo)("admin")),d.route("/").get(r.getAllProcessedShopRequests),d.route("/:id").get(r.getProcessedShopRequest).patch(r.updateProcessedShopRequest).delete(r.deleteProcessedShopRequest),t.default=d},88:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(4633),i=n(1675),d=(0,o.Router)();d.use(i.protect),d.use((0,i.restrictTo)("admin")),d.route("/").get(r.getAllProcessedDeleteShopRequests).post(r.createProcessedDeleteShopRequest),d.route("/:id").get(r.getProcessedDeleteShopRequest).patch(r.updateProcessedDeleteShopRequest).delete(r.deleteProcessedDeleteShopRequest),t.default=d},4754:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(9085),i=n(1675),d=(0,o.Router)();d.use(i.protect),d.use((0,i.restrictTo)("admin")),d.route("/").get(r.getProcessedRefundRequests),d.route("/:id").get(r.getProcessedRefundRequest).patch(r.updateProcessedRefundRequest).delete(r.deleteProcessedRefundRequest),t.default=d},3226:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(5653),i=n(1675),d=(0,o.Router)();d.use(i.protect),d.use((0,i.restrictTo)("admin")),d.route("/").get(r.getProcessedReturnProductRequests),d.route("/:id").get(r.getProcessedReturnProductRequest).patch(r.updateProcessedReturnProductRequest).delete(r.deleteProcessedReturnProductRequest),t.default=d},1414:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(3797),i=n(1675),d=(0,o.Router)();d.use(i.protect),d.use((0,i.restrictTo)("admin")),d.route("/").get(r.getProcessedSupportTickets),d.route("/:id").get(r.getProcessedSupportTicket).patch(r.updateProcessedSupportTicket).delete(r.deleteProcessedSupportTicket),t.default=d},2780:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(4163),i=(0,o.Router)(),d=n(1675);i.route("/").get(r.getAllProducts).post(d.protect,(0,d.restrictTo)("admin"),r.createProduct),i.route("/:id").get(r.getProduct).patch(d.protect,(0,d.restrictTo)("admin"),r.updateProduct).delete(d.protect,(0,d.restrictTo)("admin"),r.deleteProduct),t.default=i},1558:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(7949),i=n(1675),d=n(1033),s=(0,o.Router)();s.use(i.protect),s.route("/all").get((0,i.restrictTo)("admin"),r.getAllReturnItemsRequests),s.route("/").get(r.getAllMyReturnItems).post(d.validateBeforeReturnRequest,r.requestReturnItems),s.route("/cancel/:id").patch(r.cancelReturnRequest),s.route("/:id").get(r.getMyReturnRequestItem).delete(r.deleteReturnItemRequest),s.use((0,i.restrictTo)("admin")),s.route("/:id/approve").patch(d.validateBeforeProcessReturnRequests,r.approveReturnItems),s.route("/:id/reject").patch(d.validateBeforeProcessReturnRequests,r.rejectReturnItems),s.route("/:id/item").get(r.getReturnItemRequest),t.default=s},616:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1737),i=n(1675),d=n(235),s=(0,o.Router)();s.use(i.protect),s.use((0,i.restrictTo)("admin")),s.route("/").get(r.getAllRefundRequests).post(r.createRefundRequest),s.route("/confirmed").get(r.getAllRefundRequestsConfirmed),s.route("/notConfirmed").get(r.getAllRefundRequestsNotConfirmed),s.route("/:id").get(r.getRefundRequest).delete(r.deleteRefundRequest),s.route("/:id/confirm").patch(d.validateRefundRequest,r.confirmRefundRequest),s.route("/:id/reject").patch(d.validateRefundRequest,r.rejectRefundRequest),t.default=s},1671:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(1510),d=n(9046),s=(0,o.Router)();s.use(r.protect),s.route("/").post(d.validateBeforeCreateReport,i.createReport).get((0,r.restrictTo)("admin"),i.getAllReports),s.use((0,r.restrictTo)("admin")),s.route("/:id").get(i.getReport).patch(i.updateReport).delete(i.deleteReport),s.route("/:id/resolve").patch((0,r.restrictTo)("admin"),d.validateBeforeResolveReport,i.resolveReport),t.default=s},9783:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(510),d=n(2254),s=(0,o.Router)();s.use(r.protect),s.route("/").get(d.getReviews).post(i.validateDataBeforeCreateReview,d.addReview),s.route("/:id").get(d.getReview).patch(d.updateReview).delete(d.deleteReview),s.route("/product/:productId").get(d.getProductReviews),t.default=s},9692:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(523),i=n(1675),d=n(2759),s=(0,o.Router)();s.use(i.protect),s.use((0,i.restrictTo)("admin")),s.route("/").get(d.getAllDeleteShopRequests).post(r.validateBeforeCreateDeleteShopRequest,d.createDeleteShopRequest),s.route("/:id").get(d.getDeleteShopRequest).patch(d.updateDeleteShopRequest).delete(d.deleteDeleteShopRequest),s.route("/:id/approve").patch(r.validateBeforeApproveDeleteShopRequest,d.approveDeleteShopRequest),s.route("/:id/reject").patch(r.validateBeforeApproveDeleteShopRequest,d.rejectDeleteShopRequest),s.route("/:id/cancel").patch(r.validateBeforeApproveDeleteShopRequest,d.cancelDeleteShopRequest),t.default=s},4320:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(2773),d=(0,o.Router)();d.use(r.protect),d.use((0,r.restrictTo)("admin")),d.route("/").get(i.getAllShops),d.route("/:shopId").get(i.getShop).delete(i.deleteShop).patch(i.updateShop),d.route("/:shopId/activate").patch(i.activateShop),d.route("/:shopId/un-active").patch(i.unActiveShop),d.route("/:shopId/products").get(i.getAllProductsInShop),d.route("/:shopId/products/:productId").get(i.getSingleProductInShop),d.route("/:shopId/products/:productId/freeze").patch(i.freezingProductInShop),d.route("/:shopId/products/:productId/unfreeze").patch(i.unfreezingProductInShop),d.route("/:shopId/orders").get(i.getAllOrdersCreatedOnShop),d.route("/:shopId/orders/:orderId").get(i.getSingleOrderCreatedOnShop),t.default=d},9234:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(7646),d=n(2238),s=(0,o.Router)();s.use(r.protect),s.route("/:id/cancel").patch(i.validateShopRequestBeforeCancel,d.cancelShopRequest),s.route("/").get(d.getAllShopRequests).post(i.validateRequestBeforeShopRequestCreation,d.createShopRequest),s.use((0,r.restrictTo)("admin")),s.route("/:id").get(d.getShopRequest).patch(d.updateShopRequest).delete(d.deleteShopRequest),s.route("/:id/approve").patch(i.validateShopRequestBeforeApprove,d.confirmShopRequest),s.route("/:id/reject").patch(i.validateShopRequestBeforeReject,d.rejectShopRequest),t.default=s},8347:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(1476),d=n(918),s=n(6407),a=n(6518),u=n(587),l=(0,o.Router)();l.use(r.protect),l.route("/my-shop").get(a.getMyShop),l.route("/my-shop/activate").patch(a.activateShop),l.route("/my-shop/un-active").patch(a.deactivateShop),l.route("/my-shop/update-information").patch(d.validateBeforeUpdateShopInfo,i.upload.single("photo"),a.updateShopInformation),l.route("/my-shop/banner").patch(d.validateBeforeUpdateBanner,i.upload.single("banner"),a.updateShopBanner),l.route("/my-shop/delete-request").post(a.deleteShopRequest),l.route("/my-shop/update-email").post(d.validateBeforeUpdateShopEmailAddress,a.updateShopEmailAddress),l.route("/my-shop/reset-email").patch(a.resetShopEmailAddressToDefault),l.route("/my-shop/verify-changed-email/:token").get(d.validateBeforeConfirmUpdateShopEmailAddress,a.verifyChangedShopEMail),l.route("/my-shop/products/:shopId").get(u.getAllProducts),l.route("/my-shop/products").post(s.validateBeforeAddNewProduct,u.addProduct),l.route("/my-shop/products/:productId").patch(s.validateBeforeUpdateProduct,u.updateProduct).delete(s.validateBeforeDeleteProduct,u.deleteProduct),l.route("/my-shop/products/:productId/freeze").patch(s.validateBeforeFreezeProduct,u.freezeProduct),l.route("/my-shop/products/:productId/unfreeze").patch(s.validateBeforeUnFreezeProduct,u.unfreezeProduct),t.default=l},119:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(4347),i=n(1675),d=n(5815),s=(0,o.Router)();s.use(i.protect),s.route("/me").get(r.getShoppingCart),s.route("/items").post(d.checkItemValidity,r.addItemToShoppingCart),s.route("/items/:productId").delete(d.validateBeforeRemoveItem,r.removeItemFromShoppingCart),s.route("/decrement").patch(d.validateBeforeDecrementItem,r.decreaseItemQuantity),s.route("/clear").delete(r.clearShoppingCart),s.use(i.protect,(0,i.restrictTo)("admin")),s.route("/").get(r.getAllShoppingCarts),s.route("/:id").get(r.getShoppingCartById).delete(r.deleteShoppingCart).patch(r.updateShoppingCart),t.default=s},2953:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(1476),d=n(1351),s=n(9736),a=(0,o.Router)();a.use(r.protect),a.route("/myShop/open-ticket").post(i.upload.single("img"),s.validateBeforeOpenShopSupportTicket,d.openShopSupportTicket),a.route("/myShop/tickets").get(d.getMyShopSupportTickets),a.route("/myShop/tickets/:ticketId").get(d.getMyShopSupportTicket).patch(i.upload.single("img"),d.updateMyShopSupportTicket).delete(d.deleteMyShopSupportTicket),a.use((0,r.restrictTo)("admin")),a.route("/").post(i.upload.single("img"),s.validateBeforeCreateShopSupportTicket,d.createShopSupportTicket).get(d.getShopSupportTickets),a.route("/:ticketId").get(d.getShopSupportTicket).patch(i.upload.single("img"),d.updateShopSupportTicket).delete(d.deleteShopSupportTicket),a.route("/:ticketId/process").patch(s.validateBeforeProcessShopSupportTicket,d.processSupportTicket),t.default=a},3284:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(6931),d=(0,o.Router)();d.use(r.protect),d.route("/me").get(i.getMySupportTickets),d.route("/me/open-ticket").post(i.openSupportTicket),d.route("/me/:id").get(i.getMySupportTicket).patch(i.updateMySupportTicket).delete(i.deleteMySupportTicket),d.use((0,r.restrictTo)("admin")),d.route("/").get(i.getSupportTickets).post(i.createSupportTicket),d.route("/:id").get(i.getSupportTicket).patch(i.updateSupportTicket).delete(i.deleteSupportTicket),d.route("/:id/ticket-response").patch(i.supportTicketResponse),t.default=d},8843:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(9194),i=n(4347),d=n(1675),s=n(5815),a=n(1476),u=n(73),l=(0,o.Router)();l.use(d.protect),l.route("/me").get(r.getMe).delete(r.deleteMe),l.route("/me/loyalty-points").patch(r.convertLoyaltyPointsIntoBalance),l.patch("/me/deactivate",r.deactivateMe),l.patch("/me/password",u.validateBeforeUpdateUserPassword,r.updateMyPassword),l.patch("/me/info",a.upload.single("photo"),u.validateBeforeUpdateUserInfo,r.updateMyInfo),l.route("/").get((0,d.restrictTo)("admin"),r.getAllUsers).post((0,d.restrictTo)("admin"),r.createUser),l.route("/:id").get((0,d.restrictTo)("admin"),r.getUser).patch((0,d.restrictTo)("admin"),r.updateUser).delete((0,d.restrictTo)("admin"),r.deleteUser),l.patch("/:id/activate",(0,d.restrictTo)("admin"),r.activateUser),l.patch("/:id/deactivate",(0,d.restrictTo)("admin"),r.deactivateUser),l.route("/:id/shopping-cart").get(i.getShoppingCart),l.route("/:id/shopping-cart/items").post(s.checkItemValidity,i.addItemToShoppingCart),l.route("/:id/shopping-cart/items/:productId").delete(i.removeItemFromShoppingCart),l.route("/:id/shopping-cart/decrement").patch(i.decreaseItemQuantity),l.route("/:id/shopping-cart/clear").delete(i.clearShoppingCart),t.default=l},2574:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=n(7252),r=n(1675),i=n(8889),d=(0,o.Router)();d.use(r.protect),d.route("/").get(i.getWishlist).delete(i.clearWishlist),d.route("/:productId").post(i.addItemToWishlist),d.route("/:wishlistId").delete(i.removeItemFromWishlist),t.default=d},2257:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getFinancialInformation=void 0;const i=r(n(6037)),d=r(n(5939)),s=r(n(5976));t.getFinancialInformation=function(e,t,n){return o(this,void 0,void 0,(function*(){const o=yield d.default.find({user:e,createdAt:{$gte:t,$lte:n}}),r=o.reduce(((e,t)=>e+t.totalPrice),0),a=yield s.default.aggregate([{$match:{shop:new i.default.Types.ObjectId(e),createdAt:{$gte:t,$lte:n},refundStatus:"Confirmed"}},{$group:{_id:null,total:{$sum:"$refundAmount"}}}]).then((e=>{var t;return(null===(t=e[0])||void 0===t?void 0:t.total)||0}));return{totalRevenue:r,totalRefund:a,averageOrderValue:o.length>0?r/o.length:0,totalProfit:r-a}}))}},2653:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getOrdersInformation=void 0;const i=r(n(6037)),d=r(n(5939));t.getOrdersInformation=function(e,t,n){return o(this,void 0,void 0,(function*(){return(yield d.default.aggregate([{$match:{user:new i.default.Types.ObjectId(e),createdAt:{$gte:t,$lte:n}}},{$group:{_id:null,totalOrders:{$sum:1},totalShippedOrders:{$sum:{$cond:[{$eq:["$shippingStatus","shipped"]},1,0]}},totalDeliveredOrders:{$sum:{$cond:[{$eq:["$orderStatus","delivered"]},1,0]}},totalCancelledOrders:{$sum:{$cond:[{$eq:["$orderStatus","cancelled"]},1,0]}},totalPendingOrders:{$sum:{$cond:[{$eq:["$orderStatus","processing"]},1,0]}}}}]))[0]||{totalOrders:0,totalShippedOrders:0,totalDeliveredOrders:0,totalCancelledOrders:0,totalPendingOrders:0}}))}},5989:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getProductInformation=void 0;const i=r(n(6037)),d=r(n(2059));t.getProductInformation=function(e,t,n){return o(this,void 0,void 0,(function*(){const o=yield d.default.aggregate([{$match:{shopId:new i.default.Types.ObjectId(e)}},{$group:{_id:null,totalProducts:{$sum:1},totalActiveProducts:{$sum:{$cond:[{$eq:["$availability_status","Available"]},1,0]}},totalInactiveProducts:{$sum:{$cond:[{$eq:["$availability_status","Unavailable"]},1,0]}},totalOutOfStockProducts:{$sum:{$cond:[{$eq:["$stock_quantity",0]},1,0]}},totalInStockProducts:{$sum:{$cond:[{$gt:["$stock_quantity",0]},1,0]}},totalFreezedProducts:{$sum:{$cond:[{$eq:["$freezed",!0]},1,0]}},totalUnFreezedProducts:{$sum:{$cond:[{$eq:["$freezed",!1]},1,0]}}}}]),r=yield d.default.countDocuments({shopId:new i.default.Types.ObjectId(e),createdAt:{$gte:t,$lte:n}});return Object.assign(Object.assign({},o[0]||{totalProducts:0,totalActiveProducts:0,totalInactiveProducts:0,totalOutOfStockProducts:0,totalInStockProducts:0,totalFreezedProducts:0,totalUnFreezedProducts:0}),{newProducts:r})}))}},4832:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getRefundInformation=void 0;const i=r(n(6037)),d=r(n(5976));t.getRefundInformation=function(e,t,n){return o(this,void 0,void 0,(function*(){return(yield d.default.aggregate([{$match:{user:new i.default.Types.ObjectId(e),createdAt:{$gte:t,$lte:n}}},{$group:{_id:null,totalRefundRequests:{$sum:1},totalAcceptedRefundRequests:{$sum:{$cond:[{$eq:["$refundStatus","Confirmed"]},1,0]}},totalRejectedRefundRequests:{$sum:{$cond:[{$eq:["$refundStatus","Rejected"]},1,0]}}}}]))[0]||{totalRefundRequests:0,totalAcceptedRefundRequests:0,totalRejectedRefundRequests:0}}))}},9840:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getReturnInformation=void 0;const i=r(n(6037)),d=r(n(5496));t.getReturnInformation=function(e,t,n){return o(this,void 0,void 0,(function*(){return(yield d.default.aggregate([{$match:{user:new i.default.Types.ObjectId(e),createdAt:{$gte:t,$lte:n}}},{$group:{_id:null,totalReturnItems:{$sum:1},totalAcceptedReturnItems:{$sum:{$cond:[{$eq:["$returnStatus","Approved"]},1,0]}},totalRejectedReturnItems:{$sum:{$cond:[{$eq:["$returnStatus","Rejected"]},1,0]}}}}]))[0]||{totalReturnItems:0,totalAcceptedReturnItems:0,totalRejectedReturnItems:0}}))}},2048:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.calculateFinancialSummary=void 0;const i=r(n(5939)),d=r(n(5027)),s=r(n(5976));t.calculateFinancialSummary=()=>o(void 0,void 0,void 0,(function*(){var e,t,n,o;const r=new Date;r.setDate(r.getDate()-30);const a={orderStatus:"delivered",createdAt:{$gte:r}},u=yield i.default.aggregate([{$match:a},{$group:{_id:null,totalSales:{$sum:"$totalPrice"}}}]),l=yield d.default.aggregate([{$match:Object.assign(Object.assign({},a),{user:{$ne:null}})},{$group:{_id:null,totalShopSales:{$sum:"$netPrice"}}}]),c=yield i.default.aggregate([{$match:Object.assign(Object.assign({},a),{user:{$eq:null}})},{$group:{_id:null,totalWebsiteSales:{$sum:"$totalPrice"}}}]),p=yield s.default.aggregate([{$match:{refundStatus:"confirmed",createdAt:{$gte:r}}},{$group:{_id:null,totalRefunds:{$sum:"$refundAmount"}}}]),f=yield i.default.countDocuments(a),h=(null===(e=u[0])||void 0===e?void 0:e.totalSales)||0,m=(null===(t=l[0])||void 0===t?void 0:t.totalShopSales)||0,y=(null===(n=c[0])||void 0===n?void 0:n.totalWebsiteSales)||0,g=(null===(o=p[0])||void 0===o?void 0:o.totalRefunds)||0;return{totalSales:h,totalShopSales:m,totalWebsiteSales:y,totalProcessedRefunds:g,totalWebsiteProfit:h-g,averageOrderValue:f>0?h/f:0,orderCount:f}}))},4590:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getOrdersAnalytics=void 0;const i=r(n(5496)),d=r(n(5027)),s=r(n(5939));t.getOrdersAnalytics=()=>o(void 0,void 0,void 0,(function*(){const e=new Date,t=new Date(e.getTime()-2592e6),[n,o,r,a,u,l,c]=yield Promise.all([s.default.countDocuments({createdAt:{$gte:t,$lte:e}}),d.default.countDocuments({createdAt:{$gte:t,$lte:e},vendorType:"shop"}),d.default.countDocuments({createdAt:{$gte:t,$lte:e},vendorType:"website"}),s.default.countDocuments({createdAt:{$gte:t,$lte:e},status:"pending"}),s.default.countDocuments({createdAt:{$gte:t,$lte:e},status:"cancelled"}),s.default.countDocuments({createdAt:{$gte:t,$lte:e},status:"delivered"}),i.default.countDocuments({createdAt:{$gte:t,$lte:e}})]);return{totalOrders:n,totalShopOrders:o,totalWebsiteOrders:r,totalPendingOrders:a,totalCancelledOrders:u,totalDeliveredOrders:l,totalReturnItems:c}}))},8376:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getPrimeSubscriptionAnalytics=void 0;const i=r(n(3388)),d=n(976);t.getPrimeSubscriptionAnalytics=function(){return o(this,void 0,void 0,(function*(){const e=new Date,t=new Date(e.getTime()-2592e6);return{totalPrimeSubscriptions:yield i.default.countDocuments({createdAt:{$gte:t,$lte:e}}),newPrimeSubscriptions:yield i.default.countDocuments({createdAt:{$gte:t,$lte:e},status:d.PrimeSubscriptionStatus.ACTIVE}),totalActivePrimeSubscriptions:yield i.default.countDocuments({status:d.PrimeSubscriptionStatus.ACTIVE,startDate:{$lte:e},$or:[{endDate:{$gte:t}},{endDate:null}]}),totalInactivePrimeSubscriptions:yield i.default.countDocuments({status:{$in:[d.PrimeSubscriptionStatus.CANCELLED,d.PrimeSubscriptionStatus.EXPIRED]},updatedAt:{$gte:t,$lte:e}})}}))}},13:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getProductsAnalytics=void 0;const i=r(n(2059));t.getProductsAnalytics=()=>o(void 0,void 0,void 0,(function*(){const e=new Date,t=new Date(e.getTime()-2592e6),[n,o,r,d,s,a]=yield Promise.all([i.default.countDocuments(),i.default.countDocuments({sourceType:"shop"}),i.default.countDocuments({sourceType:"website"}),i.default.countDocuments({createdAt:{$gte:t,$lte:e}}),i.default.countDocuments({availability_status:"available"}),i.default.countDocuments({availability_status:"inStock"})]);return{totalProducts:n,totalShopProducts:o,totalWebsiteProducts:r,newProducts:d,totalOutOfStockProducts:s,totalInStockProducts:a}}))},8211:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getRefundAnalytics=void 0;const i=r(n(5976)),d=n(1132);t.getRefundAnalytics=()=>o(void 0,void 0,void 0,(function*(){const e=new Date,t=new Date(e.getTime()-2592e6),[n,o,r,s,a,u]=yield Promise.all([i.default.countDocuments(),i.default.countDocuments({refundStatus:d.RefundStatus.Confirmed}),i.default.countDocuments({createdAt:{$gte:t,$lte:e}}),i.default.countDocuments({refundType:d.RefundType.Cancellation}),i.default.countDocuments({refundType:d.RefundType.Return}),i.default.countDocuments({refundStatus:d.RefundStatus.Rejected})]);return{totalRefundRequests:n,totalProcessedRefundRequests:o,newRefundRequests:r,totalRefundRequestsForCancelledOrders:s,totalRefundRequestsForReturnItems:a,rejectedRefundRequests:u}}))},5831:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getReturnAnalytics=void 0;const i=r(n(5496)),d=n(4876);t.getReturnAnalytics=()=>o(void 0,void 0,void 0,(function*(){const e=new Date,t=new Date(e.getTime()-2592e6),[n,o,r,s,a]=yield Promise.all([i.default.countDocuments(),i.default.countDocuments({returnStatus:d.ReturnStatus.Approved}),i.default.countDocuments({createdAt:{$gte:t,$lte:e}}),i.default.countDocuments({returnStatus:d.ReturnStatus.Rejected}),i.default.countDocuments({returnStatus:d.ReturnStatus.Cancelled})]);return{totalReturnItemsRequests:n,totalProcessedReturnItemsRequests:o,newReturnItemsRequests:r,totalRejectedReturnItemsRequests:s,totalCancelledReturnItemsRequests:a}}))},869:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getShopAnalytics=void 0;const i=r(n(5061)),d=r(n(5027)),s=r(n(6884)),a=r(n(619)),u=r(n(7378));t.getShopAnalytics=()=>o(void 0,void 0,void 0,(function*(){const e=new Date,t=new Date(e.getTime()-2592e6),[n,o,r,l,c,p,f,h,m]=yield Promise.all([i.default.countDocuments(),i.default.countDocuments({isActive:!0}),i.default.countDocuments({isActive:!1}),i.default.countDocuments({productCount:{$gt:0}}),i.default.countDocuments({createdAt:{$gte:t,$lte:e}}),d.default.distinct("shop",{createdAt:{$gte:t,$lte:e}}).countDocuments(),u.default.countDocuments({createdAt:{$gte:t,$lte:e},shopId:{$exists:!0}}),s.default.countDocuments({createdAt:{$gte:t,$lte:e},status:"pending"}),a.default.countDocuments({createdAt:{$gte:t,$lte:e},status:"pending"})]);return{totalShops:n,activeShops:o,inactiveShops:r,shopsWithProducts:l,newJoiningShops:c,shopsWithOrders:p,shopsSupportTickets:f,newShopsRequests:h,newDeleteShopsRequests:m}}))},8485:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.calculateSupportTicketAnalytics=void 0;const i=r(n(7378)),d=r(n(6909)),s=n(7003),a=n(4990);t.calculateSupportTicketAnalytics=function(){return o(this,void 0,void 0,(function*(){const[e,t]=yield Promise.all([d.default.aggregate([{$facet:{total:[{$count:"count"}],processed:[{$match:{status:s.TicketStatus.Closed}},{$count:"count"}],new:[{$match:{status:s.TicketStatus.Open}},{$count:"count"}]}}]),i.default.aggregate([{$facet:{total:[{$count:"count"}],processed:[{$match:{status:a.SupportTicketStatus.Closed}},{$count:"count"}],new:[{$match:{status:a.SupportTicketStatus.Open}},{$count:"count"}]}}])]),n=(e,t)=>{var n,o,r,i;return null!==(i=null===(r=null===(o=null===(n=e[0])||void 0===n?void 0:n[t])||void 0===o?void 0:o[0])||void 0===r?void 0:r.count)&&void 0!==i?i:0};return{totalUsersSupportTickets:n(e,"total"),totalProcessedSupportTickets:n(e,"processed"),newUserSupportTickets:n(e,"new"),totalShopSupportTickets:n(t,"total"),totalProcessedShopSupportTickets:n(t,"processed"),newShopSupportTickets:n(t,"new")}}))}},8201:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getUserAnalytics=void 0;const i=r(n(2819)),d=r(n(5939));t.getUserAnalytics=()=>o(void 0,void 0,void 0,(function*(){const e=new Date,t=new Date(e.getTime()-2592e6),[n,o,r,s]=yield Promise.all([i.default.countDocuments(),i.default.countDocuments({myShop:{$exists:!0}}),i.default.countDocuments({createdAt:{$gte:t,$lte:e}}),d.default.distinct("userId",{createdAt:{$gte:t,$lte:e}}).countDocuments()]);return{totalUsers:n,totalShopOwners:o,newUsers:r,usersWithOrders:s,usersWithNoOrders:n-s}}))},4960:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e,t){super(e),this.statusCode=t,this.statusCode=t,Error.captureStackTrace(this,this.constructor)}}t.default=n},7193:function(e,t){var n=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t){this.query=e,this.queryString=t}filter(){const e=Object.assign({},this.queryString);["page","sort","limit","fields","search"].forEach((t=>delete e[t]));let t=JSON.stringify(e);if(t=t.replace(/\b(gte|gt|lte|lt)\b/g,(e=>`$${e}`)),this.query=this.query.find(JSON.parse(t)),"string"==typeof this.queryString.search)try{this.query=this.query.find({$text:{$search:this.queryString.search}})}catch(e){console.warn("Text search failed. Ensure text index is set up properly.")}return this}sort(){if("string"==typeof this.queryString.sort){const e=this.queryString.sort.split(",").join(" ");this.query=this.query.sort(e)}else this.query=this.query.sort("-createdAt");return this}limitFields(){if("string"==typeof this.queryString.fields){const e=this.queryString.fields.split(",").join(" ");this.query=this.query.select(e.includes("-_id")?e:`${e} _id`)}else this.query=this.query.select("-__v");return this}paginate(){const e="string"==typeof this.queryString.page?parseInt(this.queryString.page):1,t="string"==typeof this.queryString.limit?parseInt(this.queryString.limit):10,n=(Math.max(1,e)-1)*Math.max(1,Math.min(100,t));return this.query=this.query.skip(n).limit(Math.max(1,Math.min(100,t))),this}execute(){return n(this,void 0,void 0,(function*(){try{return yield this.query}catch(e){throw console.error("Error executing query:",e),new Error("Failed to execute query")}}))}}},2489:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>(t,n,o)=>{e(t,n,o).catch(o)}},5269:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLogOutToken=t.createSendToken=void 0;const o=n(829);t.createSendToken=(e,t,n)=>{const r=(0,o.sign)({id:e._id},process.env.JWT_SECRET,{expiresIn:process.env.JWT_EXPIRES_IN}),i={expires:new Date(Date.now()+24*parseInt(process.env.JWT_COOKIE_EXPIRES_IN||"0")*60*60*1e3),httpOnly:!0,secure:!0};n.cookie("jwt",r,i),n.status(t).json({status:"success",token:r,data:{user:e}})},t.createLogOutToken=(e,t,n)=>{const r=(0,o.sign)({id:e._id},process.env.JWT_SECRET,{expiresIn:1});n.cookie("jwt","",{expires:new Date(Date.now()+1e4),httpOnly:!0}),n.status(t).json({status:"success",token:r})}},7333:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sendResponse=void 0,t.sendResponse=(e,t,n)=>n.status(e).json(t)},7908:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyGiftCard=void 0,t.applyGiftCard=function(e,t){if(e.giftCard>0){const n=Math.min(e.giftCard,t.totalPrice);t.totalPrice-=n,e.giftCard-=n,t.paidAmountWithUserGiftCard=n}}},7659:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.clearCartItems=void 0;const i=r(n(7543));t.clearCartItems=function(e,t){return o(this,void 0,void 0,(function*(){yield i.default.deleteMany({cart:e._id}).session(t)}))}},372:function(e,t){var n=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.clearShoppingCart=void 0,t.clearShoppingCart=(e,t)=>n(void 0,void 0,void 0,(function*(){e.items=[],e.total_quantity=0,e.total_discount=0,e.total_price=0,e.total_shipping_cost=0,e.discount_code_amount=void 0,e.discount_code_applied=!1,e.discount_code=void 0,yield e.save()}))},168:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createOrder=void 0;const i=r(n(5939)),d=n(7908),s=r(n(4960));t.createOrder=function(e,t,n){return o(this,void 0,void 0,(function*(){const o=new i.default(e);if((0,d.applyGiftCard)(t,o),t.isPrimeUser&&(o.shippingCost=0),yield o.save({session:n}),!o)throw new s.default("Failed to create order",500);return o}))}},9831:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createOrderObject=void 0,t.createOrderObject=(e,t,n,o,r,i,d,s)=>{const{items:a,total_quantity:u,total_discount:l,total_price:c,total_shipping_cost:p}=t,f={user:e,items:a,itemsQuantity:u,totalDiscount:l,shippingAddress:n,phoneNumber:o,totalPrice:e.isPrimeUser?c:c+p,shippingCost:p,paymentStatus:r,paymentMethod:i,shippingStatus:d,orderStatus:s};return t.discount_code_applied&&t.discount_code&&(f.discountCodeAmount=t.discount_code_amount,f.discountCodes=[t.discount_code],f.isApplyDiscountCode=!0),f}},2729:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createSubOrders=void 0;const i=r(n(5027)),d=r(n(5061)),s=r(n(3247)),a=n(8737),u=r(n(1043)),l=r(n(9703)),c=n(6709),p=n(2492),f=(e,t,n,o,r,i,d)=>{const s={mainOrder:e._id,user:e.user,vendorType:t,items:n,itemsQuantity:n.length,subtotalPrice:o,totalDiscount:r,netPrice:i,paymentStatus:e.paymentStatus,paymentMethod:e.paymentMethod,shippingStatus:e.shippingStatus,shippingAddress:e.shippingAddress,orderStatus:e.orderStatus,discountCodes:e.discountCodes};return d?Object.assign(Object.assign({},s),{shop:d.shopId,platformFee:d.platformFee}):s};function h(e,t,n){return o(this,void 0,void 0,(function*(){try{const[o]=yield s.default.create([{user:e,message:`You have received a new order (Order ID: ${t._id}). You can view the order details on your shop orders section.`,type:c.NotificationType.Order}],{session:n});(0,p.getIO)().to(e.toString()).emit("notification",{type:"NEW_NOTIFICATION",payload:o})}catch(e){console.error("Error creating and emitting shop order notification:",e)}}))}t.createSubOrders=(e,t,n)=>o(void 0,void 0,void 0,(function*(){const o=e.shopOrders||[],r=e.websiteItems||[],s=o.map((e=>e.shopId)),c=yield d.default.find({_id:{$in:s}}).session(n),p=[];for(const e of o){const n=e.items,o=n.reduce(((e,t)=>e+t.priceAfterDiscount*t.quantity),0),r=n.reduce(((e,t)=>e+t.discount*t.quantity),0),i=o-r,d=.1*i,s=i-d,u=f(t,a.VendorType.SHOP,n,o,r,s,{shopId:e.shopId,platformFee:d});p.push(u)}for(const e of r){const n=e.priceAfterDiscount*e.quantity,o=e.discount*e.quantity,r=n-o,i=f(t,a.VendorType.WEBSITE,[e],n,o,r);p.push(i)}const m=yield i.default.insertMany(p,{session:n});for(const e of m){if(e.vendorType===a.VendorType.SHOP){const t=c.find((t=>{var n;return t._id.toString()===(null===(n=e.shop)||void 0===n?void 0:n.toString())}));t?((0,u.default)(t,e),yield h(t._id,e,n)):console.error(`Shop details not found for shop ID: ${e.shop}`)}e.vendorType===a.VendorType.WEBSITE&&(0,l.default)(e)}}))},8805:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.groupItemsByShop=void 0;const o=n(581);t.groupItemsByShop=e=>{const t={shopOrders:[],websiteItems:[]};return e.forEach((e=>{var n;const r=e.product;r.sourceType===o.ProductSourceType.Website?t.websiteItems.push(e):(e=>{let n=t.shopOrders.find((t=>t.shopId===e));return n||(n={shopId:e,items:[]},t.shopOrders.push(n)),n})((null===(n=r.shopId)||void 0===n?void 0:n.toString())||null).items.push(e)})),t}},6241:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.processCheckout=void 0;const i=r(n(4960)),d=r(n(6037)),s=n(6279),a=n(5048),u=n(2729),l=n(372),c=r(n(9320)),p=n(7659),f=n(168);t.processCheckout=function(e,t,n,r){return o(this,void 0,void 0,(function*(){const o=yield d.default.startSession();try{o.startTransaction();const i=yield(0,f.createOrder)(e,n,o);return yield(0,u.createSubOrders)(r,i,o),yield Promise.all([(0,a.updateProductsStockQuantity)(t,o),(0,s.updateUserPurchaseHistory)(n,t,o),(0,p.clearCartItems)(t,o),(0,l.clearShoppingCart)(t,o)]),(0,c.default)(n,i),yield o.commitTransaction(),i}catch(e){throw yield o.abortTransaction(),new i.default("Failed to process checkout",500)}finally{o.endSession()}}))}},5048:function(e,t){var n=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.updateProductsStockQuantity=void 0,t.updateProductsStockQuantity=(e,t)=>n(void 0,void 0,void 0,(function*(){for(const n of e.items){const e=n.product;e&&(e.stock_quantity-=n.quantity,e.stock_quantity<0&&(e.stock_quantity=0),yield e.save({session:t}))}}))},6279:function(e,t){var n=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.updateUserPurchaseHistory=void 0,t.updateUserPurchaseHistory=(e,t,o)=>n(void 0,void 0,void 0,(function*(){const n=t.items.map((e=>e.product._id));for(const t of n)e.purchaseHistory.includes(t)||e.purchaseHistory.push(t);yield e.save({validateBeforeSave:!1,session:o})}))},5972:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.applyCode=void 0;const i=n(7839),d=r(n(4960));t.applyCode=(e,t)=>o(void 0,void 0,void 0,(function*(){try{if(e.discountType===i.DiscountType.PERCENTAGE){const n=e.discountValue/100*t.total_price;t.total_discount+=n,t.total_price-=n,t.discount_code_applied=!0,t.discount_code_amount=n,t.discount_code=e}return e.discountType===i.DiscountType.FIXEDAMOUNT&&(t.total_discount+=e.discountValue,t.total_price-=e.discountValue,t.discount_code_applied=!0,t.discount_code_amount=e.discountValue,t.discount_code=e),void 0!==e.usageLimit&&(e.usageCount++,e.usageCount>=e.usageLimit&&(e.isActive=!1),yield e.save()),yield t.save()}catch(e){throw new d.default("Failed to apply discount code",500)}}))},409:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.unApplyCode=void 0;const i=r(n(4960));t.unApplyCode=e=>o(void 0,void 0,void 0,(function*(){try{return void 0!==e.discount_code_amount&&(e.total_price+=e.discount_code_amount,e.total_discount-=e.discount_code_amount,e.discount_code_amount=void 0,e.discount_code_applied=!1,e.discount_code=void 0),yield e.save()}catch(e){throw new i.default("Failed to un-Apply discount code",500)}}))},5475:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createRefundRequest=void 0;const i=r(n(4485)),d=r(n(4960)),s=r(n(5976));t.createRefundRequest=(e,t,n)=>o(void 0,void 0,void 0,(function*(){try{const o=new s.default({user:e._id,order:n._id,refundAmount:n.totalPrice.toFixed(2),refundMethod:"giftCard",refundType:"cancellation"}),r=yield o.save({session:t});if(!r)throw new d.default("Error saving refund request",500);return(0,i.default)(e,r),r}catch(e){throw new d.default("Error creating refund request",500)}}))},927:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.delverSubOrders=void 0;const i=r(n(5027)),d=r(n(4960));t.delverSubOrders=(e,t,n,r)=>o(void 0,void 0,void 0,(function*(){if(console.log(r,n),!(yield i.default.updateMany({mainOrder:e._id},{$set:{shippingStatus:n,orderStatus:r}},{session:t})).acknowledged)throw yield t.abortTransaction(),new d.default("Error happened while updating the suborder status",500)}))},3638:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateShopsBalance=void 0;const i=r(n(5027));t.updateShopsBalance=(e,t)=>o(void 0,void 0,void 0,(function*(){const n=yield i.default.find({mainOrder:e._id,vendorType:"shop"});if(n)for(const e of n){const n=e.shop,o=n.balance,r=e.netPrice;n.balance=o+r,yield n.save({session:t})}}))},343:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateSubOrderShippingStatus=void 0;const i=r(n(5027)),d=r(n(4960));t.updateSubOrderShippingStatus=(e,t,n)=>o(void 0,void 0,void 0,(function*(){if(!(yield i.default.updateMany({mainOrder:e._id},{$set:{shippingStatus:n}},{session:t})).acknowledged)throw yield t.abortTransaction(),new d.default("Error happened while updating the suborder status",500)}))},3737:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateSubOrdersState=void 0;const i=r(n(5027)),d=r(n(4960));t.updateSubOrdersState=(e,t,n)=>o(void 0,void 0,void 0,(function*(){try{if(!(yield i.default.updateMany({mainOrder:e._id},{$set:{orderStatus:n}},{session:t})).acknowledged)throw new d.default("Error updating sub-orders while cancelling",500)}catch(e){throw new d.default("Error updating sub-orders state",500)}}))},8865:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateUserLoyaltyPoints=void 0;const i=n(5284),d=r(n(4960));t.updateUserLoyaltyPoints=(e,t,n)=>o(void 0,void 0,void 0,(function*(){try{const d=e.isPrimeUser?i.LoyaltyPointsCategory.PRIME_USER:i.LoyaltyPointsCategory.NORMAL_USER,s=(o=t.totalPrice,r=d,o<250?r.UNDER_250:o<500?r.FROM_250_TO_499:o<750?r.FROM_500_TO_749:o<1e3?r.FROM_750_TO_999:o<2e3?r.FROM_1000_TO_1999:r.FROM_2000_AND_ABOVE);e.loyaltyPoints+=s,yield e.save({validateBeforeSave:!1,session:n})}catch(e){throw console.error("Error updating user loyalty points:",e),new d.default("Failed to update user loyalty points",500)}var o,r}))},8098:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cascadeShopDeletion=void 0;const i=r(n(7378)),d=r(n(3247)),s=r(n(5027)),a=r(n(2059)),u=r(n(4960));t.cascadeShopDeletion=function(e,t,n){return o(this,void 0,void 0,(function*(){try{const n=[i.default.deleteMany({shop:e._id}).session(t),d.default.deleteMany({user:e._id}).session(t),s.default.deleteMany({shop:e._id}).session(t),a.default.deleteMany({shop:e._id}).session(t)],o=yield Promise.all(n);console.log(`Deleted related data for shop ${e._id}:`,o)}catch(t){return console.error(`Error deleting related data for shop ${e._id}:`,t),n(new u.default("Error occurred during shop related data deletion",500))}}))}},8216:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createAndAssignShoppingCart=void 0;const i=r(n(1573)),d=r(n(4960)),s=r(n(6037));t.createAndAssignShoppingCart=e=>o(void 0,void 0,void 0,(function*(){const t=yield s.default.startSession();t.startTransaction();try{const n=new i.default({user:e._id});yield n.save({session:t}),e.shoppingCart=n,yield e.save({validateBeforeSave:!1,session:t}),yield t.commitTransaction()}catch(e){throw console.error(e),yield t.abortTransaction(),new d.default("Error while creating shopping cart for user",500)}finally{t.endSession()}}))},2492:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getIO=t.initializeSocket=void 0;const i=n(4437),d=r(n(3247));let s;t.initializeSocket=function(e){return s=new i.Server(e,{cors:{origin:"http://localhost:5173",methods:["GET","POST"],allowedHeaders:["my-custom-header"],credentials:!0}}),s.on("connection",(e=>{console.log("New client connected: ",e.id),e.on("disconnect",(()=>{console.log("Client disconnected: ",e.id)})),e.on("join",(t=>o(this,void 0,void 0,(function*(){e.join(t);const n=yield d.default.find({user:t,read:!1});n.length>0&&e.emit("notification",{type:"MISSED_NOTIFICATIONS",payload:n})}))))})),s},t.getIO=function(){if(!s)throw new Error("Socket.io not initialized!");return s}},5138:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,s)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cascadeUserDeletion=void 0;const i=r(n(3915)),d=r(n(1573)),s=r(n(7543)),a=r(n(6884)),u=r(n(5496)),l=r(n(5976)),c=r(n(5939)),p=r(n(6909)),f=r(n(3247)),h=r(n(1177)),m=r(n(4960));t.cascadeUserDeletion=function(e,t,n){return o(this,void 0,void 0,(function*(){if(e.myShop)return n(new m.default("This action cannot be completed where user has a shop. Before doing this action, user should open a delete shop request first.",400));const o=[i.default.deleteMany({user:e._id}).session(t),d.default.deleteOne({user:e._id}).session(t),s.default.deleteMany({cart:e._id}).session(t),a.default.findOneAndDelete({user:e._id}).session(t),u.default.deleteMany({user:e._id}).session(t),l.default.deleteMany({user:e._id}).session(t),c.default.deleteMany({user:e._id}).session(t),p.default.deleteMany({user:e._id}).session(t),f.default.deleteMany({user:e._id}).session(t),h.default.deleteMany({user:e._id}).session(t)];try{yield Promise.all(o)}catch(t){return console.error(`Error deleting data for user ${e._id}:`,t),n(new m.default("Error occurred during user data deletion",500))}}))}},8148:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPointsAndValue=void 0,t.getPointsAndValue=function(e){return{points:e,monetaryValue:e/1e3*2}}},4729:e=>{e.exports=require("bcryptjs")},1416:e=>{e.exports=require("cloudinary")},6898:e=>{e.exports=require("cookie-parser")},8577:e=>{e.exports=require("cors")},818:e=>{e.exports=require("dotenv")},7252:e=>{e.exports=require("express")},2239:e=>{e.exports=require("express-mongo-sanitize")},1763:e=>{e.exports=require("express-rate-limit")},2525:e=>{e.exports=require("helmet")},829:e=>{e.exports=require("jsonwebtoken")},6037:e=>{e.exports=require("mongoose")},2096:e=>{e.exports=require("morgan")},8461:e=>{e.exports=require("multer")},2703:e=>{e.exports=require("node-cron")},1572:e=>{e.exports=require("nodemailer")},4437:e=>{e.exports=require("socket.io")},4441:e=>{e.exports=require("stripe")},8450:e=>{e.exports=require("swagger-jsdoc")},2320:e=>{e.exports=require("swagger-ui-express")},7906:e=>{e.exports=require("validator")},6982:e=>{e.exports=require("crypto")},9896:e=>{e.exports=require("fs")},992:e=>{e.exports=require("http")},6928:e=>{e.exports=require("path")},8330:e=>{e.exports=JSON.parse('{"name":"e-commerce-backend-application","version":"1.0.0","description":"Fully functional E commerce application","main":"index.js","scripts":{"start":"node dist/bundle.js","dev":"webpack serve --mode development","build":"webpack --mode production","test":"jest"},"keywords":[],"author":"","license":"ISC","dependencies":{"@types/body-parser":"^1.19.5","@types/csurf":"^1.11.5","@types/node-cron":"^3.0.11","@types/swagger-jsdoc":"^6.0.4","@types/swagger-ui-express":"^4.1.6","bcryptjs":"^2.4.3","body-parser":"^1.20.2","bull":"^4.16.1","cloudinary":"^2.2.0","cookie-parser":"^1.4.6","cors":"^2.8.5","dotenv":"^16.4.5","express":"^4.19.2","express-mongo-sanitize":"^2.2.0","express-rate-limit":"^7.3.1","helmet":"^7.1.0","jsonwebtoken":"^9.0.2","mongoose":"^8.4.1","morgan":"^1.10.0","multer":"^1.4.5-lts.1","node-cron":"^3.0.3","nodemailer":"^6.9.14","socket.io":"^4.7.5","stripe":"^15.12.0","swagger-jsdoc":"^6.2.8","swagger-ui-express":"^5.0.1","validator":"^13.12.0","winston":"^3.14.2"},"devDependencies":{"@types/bcryptjs":"^2.4.6","@types/cookie-parser":"^1.4.7","@types/cors":"^2.8.17","@types/express":"^4.17.21","@types/express-rate-limit":"^6.0.0","@types/helmet":"^4.0.0","@types/jsonwebtoken":"^9.0.6","@types/mongoose":"^5.11.97","@types/morgan":"^1.9.9","@types/multer":"^1.4.11","@types/node":"^20.14.2","@types/nodemailer":"^6.4.15","@types/validator":"^13.11.10","ts-loader":"^9.5.1","ts-node":"^10.9.2","ts-node-dev":"^2.0.0","typescript":"^5.4.5","webpack":"^5.94.0","webpack-cli":"^5.1.4","webpack-dev-server":"^5.1.0","webpack-node-externals":"^3.0.0"},"optionalDependencies":{"bufferutil":"^4.0.8","utf-8-validate":"^6.0.4"}}')}},t={};!function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}(8156)})();